{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";import _Number$isNaN from \"@babel/runtime-corejs3/core-js-stable/number/is-nan\";import _JSON$stringify from \"@babel/runtime-corejs3/core-js-stable/json/stringify\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getNumberFormatter, NumberFormats, t } from '@superset-ui/core';\nimport React, { useEffect, useState } from 'react';\nimport { Slider } from 'src/common/components';\nimport { Styles } from '../common';\nimport { getRangeExtraFormData } from '../../utils';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nexport default function RangeFilterPlugin(props) {\n  const { data, formData, height, width, setDataMask, setFocusedFilter, unsetFocusedFilter, inputRef, filterState } = props;\n  const numberFormatter = getNumberFormatter(NumberFormats.SMART_NUMBER);\n  const [row] = data;\n  // @ts-ignore\n  const { min, max } = row;\n  const { groupby, defaultValue } = formData;\n  const [col = ''] = groupby || [];\n  const [value, setValue] = useState(defaultValue != null ? defaultValue : [min, max]);\n  const [marks, setMarks] = useState({});\n  const getBounds = value => {\n    const [lowerRaw, upperRaw] = value;\n    return {\n      lower: lowerRaw > min ? lowerRaw : null,\n      upper: upperRaw < max ? upperRaw : null };\n\n  };\n  const getLabel = (lower, upper) => {\n    if (lower !== null && upper !== null) {\n      return `${numberFormatter(lower)} ≤ x ≤ ${numberFormatter(upper)}`;\n    }\n    if (lower !== null) {\n      return `x ≥ ${numberFormatter(lower)}`;\n    }\n    if (upper !== null) {\n      return `x ≤ ${numberFormatter(upper)}`;\n    }\n    return '';\n  };\n  const getMarks = (lower, upper) => {\n    const newMarks = {};\n    if (lower !== null) {\n      newMarks[lower] = numberFormatter(lower);\n    }\n    if (upper !== null) {\n      newMarks[upper] = numberFormatter(upper);\n    }\n    return newMarks;\n  };\n  const handleAfterChange = value => {\n    setValue(value);\n    const { lower, upper } = getBounds(value);\n    setMarks(getMarks(lower, upper));\n    setDataMask({\n      extraFormData: getRangeExtraFormData(col, lower, upper),\n      filterState: {\n        value: lower !== null || upper !== null ? value : null,\n        label: getLabel(lower, upper) } });\n\n\n  };\n  const handleChange = value => {\n    setValue(value);\n  };\n  useEffect(() => {var _filterState$value;\n    handleAfterChange((_filterState$value = filterState.value) != null ? _filterState$value : [min, max]);\n  }, [_JSON$stringify(filterState.value)]);\n  return ___EmotionJSX(Styles, { height: height, width: width },\n  _Number$isNaN(Number(min)) || _Number$isNaN(Number(max)) ? ___EmotionJSX(\"h4\", null, t('Chosen non-numeric column')) : ___EmotionJSX(\"div\", { onMouseEnter: setFocusedFilter, onMouseLeave: unsetFocusedFilter },\n  ___EmotionJSX(Slider, { range: true, min: min, max: max, value: value != null ? value : [min, max], onAfterChange: handleAfterChange, onChange: handleChange, tipFormatter: value => numberFormatter(value), ref: inputRef, marks: marks })));\n\n\n}__signature__(RangeFilterPlugin, \"useState{[value, setValue](defaultValue ?? [min, max])}\\nuseState{[marks, setMarks]({})}\\nuseEffect{}\");;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(RangeFilterPlugin, \"RangeFilterPlugin\", \"/app/superset-frontend/src/filters/components/Range/RangeFilterPlugin.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/filters/components/Range/RangeFilterPlugin.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getNumberFormatter, NumberFormats, t } from '@superset-ui/core';\nimport React, { useEffect, useState } from 'react';\nimport { Slider } from 'src/common/components';\nimport { PluginFilterRangeProps } from './types';\nimport { Styles } from '../common';\nimport { getRangeExtraFormData } from '../../utils';\n\nexport default function RangeFilterPlugin(props: PluginFilterRangeProps) {\n  const {\n    data,\n    formData,\n    height,\n    width,\n    setDataMask,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    inputRef,\n    filterState,\n  } = props;\n  const numberFormatter = getNumberFormatter(NumberFormats.SMART_NUMBER);\n\n  const [row] = data;\n  // @ts-ignore\n  const { min, max }: { min: number; max: number } = row;\n  const { groupby, defaultValue } = formData;\n  const [col = ''] = groupby || [];\n  const [value, setValue] = useState<[number, number]>(\n    defaultValue ?? [min, max],\n  );\n  const [marks, setMarks] = useState<{ [key: number]: string }>({});\n\n  const getBounds = (\n    value: [number, number],\n  ): { lower: number | null; upper: number | null } => {\n    const [lowerRaw, upperRaw] = value;\n    return {\n      lower: lowerRaw > min ? lowerRaw : null,\n      upper: upperRaw < max ? upperRaw : null,\n    };\n  };\n\n  const getLabel = (lower: number | null, upper: number | null): string => {\n    if (lower !== null && upper !== null) {\n      return `${numberFormatter(lower)} ≤ x ≤ ${numberFormatter(upper)}`;\n    }\n    if (lower !== null) {\n      return `x ≥ ${numberFormatter(lower)}`;\n    }\n    if (upper !== null) {\n      return `x ≤ ${numberFormatter(upper)}`;\n    }\n    return '';\n  };\n\n  const getMarks = (\n    lower: number | null,\n    upper: number | null,\n  ): { [key: number]: string } => {\n    const newMarks: { [key: number]: string } = {};\n    if (lower !== null) {\n      newMarks[lower] = numberFormatter(lower);\n    }\n    if (upper !== null) {\n      newMarks[upper] = numberFormatter(upper);\n    }\n    return newMarks;\n  };\n\n  const handleAfterChange = (value: [number, number]): void => {\n    setValue(value);\n    const { lower, upper } = getBounds(value);\n    setMarks(getMarks(lower, upper));\n\n    setDataMask({\n      extraFormData: getRangeExtraFormData(col, lower, upper),\n      filterState: {\n        value: lower !== null || upper !== null ? value : null,\n        label: getLabel(lower, upper),\n      },\n    });\n  };\n\n  const handleChange = (value: [number, number]) => {\n    setValue(value);\n  };\n\n  useEffect(() => {\n    handleAfterChange(filterState.value ?? [min, max]);\n  }, [JSON.stringify(filterState.value)]);\n\n  return (\n    <Styles height={height} width={width}>\n      {Number.isNaN(Number(min)) || Number.isNaN(Number(max)) ? (\n        <h4>{t('Chosen non-numeric column')}</h4>\n      ) : (\n        <div onMouseEnter={setFocusedFilter} onMouseLeave={unsetFocusedFilter}>\n          <Slider\n            range\n            min={min}\n            max={max}\n            value={value ?? [min, max]}\n            onAfterChange={handleAfterChange}\n            onChange={handleChange}\n            tipFormatter={value => numberFormatter(value)}\n            ref={inputRef}\n            marks={marks}\n          />\n        </div>\n      )}\n    </Styles>\n  );\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}