{"ast":null,"code":"import _indexOfInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/index-of\";import _trimInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/trim\";import _sliceInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/slice\";import _findInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/find\";import _JSON$stringify from \"@babel/runtime-corejs3/core-js-stable/json/stringify\";import _forEachInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/for-each\";var _context;(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { createStore, compose, applyMiddleware } from 'redux';\nimport { Provider } from 'react-redux';\nimport thunkMiddleware from 'redux-thunk';\nimport { hot } from 'react-hot-loader/root';\nimport { ThemeProvider } from '@superset-ui/core';\nimport {\ninitFeatureFlags,\nisFeatureEnabled,\nFeatureFlag } from\n'src/featureFlags';\nimport getInitialState from './reducers/getInitialState';\nimport rootReducer from './reducers/index';\nimport { initEnhancer } from '../reduxUtils';\nimport App from './components/App';\nimport {\nemptyQueryResults,\nclearQueryEditors } from\n'./utils/reduxStateToLocalStorageHelper';\nimport { BYTES_PER_CHAR, KB_STORAGE } from './constants';\nimport setupApp from '../setup/setupApp';\n\nimport './main.less';\nimport '../../stylesheets/reactable-pagination.less';\nimport '../components/FilterableTable/FilterableTableStyles.less';\nimport { theme } from '../preamble';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nsetupApp();\n\nconst appContainer = document.getElementById('app');\nconst bootstrapData = JSON.parse(appContainer.getAttribute('data-bootstrap'));\n\ninitFeatureFlags(bootstrapData.common.feature_flags);\n\nconst initialState = getInitialState(bootstrapData);\nconst sqlLabPersistStateConfig = {\n  paths: ['sqlLab'],\n  config: {\n    slicer: paths => state => {var _subset$sqlLab;\n      const subset = {};\n      _forEachInstanceProperty(paths).call(paths, path => {\n        // this line is used to remove old data from browser localStorage.\n        // we used to persist all redux state into localStorage, but\n        // it caused configurations passed from server-side got override.\n        // see PR 6257 for details\n        delete state[path].common; // eslint-disable-line no-param-reassign\n        if (path === 'sqlLab') {\n          subset[path] = {\n            ...state[path],\n            queries: emptyQueryResults(state[path].queries),\n            queryEditors: clearQueryEditors(state[path].queryEditors) };\n\n        }\n      });\n\n      if ((_subset$sqlLab = subset.sqlLab) != null && _subset$sqlLab.user) {\n        // Don't persist the user.\n        // User should really not be stored under the \"sqlLab\" field. Oh well.\n        delete subset.sqlLab.user;\n      }\n\n      const data = _JSON$stringify(subset);\n      // 2 digit precision\n      const currentSize =\n      Math.round(data.length * BYTES_PER_CHAR / KB_STORAGE * 100) / 100;\n      if (state.localStorageUsageInKilobytes !== currentSize) {\n        state.localStorageUsageInKilobytes = currentSize; // eslint-disable-line no-param-reassign\n      }\n\n      return subset;\n    },\n    merge: (initialState, persistedState = {}) => {\n      const result = {\n        ...initialState,\n        ...persistedState };\n\n      // Filter out any user data that may have been persisted in an older version.\n      // Get user from bootstrap data instead, every time\n      result.sqlLab.user = initialState.sqlLab.user;\n      return result;\n    } } };\n\n\n\nconst store = createStore(\nrootReducer,\ninitialState,\ncompose(\napplyMiddleware(thunkMiddleware),\ninitEnhancer(\n!isFeatureEnabled(FeatureFlag.SQLLAB_BACKEND_PERSISTENCE),\nsqlLabPersistStateConfig)));\n\n\n\n\n// Highlight the navbar menu\nconst menus = document.querySelectorAll('.nav.navbar-nav li.dropdown');\nconst sqlLabMenu = _findInstanceProperty(_context = _sliceInstanceProperty(Array.prototype).\napply(menus)).call(_context,\nelement => {var _context2;return _trimInstanceProperty(_context2 = element.innerText).call(_context2) === 'SQL Lab';});\nif (sqlLabMenu) {\n  const classes = sqlLabMenu.getAttribute('class');\n  if (_indexOfInstanceProperty(classes).call(classes, 'active') === -1) {\n    sqlLabMenu.setAttribute('class', `${classes} active`);\n  }\n}\n\nconst Application = () =>\n___EmotionJSX(Provider, { store: store },\n___EmotionJSX(ThemeProvider, { theme: theme },\n___EmotionJSX(App, null)));const _default =\n\n\n\n\nhot(Application);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(appContainer, \"appContainer\", \"/app/superset-frontend/src/SqlLab/App.jsx\");reactHotLoader.register(bootstrapData, \"bootstrapData\", \"/app/superset-frontend/src/SqlLab/App.jsx\");reactHotLoader.register(initialState, \"initialState\", \"/app/superset-frontend/src/SqlLab/App.jsx\");reactHotLoader.register(sqlLabPersistStateConfig, \"sqlLabPersistStateConfig\", \"/app/superset-frontend/src/SqlLab/App.jsx\");reactHotLoader.register(store, \"store\", \"/app/superset-frontend/src/SqlLab/App.jsx\");reactHotLoader.register(menus, \"menus\", \"/app/superset-frontend/src/SqlLab/App.jsx\");reactHotLoader.register(sqlLabMenu, \"sqlLabMenu\", \"/app/superset-frontend/src/SqlLab/App.jsx\");reactHotLoader.register(Application, \"Application\", \"/app/superset-frontend/src/SqlLab/App.jsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/SqlLab/App.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/SqlLab/App.jsx"],"names":["React","createStore","compose","applyMiddleware","Provider","thunkMiddleware","hot","ThemeProvider","initFeatureFlags","isFeatureEnabled","FeatureFlag","getInitialState","rootReducer","initEnhancer","App","emptyQueryResults","clearQueryEditors","BYTES_PER_CHAR","KB_STORAGE","setupApp","theme","appContainer","document","getElementById","bootstrapData","JSON","parse","getAttribute","common","feature_flags","initialState","sqlLabPersistStateConfig","paths","config","slicer","state","subset","path","queries","queryEditors","sqlLab","user","data","currentSize","Math","round","length","localStorageUsageInKilobytes","merge","persistedState","result","store","SQLLAB_BACKEND_PERSISTENCE","menus","querySelectorAll","sqlLabMenu","Array","prototype","apply","element","innerText","classes","setAttribute","Application"],"mappings":"g1BAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,EAAsBC,OAAtB,EAA+BC,eAA/B,QAAsD,OAAtD;AACA,SAASC,QAAT,QAAyB,aAAzB;AACA,OAAOC,eAAP,MAA4B,aAA5B;AACA,SAASC,GAAT,QAAoB,uBAApB;AACA,SAASC,aAAT,QAA8B,mBAA9B;AACA;AACEC,gBADF;AAEEC,gBAFF;AAGEC,WAHF;AAIO,kBAJP;AAKA,OAAOC,eAAP,MAA4B,4BAA5B;AACA,OAAOC,WAAP,MAAwB,kBAAxB;AACA,SAASC,YAAT,QAA6B,eAA7B;AACA,OAAOC,GAAP,MAAgB,kBAAhB;AACA;AACEC,iBADF;AAEEC,iBAFF;AAGO,wCAHP;AAIA,SAASC,cAAT,EAAyBC,UAAzB,QAA2C,aAA3C;AACA,OAAOC,QAAP,MAAqB,mBAArB;;AAEA,OAAO,aAAP;AACA,OAAO,6CAAP;AACA,OAAO,0DAAP;AACA,SAASC,KAAT,QAAsB,aAAtB,C;;AAEAD,QAAQ;;AAER,MAAME,YAAY,GAAGC,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAArB;AACA,MAAMC,aAAa,GAAGC,IAAI,CAACC,KAAL,CAAWL,YAAY,CAACM,YAAb,CAA0B,gBAA1B,CAAX,CAAtB;;AAEAnB,gBAAgB,CAACgB,aAAa,CAACI,MAAd,CAAqBC,aAAtB,CAAhB;;AAEA,MAAMC,YAAY,GAAGnB,eAAe,CAACa,aAAD,CAApC;AACA,MAAMO,wBAAwB,GAAG;AAC/BC,EAAAA,KAAK,EAAE,CAAC,QAAD,CADwB;AAE/BC,EAAAA,MAAM,EAAE;AACNC,IAAAA,MAAM,EAAEF,KAAK,IAAIG,KAAK,IAAI;AACxB,YAAMC,MAAM,GAAG,EAAf;AACA,+BAAAJ,KAAK,MAAL,CAAAA,KAAK,EAASK,IAAI,IAAI;AACpB;AACA;AACA;AACA;AACA,eAAOF,KAAK,CAACE,IAAD,CAAL,CAAYT,MAAnB,CALoB,CAKO;AAC3B,YAAIS,IAAI,KAAK,QAAb,EAAuB;AACrBD,UAAAA,MAAM,CAACC,IAAD,CAAN,GAAe;AACb,eAAGF,KAAK,CAACE,IAAD,CADK;AAEbC,YAAAA,OAAO,EAAEvB,iBAAiB,CAACoB,KAAK,CAACE,IAAD,CAAL,CAAYC,OAAb,CAFb;AAGbC,YAAAA,YAAY,EAAEvB,iBAAiB,CAACmB,KAAK,CAACE,IAAD,CAAL,CAAYE,YAAb,CAHlB,EAAf;;AAKD;AACF,OAbI,CAAL;;AAeA,4BAAIH,MAAM,CAACI,MAAX,aAAI,eAAeC,IAAnB,EAAyB;AACvB;AACA;AACA,eAAOL,MAAM,CAACI,MAAP,CAAcC,IAArB;AACD;;AAED,YAAMC,IAAI,GAAG,gBAAeN,MAAf,CAAb;AACA;AACA,YAAMO,WAAW;AACfC,MAAAA,IAAI,CAACC,KAAL,CAAaH,IAAI,CAACI,MAAL,GAAc7B,cAAf,GAAiCC,UAAlC,GAAgD,GAA3D,IAAkE,GADpE;AAEA,UAAIiB,KAAK,CAACY,4BAAN,KAAuCJ,WAA3C,EAAwD;AACtDR,QAAAA,KAAK,CAACY,4BAAN,GAAqCJ,WAArC,CADsD,CACJ;AACnD;;AAED,aAAOP,MAAP;AACD,KAjCK;AAkCNY,IAAAA,KAAK,EAAE,CAAClB,YAAD,EAAemB,cAAc,GAAG,EAAhC,KAAuC;AAC5C,YAAMC,MAAM,GAAG;AACb,WAAGpB,YADU;AAEb,WAAGmB,cAFU,EAAf;;AAIA;AACA;AACAC,MAAAA,MAAM,CAACV,MAAP,CAAcC,IAAd,GAAqBX,YAAY,CAACU,MAAb,CAAoBC,IAAzC;AACA,aAAOS,MAAP;AACD,KA3CK,EAFuB,EAAjC;;;;AAiDA,MAAMC,KAAK,GAAGlD,WAAW;AACvBW,WADuB;AAEvBkB,YAFuB;AAGvB5B,OAAO;AACLC,eAAe,CAACE,eAAD,CADV;AAELQ,YAAY;AACV,CAACJ,gBAAgB,CAACC,WAAW,CAAC0C,0BAAb,CADP;AAEVrB,wBAFU,CAFP,CAHgB,CAAzB;;;;;AAYA;AACA,MAAMsB,KAAK,GAAG/B,QAAQ,CAACgC,gBAAT,CAA0B,6BAA1B,CAAd;AACA,MAAMC,UAAU,GAAG,wDAAAC,KAAK,CAACC,SAAN;AAChBC,KADgB,CACVL,KADU;AAEXM,OAAO,0BAAI,kCAAAA,OAAO,CAACC,SAAR,sBAA6B,SAAjC,EAFI,CAAnB;AAGA,IAAIL,UAAJ,EAAgB;AACd,QAAMM,OAAO,GAAGN,UAAU,CAAC5B,YAAX,CAAwB,OAAxB,CAAhB;AACA,MAAI,yBAAAkC,OAAO,MAAP,CAAAA,OAAO,EAAS,QAAT,CAAP,KAA8B,CAAC,CAAnC,EAAsC;AACpCN,IAAAA,UAAU,CAACO,YAAX,CAAwB,OAAxB,EAAkC,GAAED,OAAQ,SAA5C;AACD;AACF;;AAED,MAAME,WAAW,GAAG;AAClB,cAAC,QAAD,IAAU,KAAK,EAAEZ,KAAjB;AACE,cAAC,aAAD,IAAe,KAAK,EAAE/B,KAAtB;AACE,cAAC,GAAD,OADF,CADF,CADF,C;;;;;AAQed,GAAG,CAACyD,WAAD,C,CAAlB,wB,iLAvFM1C,Y,uFACAG,a,wFAIAM,Y,uFACAC,wB,mGAiDAoB,K,gFAaAE,K,gFACAE,U,qFAUAQ,W","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { createStore, compose, applyMiddleware } from 'redux';\nimport { Provider } from 'react-redux';\nimport thunkMiddleware from 'redux-thunk';\nimport { hot } from 'react-hot-loader/root';\nimport { ThemeProvider } from '@superset-ui/core';\nimport {\n  initFeatureFlags,\n  isFeatureEnabled,\n  FeatureFlag,\n} from 'src/featureFlags';\nimport getInitialState from './reducers/getInitialState';\nimport rootReducer from './reducers/index';\nimport { initEnhancer } from '../reduxUtils';\nimport App from './components/App';\nimport {\n  emptyQueryResults,\n  clearQueryEditors,\n} from './utils/reduxStateToLocalStorageHelper';\nimport { BYTES_PER_CHAR, KB_STORAGE } from './constants';\nimport setupApp from '../setup/setupApp';\n\nimport './main.less';\nimport '../../stylesheets/reactable-pagination.less';\nimport '../components/FilterableTable/FilterableTableStyles.less';\nimport { theme } from '../preamble';\n\nsetupApp();\n\nconst appContainer = document.getElementById('app');\nconst bootstrapData = JSON.parse(appContainer.getAttribute('data-bootstrap'));\n\ninitFeatureFlags(bootstrapData.common.feature_flags);\n\nconst initialState = getInitialState(bootstrapData);\nconst sqlLabPersistStateConfig = {\n  paths: ['sqlLab'],\n  config: {\n    slicer: paths => state => {\n      const subset = {};\n      paths.forEach(path => {\n        // this line is used to remove old data from browser localStorage.\n        // we used to persist all redux state into localStorage, but\n        // it caused configurations passed from server-side got override.\n        // see PR 6257 for details\n        delete state[path].common; // eslint-disable-line no-param-reassign\n        if (path === 'sqlLab') {\n          subset[path] = {\n            ...state[path],\n            queries: emptyQueryResults(state[path].queries),\n            queryEditors: clearQueryEditors(state[path].queryEditors),\n          };\n        }\n      });\n\n      if (subset.sqlLab?.user) {\n        // Don't persist the user.\n        // User should really not be stored under the \"sqlLab\" field. Oh well.\n        delete subset.sqlLab.user;\n      }\n\n      const data = JSON.stringify(subset);\n      // 2 digit precision\n      const currentSize =\n        Math.round(((data.length * BYTES_PER_CHAR) / KB_STORAGE) * 100) / 100;\n      if (state.localStorageUsageInKilobytes !== currentSize) {\n        state.localStorageUsageInKilobytes = currentSize; // eslint-disable-line no-param-reassign\n      }\n\n      return subset;\n    },\n    merge: (initialState, persistedState = {}) => {\n      const result = {\n        ...initialState,\n        ...persistedState,\n      };\n      // Filter out any user data that may have been persisted in an older version.\n      // Get user from bootstrap data instead, every time\n      result.sqlLab.user = initialState.sqlLab.user;\n      return result;\n    },\n  },\n};\n\nconst store = createStore(\n  rootReducer,\n  initialState,\n  compose(\n    applyMiddleware(thunkMiddleware),\n    initEnhancer(\n      !isFeatureEnabled(FeatureFlag.SQLLAB_BACKEND_PERSISTENCE),\n      sqlLabPersistStateConfig,\n    ),\n  ),\n);\n\n// Highlight the navbar menu\nconst menus = document.querySelectorAll('.nav.navbar-nav li.dropdown');\nconst sqlLabMenu = Array.prototype.slice\n  .apply(menus)\n  .find(element => element.innerText.trim() === 'SQL Lab');\nif (sqlLabMenu) {\n  const classes = sqlLabMenu.getAttribute('class');\n  if (classes.indexOf('active') === -1) {\n    sqlLabMenu.setAttribute('class', `${classes} active`);\n  }\n}\n\nconst Application = () => (\n  <Provider store={store}>\n    <ThemeProvider theme={theme}>\n      <App />\n    </ThemeProvider>\n  </Provider>\n);\n\nexport default hot(Application);\n"]},"metadata":{},"sourceType":"module"}