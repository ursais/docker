{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";import _forEachInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/for-each\";import _isUndefined from \"lodash/isUndefined\";import _omitBy from \"lodash/omitBy\";import _isEqual from \"lodash/isEqual\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport shortid from 'shortid';\nimport { compose } from 'redux';\nimport persistState from 'redux-localstorage';\n\nexport function addToObject(state, arrKey, obj) {\n  const newObject = { ...state[arrKey] };\n  const copiedObject = { ...obj };\n  if (!copiedObject.id) {\n    copiedObject.id = shortid.generate();\n  }\n  newObject[copiedObject.id] = copiedObject;\n  return { ...state, [arrKey]: newObject };\n}\nexport function alterInObject(state, arrKey, obj, alterations) {\n  const newObject = { ...state[arrKey] };\n  newObject[obj.id] = { ...newObject[obj.id], ...alterations };\n  return { ...state, [arrKey]: newObject };\n}\nexport function alterInArr(state, arrKey, obj, alterations, idKey = 'id') {var _context;\n  // Finds an item in an array in the state and replaces it with a\n  // new object with an altered property\n  const newArr = [];\n  _forEachInstanceProperty(_context = state[arrKey]).call(_context, arrItem => {\n    if (obj[idKey] === arrItem[idKey]) {\n      newArr.push({ ...arrItem, ...alterations });\n    } else\n    {\n      newArr.push(arrItem);\n    }\n  });\n  return { ...state, [arrKey]: newArr };\n}\nexport function removeFromArr(state, arrKey, obj, idKey = 'id') {var _context2;\n  const newArr = [];\n  _forEachInstanceProperty(_context2 = state[arrKey]).call(_context2, arrItem => {\n    if (!(obj[idKey] === arrItem[idKey])) {\n      newArr.push(arrItem);\n    }\n  });\n  return { ...state, [arrKey]: newArr };\n}\nexport function getFromArr(arr, id) {\n  let obj;\n  _forEachInstanceProperty(arr).call(arr, o => {\n    if (o.id === id) {\n      obj = o;\n    }\n  });\n  return obj;\n}\nexport function addToArr(state, arrKey, obj, prepend = false) {\n  const newObj = { ...obj };\n  if (!newObj.id) {\n    newObj.id = shortid.generate();\n  }\n  const newState = {};\n  if (prepend) {\n    newState[arrKey] = [newObj, ...state[arrKey]];\n  } else\n  {\n    newState[arrKey] = [...state[arrKey], newObj];\n  }\n  return { ...state, ...newState };\n}\nexport function extendArr(state, arrKey, arr, prepend = false) {\n  const newArr = [...arr];\n  _forEachInstanceProperty(newArr).call(newArr, el => {\n    if (!el.id) {\n      /* eslint-disable no-param-reassign */\n      el.id = shortid.generate();\n    }\n  });\n  const newState = {};\n  if (prepend) {\n    newState[arrKey] = [...newArr, ...state[arrKey]];\n  } else\n  {\n    newState[arrKey] = [...state[arrKey], ...newArr];\n  }\n  return { ...state, ...newState };\n}\nexport function initEnhancer(persist = true, persistConfig = {}) {\n  const { paths, config } = persistConfig;\n  const composeEnhancers = process.env.WEBPACK_MODE === 'development' ?\n  /* eslint-disable-next-line no-underscore-dangle, dot-notation */\n  window['__REDUX_DEVTOOLS_EXTENSION_COMPOSE__'] || compose :\n  compose;\n  return persist ?\n  composeEnhancers(persistState(paths, config)) :\n  composeEnhancers();\n}\nexport function areArraysShallowEqual(arr1, arr2) {\n  // returns whether 2 arrays are shallow equal\n  // used in shouldComponentUpdate when denormalizing arrays\n  // where the array object is different every time, but the content might\n  // be the same\n  if (!arr1 || !arr2) {\n    return false;\n  }\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  const { length } = arr1;\n  for (let i = 0; i < length; i += 1) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\nexport function areObjectsEqual(obj1, obj2, opts = { ignoreUndefined: false }) {\n  let comp1 = obj1;\n  let comp2 = obj2;\n  if (opts.ignoreUndefined) {\n    comp1 = _omitBy(obj1, _isUndefined);\n    comp2 = _omitBy(obj2, _isUndefined);\n  }\n  return _isEqual(comp1, comp2);\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(addToObject, \"addToObject\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(alterInObject, \"alterInObject\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(alterInArr, \"alterInArr\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(removeFromArr, \"removeFromArr\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(getFromArr, \"getFromArr\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(addToArr, \"addToArr\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(extendArr, \"extendArr\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(initEnhancer, \"initEnhancer\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(areArraysShallowEqual, \"areArraysShallowEqual\", \"/app/superset-frontend/src/reduxUtils.ts\");reactHotLoader.register(areObjectsEqual, \"areObjectsEqual\", \"/app/superset-frontend/src/reduxUtils.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/reduxUtils.ts"],"names":[],"mappings":"wjBAAA;;;;;;;;;;;;;;;;;AAiBG;AACH,OAAO,OAAP,MAAoB,SAApB;AACA,SAAS,OAAT,QAAwB,OAAxB;AACA,OAAO,YAAP,MAA6C,oBAA7C;;AAGA,OAAM,SAAU,WAAV,CACJ,KADI,EAEJ,MAFI,EAGJ,GAHI,EAGoB;AAExB,QAAM,SAAS,GAAG,EAAE,GAAG,KAAK,CAAC,MAAD,CAAV,EAAlB;AACA,QAAM,YAAY,GAAG,EAAE,GAAG,GAAL,EAArB;AAEA,MAAI,CAAC,YAAY,CAAC,EAAlB,EAAsB;AACpB,IAAA,YAAY,CAAC,EAAb,GAAkB,OAAO,CAAC,QAAR,EAAlB;AACD;AACD,EAAA,SAAS,CAAC,YAAY,CAAC,EAAd,CAAT,GAA6B,YAA7B;AACA,SAAO,EAAE,GAAG,KAAL,EAAY,CAAC,MAAD,GAAU,SAAtB,EAAP;AACD;AAED,OAAM,SAAU,aAAV,CACJ,KADI,EAEJ,MAFI,EAGJ,GAHI,EAIJ,WAJI,EAI4B;AAEhC,QAAM,SAAS,GAAG,EAAE,GAAG,KAAK,CAAC,MAAD,CAAV,EAAlB;AACA,EAAA,SAAS,CAAC,GAAG,CAAC,EAAL,CAAT,GAAoB,EAAE,GAAG,SAAS,CAAC,GAAG,CAAC,EAAL,CAAd,EAAwB,GAAG,WAA3B,EAApB;AACA,SAAO,EAAE,GAAG,KAAL,EAAY,CAAC,MAAD,GAAU,SAAtB,EAAP;AACD;AAED,OAAM,SAAU,UAAV,CACJ,KADI,EAEJ,MAFI,EAGJ,GAHI,EAIJ,WAJI,EAKJ,KAAK,GAAG,IALJ,EAKQ;AAEZ;AACA;AACA,QAAM,MAAM,GAAc,EAA1B;AACA,sCAAA,KAAK,CAAC,MAAD,CAAL,iBAAuB,OAAD,IAAiC;AACrD,QAAI,GAAG,CAAC,KAAD,CAAH,KAAe,OAAO,CAAC,KAAD,CAA1B,EAAmC;AACjC,MAAA,MAAM,CAAC,IAAP,CAAY,EAAE,GAAG,OAAL,EAAc,GAAG,WAAjB,EAAZ;AACD,KAFD;AAEO;AACL,MAAA,MAAM,CAAC,IAAP,CAAY,OAAZ;AACD;AACF,GAND;AAOA,SAAO,EAAE,GAAG,KAAL,EAAY,CAAC,MAAD,GAAU,MAAtB,EAAP;AACD;AAED,OAAM,SAAU,aAAV,CACJ,KADI,EAEJ,MAFI,EAGJ,GAHI,EAIJ,KAAK,GAAG,IAJJ,EAIQ;AAEZ,QAAM,MAAM,GAAc,EAA1B;AACA,uCAAA,KAAK,CAAC,MAAD,CAAL,kBAAuB,OAAD,IAAiC;AACrD,QAAI,EAAE,GAAG,CAAC,KAAD,CAAH,KAAe,OAAO,CAAC,KAAD,CAAxB,CAAJ,EAAsC;AACpC,MAAA,MAAM,CAAC,IAAP,CAAY,OAAZ;AACD;AACF,GAJD;AAKA,SAAO,EAAE,GAAG,KAAL,EAAY,CAAC,MAAD,GAAU,MAAtB,EAAP;AACD;AAED,OAAM,SAAU,UAAV,CAAqB,GAArB,EAAiD,EAAjD,EAA2D;AAC/D,MAAI,GAAJ;AACA,2BAAA,GAAG,MAAH,CAAA,GAAG,EAAS,CAAC,IAAG;AACd,QAAI,CAAC,CAAC,EAAF,KAAS,EAAb,EAAiB;AACf,MAAA,GAAG,GAAG,CAAN;AACD;AACF,GAJE,CAAH;AAKA,SAAO,GAAP;AACD;AAED,OAAM,SAAU,QAAV,CACJ,KADI,EAEJ,MAFI,EAGJ,GAHI,EAIJ,OAAO,GAAG,KAJN,EAIW;AAEf,QAAM,MAAM,GAAG,EAAE,GAAG,GAAL,EAAf;AACA,MAAI,CAAC,MAAM,CAAC,EAAZ,EAAgB;AACd,IAAA,MAAM,CAAC,EAAP,GAAY,OAAO,CAAC,QAAR,EAAZ;AACD;AACD,QAAM,QAAQ,GAAG,EAAjB;AACA,MAAI,OAAJ,EAAa;AACX,IAAA,QAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,MAAD,EAAS,GAAG,KAAK,CAAC,MAAD,CAAjB,CAAnB;AACD,GAFD;AAEO;AACL,IAAA,QAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,GAAG,KAAK,CAAC,MAAD,CAAT,EAAmB,MAAnB,CAAnB;AACD;AACD,SAAO,EAAE,GAAG,KAAL,EAAY,GAAG,QAAf,EAAP;AACD;AAED,OAAM,SAAU,SAAV,CACJ,KADI,EAEJ,MAFI,EAGJ,GAHI,EAIJ,OAAO,GAAG,KAJN,EAIW;AAEf,QAAM,MAAM,GAAG,CAAC,GAAG,GAAJ,CAAf;AACA,2BAAA,MAAM,MAAN,CAAA,MAAM,EAAS,EAAE,IAAG;AAClB,QAAI,CAAC,EAAE,CAAC,EAAR,EAAY;AACV;AACA,MAAA,EAAE,CAAC,EAAH,GAAQ,OAAO,CAAC,QAAR,EAAR;AACD;AACF,GALK,CAAN;AAMA,QAAM,QAAQ,GAAG,EAAjB;AACA,MAAI,OAAJ,EAAa;AACX,IAAA,QAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,GAAG,MAAJ,EAAY,GAAG,KAAK,CAAC,MAAD,CAApB,CAAnB;AACD,GAFD;AAEO;AACL,IAAA,QAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,GAAG,KAAK,CAAC,MAAD,CAAT,EAAmB,GAAG,MAAtB,CAAnB;AACD;AACD,SAAO,EAAE,GAAG,KAAL,EAAY,GAAG,QAAf,EAAP;AACD;AAED,OAAM,SAAU,YAAV,CACJ,OAAO,GAAG,IADN,EAEJ,aAAA,GAAsE,EAFlE,EAEoE;AAExE,QAAM,EAAE,KAAF,EAAS,MAAT,KAAoB,aAA1B;AACA,QAAM,gBAAgB,GACpB,OAAO,CAAC,GAAR,CAAY,YAAZ,KAA6B,aAA7B;AACI;AACA,EAAA,MAAM,CAAC,sCAAD,CAAN,IAAkD,OAFtD;AAGI,EAAA,OAJN;AAMA,SAAO,OAAO;AACV,EAAA,gBAAgB,CAAC,YAAY,CAAC,KAAD,EAAQ,MAAR,CAAb,CADN;AAEV,EAAA,gBAAgB,EAFpB;AAGD;AAED,OAAM,SAAU,qBAAV,CAAgC,IAAhC,EAAiD,IAAjD,EAAgE;AACpE;AACA;AACA;AACA;AACA,MAAI,CAAC,IAAD,IAAS,CAAC,IAAd,EAAoB;AAClB,WAAO,KAAP;AACD;AACD,MAAI,IAAI,CAAC,MAAL,KAAgB,IAAI,CAAC,MAAzB,EAAiC;AAC/B,WAAO,KAAP;AACD;AACD,QAAM,EAAE,MAAF,KAAa,IAAnB;AACA,OAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,MAApB,EAA4B,CAAC,IAAI,CAAjC,EAAoC;AAClC,QAAI,IAAI,CAAC,CAAD,CAAJ,KAAY,IAAI,CAAC,CAAD,CAApB,EAAyB;AACvB,aAAO,KAAP;AACD;AACF;AACD,SAAO,IAAP;AACD;AAED,OAAM,SAAU,eAAV,CACJ,IADI,EAEJ,IAFI,EAGJ,IAAI,GAAG,EAAE,eAAe,EAAE,KAAnB,EAHH,EAG6B;AAEjC,MAAI,KAAK,GAAG,IAAZ;AACA,MAAI,KAAK,GAAG,IAAZ;AACA,MAAI,IAAI,CAAC,eAAT,EAA0B;AACxB,IAAA,KAAK,GAAG,QAAO,IAAP,eAAR;AACA,IAAA,KAAK,GAAG,QAAO,IAAP,eAAR;AACD;AACD,SAAO,SAAQ,KAAR,EAAe,KAAf,CAAP;AACD,C,iLAhKe,W,qFAeA,a,uFAWA,U,oFAoBA,a,uFAeA,U,oFAUA,Q,kFAmBA,S,mFAsBA,Y,sFAgBA,qB,+FAoBA,e","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport shortid from 'shortid';\nimport { compose } from 'redux';\nimport persistState, { StorageAdapter } from 'redux-localstorage';\nimport { isEqual, omitBy, isUndefined } from 'lodash';\n\nexport function addToObject(\n  state: Record<string, any>,\n  arrKey: string,\n  obj: Record<string, any>,\n) {\n  const newObject = { ...state[arrKey] };\n  const copiedObject = { ...obj };\n\n  if (!copiedObject.id) {\n    copiedObject.id = shortid.generate();\n  }\n  newObject[copiedObject.id] = copiedObject;\n  return { ...state, [arrKey]: newObject };\n}\n\nexport function alterInObject(\n  state: Record<string, any>,\n  arrKey: string,\n  obj: Record<string, any>,\n  alterations: Record<string, any>,\n) {\n  const newObject = { ...state[arrKey] };\n  newObject[obj.id] = { ...newObject[obj.id], ...alterations };\n  return { ...state, [arrKey]: newObject };\n}\n\nexport function alterInArr(\n  state: Record<string, any>,\n  arrKey: string,\n  obj: Record<string, any>,\n  alterations: Record<string, any>,\n  idKey = 'id',\n) {\n  // Finds an item in an array in the state and replaces it with a\n  // new object with an altered property\n  const newArr: unknown[] = [];\n  state[arrKey].forEach((arrItem: Record<string, any>) => {\n    if (obj[idKey] === arrItem[idKey]) {\n      newArr.push({ ...arrItem, ...alterations });\n    } else {\n      newArr.push(arrItem);\n    }\n  });\n  return { ...state, [arrKey]: newArr };\n}\n\nexport function removeFromArr(\n  state: Record<string, any>,\n  arrKey: string,\n  obj: Record<string, any>,\n  idKey = 'id',\n) {\n  const newArr: unknown[] = [];\n  state[arrKey].forEach((arrItem: Record<string, any>) => {\n    if (!(obj[idKey] === arrItem[idKey])) {\n      newArr.push(arrItem);\n    }\n  });\n  return { ...state, [arrKey]: newArr };\n}\n\nexport function getFromArr(arr: Record<string, any>[], id: string) {\n  let obj;\n  arr.forEach(o => {\n    if (o.id === id) {\n      obj = o;\n    }\n  });\n  return obj;\n}\n\nexport function addToArr(\n  state: Record<string, any>,\n  arrKey: string,\n  obj: Record<string, any>,\n  prepend = false,\n) {\n  const newObj = { ...obj };\n  if (!newObj.id) {\n    newObj.id = shortid.generate();\n  }\n  const newState = {};\n  if (prepend) {\n    newState[arrKey] = [newObj, ...state[arrKey]];\n  } else {\n    newState[arrKey] = [...state[arrKey], newObj];\n  }\n  return { ...state, ...newState };\n}\n\nexport function extendArr(\n  state: Record<string, any>,\n  arrKey: string,\n  arr: Record<string, any>[],\n  prepend = false,\n) {\n  const newArr = [...arr];\n  newArr.forEach(el => {\n    if (!el.id) {\n      /* eslint-disable no-param-reassign */\n      el.id = shortid.generate();\n    }\n  });\n  const newState = {};\n  if (prepend) {\n    newState[arrKey] = [...newArr, ...state[arrKey]];\n  } else {\n    newState[arrKey] = [...state[arrKey], ...newArr];\n  }\n  return { ...state, ...newState };\n}\n\nexport function initEnhancer(\n  persist = true,\n  persistConfig: { paths?: StorageAdapter<unknown>; config?: string } = {},\n) {\n  const { paths, config } = persistConfig;\n  const composeEnhancers =\n    process.env.WEBPACK_MODE === 'development'\n      ? /* eslint-disable-next-line no-underscore-dangle, dot-notation */\n        window['__REDUX_DEVTOOLS_EXTENSION_COMPOSE__'] || compose\n      : compose;\n\n  return persist\n    ? composeEnhancers(persistState(paths, config))\n    : composeEnhancers();\n}\n\nexport function areArraysShallowEqual(arr1: unknown[], arr2: unknown[]) {\n  // returns whether 2 arrays are shallow equal\n  // used in shouldComponentUpdate when denormalizing arrays\n  // where the array object is different every time, but the content might\n  // be the same\n  if (!arr1 || !arr2) {\n    return false;\n  }\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  const { length } = arr1;\n  for (let i = 0; i < length; i += 1) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function areObjectsEqual(\n  obj1: any,\n  obj2: any,\n  opts = { ignoreUndefined: false },\n) {\n  let comp1 = obj1;\n  let comp2 = obj2;\n  if (opts.ignoreUndefined) {\n    comp1 = omitBy(obj1, isUndefined);\n    comp2 = omitBy(obj2, isUndefined);\n  }\n  return isEqual(comp1, comp2);\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}