{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";import _setTimeout from \"@babel/runtime-corejs3/core-js-stable/set-timeout\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";import _extends from \"@babel/runtime-corejs3/helpers/extends\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport cx from 'classnames';\nimport { t } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Tooltip } from 'src/components/Tooltip';\nimport copyTextToClipboard from 'src/utils/copy';\nimport withToasts from 'src/messageToasts/enhancers/withToasts';\nimport { useUrlShortener } from 'src/common/hooks/useUrlShortener';\nimport EmbedCodeButton from './EmbedCodeButton';\nimport { exportChart, getExploreLongUrl } from '../exploreUtils';\nimport ExploreAdditionalActionsMenu from './ExploreAdditionalActionsMenu';import { jsx as ___EmotionJSX } from \"@emotion/react\";var _ref = process.env.NODE_ENV === \"production\" ? { name: \"yc7s2v\", styles: \"display:flex;align-items:center;&:focus, &:focus:active{outline:0;}\" } : { name: \"1ssm59b-ActionButton\", styles: \"display:flex;align-items:center;&:focus, &:focus:active{outline:0;};label:ActionButton;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2V4cGxvcmUvY29tcG9uZW50cy9FeHBsb3JlQWN0aW9uQnV0dG9ucy50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBZ0NzQyIsImZpbGUiOiIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL3NyYy9leHBsb3JlL2NvbXBvbmVudHMvRXhwbG9yZUFjdGlvbkJ1dHRvbnMudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGN4IGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHsgdCB9IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQgeyBUb29sdGlwIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvVG9vbHRpcCc7XG5pbXBvcnQgY29weVRleHRUb0NsaXBib2FyZCBmcm9tICdzcmMvdXRpbHMvY29weSc7XG5pbXBvcnQgd2l0aFRvYXN0cyBmcm9tICdzcmMvbWVzc2FnZVRvYXN0cy9lbmhhbmNlcnMvd2l0aFRvYXN0cyc7XG5pbXBvcnQgeyB1c2VVcmxTaG9ydGVuZXIgfSBmcm9tICdzcmMvY29tbW9uL2hvb2tzL3VzZVVybFNob3J0ZW5lcic7XG5pbXBvcnQgRW1iZWRDb2RlQnV0dG9uIGZyb20gJy4vRW1iZWRDb2RlQnV0dG9uJztcbmltcG9ydCB7IGV4cG9ydENoYXJ0LCBnZXRFeHBsb3JlTG9uZ1VybCB9IGZyb20gJy4uL2V4cGxvcmVVdGlscyc7XG5pbXBvcnQgRXhwbG9yZUFkZGl0aW9uYWxBY3Rpb25zTWVudSBmcm9tICcuL0V4cGxvcmVBZGRpdGlvbmFsQWN0aW9uc01lbnUnO1xuY29uc3QgQWN0aW9uQnV0dG9uID0gKHByb3BzKSA9PiB7XG4gICAgY29uc3QgeyBpY29uLCB0ZXh0LCB0b29sdGlwLCBjbGFzc05hbWUsIG9uVG9vbHRpcFZpc2liaWxpdHlDaGFuZ2UsIC4uLnJlc3QgfSA9IHByb3BzO1xuICAgIHJldHVybiAoPFRvb2x0aXAgaWQ9e2Ake2ljb259LXRvb2x0aXBgfSBwbGFjZW1lbnQ9XCJ0b3BcIiB0aXRsZT17dG9vbHRpcH0gdHJpZ2dlcj17Wydob3ZlciddfSBvblZpc2libGVDaGFuZ2U9e29uVG9vbHRpcFZpc2liaWxpdHlDaGFuZ2V9PlxuICAgICAgPGRpdiByb2xlPVwiYnV0dG9uXCIgdGFiSW5kZXg9ezB9IGNzcz17e1xuICAgICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICAgICAgICAnJjpmb2N1cywgJjpmb2N1czphY3RpdmUnOiB7IG91dGxpbmU6IDAgfSxcbiAgICB9fSBjbGFzc05hbWU9e2NsYXNzTmFtZSB8fCAnYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbSd9IHN0eWxlPXt7IGhlaWdodDogMzAgfX0gey4uLnJlc3R9PlxuICAgICAgICB7aWNvbn1cbiAgICAgICAge3RleHQgJiYgPHNwYW4gc3R5bGU9e3sgbWFyZ2luTGVmdDogNSB9fT57dGV4dH08L3NwYW4+fVxuICAgICAgPC9kaXY+XG4gICAgPC9Ub29sdGlwPik7XG59O1xuY29uc3QgRXhwbG9yZUFjdGlvbkJ1dHRvbnMgPSAocHJvcHMpID0+IHtcbiAgICBjb25zdCB7IGFjdGlvbnMsIGNhbkRvd25sb2FkQ1NWLCBjaGFydFN0YXR1cywgbGF0ZXN0UXVlcnlGb3JtRGF0YSwgc2xpY2UsIGFkZERhbmdlclRvYXN0LCB9ID0gcHJvcHM7XG4gICAgY29uc3QgY29weVRvb2x0aXBUZXh0ID0gdCgnQ29weSBjaGFydCBVUkwgdG8gY2xpcGJvYXJkJyk7XG4gICAgY29uc3QgW2NvcHlUb29sdGlwLCBzZXRDb3B5VG9vbHRpcF0gPSB1c2VTdGF0ZShjb3B5VG9vbHRpcFRleHQpO1xuICAgIGNvbnN0IGxvbmdVcmwgPSBnZXRFeHBsb3JlTG9uZ1VybChsYXRlc3RRdWVyeUZvcm1EYXRhKTtcbiAgICBjb25zdCBnZXRTaG9ydFVybCA9IHVzZVVybFNob3J0ZW5lcihsb25nVXJsKTtcbiAgICBjb25zdCBkb0NvcHlMaW5rID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc2V0Q29weVRvb2x0aXAodCgnTG9hZGluZy4uLicpKTtcbiAgICAgICAgICAgIGNvbnN0IHNob3J0VXJsID0gYXdhaXQgZ2V0U2hvcnRVcmwoKTtcbiAgICAgICAgICAgIGF3YWl0IGNvcHlUZXh0VG9DbGlwYm9hcmQoc2hvcnRVcmwpO1xuICAgICAgICAgICAgc2V0Q29weVRvb2x0aXAodCgnQ29waWVkIHRvIGNsaXBib2FyZCEnKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBzZXRDb3B5VG9vbHRpcCh0KCdTb3JyeSwgeW91ciBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgY29weWluZy4nKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGRvU2hhcmVFbWFpbCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHN1YmplY3QgPSB0KCdTdXBlcnNldCBDaGFydCcpO1xuICAgICAgICAgICAgY29uc3Qgc2hvcnRVcmwgPSBhd2FpdCBnZXRTaG9ydFVybCgpO1xuICAgICAgICAgICAgY29uc3QgYm9keSA9IHQoJyVzJXMnLCAnQ2hlY2sgb3V0IHRoaXMgY2hhcnQ6ICcsIHNob3J0VXJsKTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYG1haWx0bzo/U3ViamVjdD0ke3N1YmplY3R9JTIwJkJvZHk9JHtib2R5fWA7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBhZGREYW5nZXJUb2FzdCh0KCdTb3JyeSwgc29tZXRoaW5nIHdlbnQgd3JvbmcuIFRyeSBhZ2FpbiBsYXRlci4nKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGRvRXhwb3J0Q1NWID0gY2FuRG93bmxvYWRDU1ZcbiAgICAgICAgPyBleHBvcnRDaGFydC5iaW5kKHRoaXMsIHtcbiAgICAgICAgICAgIGZvcm1EYXRhOiBsYXRlc3RRdWVyeUZvcm1EYXRhLFxuICAgICAgICAgICAgcmVzdWx0VHlwZTogJ3Jlc3VsdHMnLFxuICAgICAgICAgICAgcmVzdWx0Rm9ybWF0OiAnY3N2JyxcbiAgICAgICAgfSlcbiAgICAgICAgOiBudWxsO1xuICAgIGNvbnN0IGRvRXhwb3J0SnNvbiA9IGV4cG9ydENoYXJ0LmJpbmQodGhpcywge1xuICAgICAgICBmb3JtRGF0YTogbGF0ZXN0UXVlcnlGb3JtRGF0YSxcbiAgICAgICAgcmVzdWx0VHlwZTogJ3Jlc3VsdHMnLFxuICAgICAgICByZXN1bHRGb3JtYXQ6ICdqc29uJyxcbiAgICB9KTtcbiAgICBjb25zdCBleHBvcnRUb0NTVkNsYXNzZXMgPSBjeCgnYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbScsIHtcbiAgICAgICAgZGlzYWJsZWQ6ICFjYW5Eb3dubG9hZENTVixcbiAgICB9KTtcbiAgICByZXR1cm4gKDxkaXYgY2xhc3NOYW1lPVwiYnRuLWdyb3VwIHJlc3VsdHNcIiByb2xlPVwiZ3JvdXBcIiBkYXRhLXRlc3Q9XCJidG4tZ3JvdXAtcmVzdWx0c1wiPlxuICAgICAge2xhdGVzdFF1ZXJ5Rm9ybURhdGEgJiYgKDw+XG4gICAgICAgICAgPEFjdGlvbkJ1dHRvbiBpY29uPXs8SWNvbnMuTGluayBpY29uU2l6ZT1cImxcIi8+fSB0b29sdGlwPXtjb3B5VG9vbHRpcH0gb25DbGljaz17ZG9Db3B5TGlua30gZGF0YS10ZXN0PVwic2hvcnQtbGluay1idXR0b25cIiBvblRvb2x0aXBWaXNpYmlsaXR5Q2hhbmdlPXt2YWx1ZSA9PiAhdmFsdWUgJiYgc2V0VGltZW91dCgoKSA9PiBzZXRDb3B5VG9vbHRpcChjb3B5VG9vbHRpcFRleHQpLCAyMDApfS8+XG4gICAgICAgICAgPEFjdGlvbkJ1dHRvbiBpY29uPXs8SWNvbnMuRW1haWwgaWNvblNpemU9XCJsXCIvPn0gdG9vbHRpcD17dCgnU2hhcmUgY2hhcnQgYnkgZW1haWwnKX0gb25DbGljaz17ZG9TaGFyZUVtYWlsfS8+XG4gICAgICAgICAgPEVtYmVkQ29kZUJ1dHRvbiBsYXRlc3RRdWVyeUZvcm1EYXRhPXtsYXRlc3RRdWVyeUZvcm1EYXRhfS8+XG4gICAgICAgICAgPEFjdGlvbkJ1dHRvbiBpY29uPXs8SWNvbnMuRmlsZVRleHRPdXRsaW5lZCBpY29uU2l6ZT1cIm1cIi8+fSB0ZXh0PVwiLkpTT05cIiB0b29sdGlwPXt0KCdFeHBvcnQgdG8gLkpTT04gZm9ybWF0Jyl9IG9uQ2xpY2s9e2RvRXhwb3J0SnNvbn0vPlxuICAgICAgICAgIDxBY3Rpb25CdXR0b24gaWNvbj17PEljb25zLkZpbGVFeGNlbE91dGxpbmVkIGljb25TaXplPVwibVwiLz59IHRleHQ9XCIuQ1NWXCIgdG9vbHRpcD17dCgnRXhwb3J0IHRvIC5DU1YgZm9ybWF0Jyl9IG9uQ2xpY2s9e2RvRXhwb3J0Q1NWfSBjbGFzc05hbWU9e2V4cG9ydFRvQ1NWQ2xhc3Nlc30vPlxuICAgICAgICA8Lz4pfVxuICAgICAgPEV4cGxvcmVBZGRpdGlvbmFsQWN0aW9uc01lbnUgbGF0ZXN0UXVlcnlGb3JtRGF0YT17bGF0ZXN0UXVlcnlGb3JtRGF0YX0gY2hhcnRTdGF0dXM9e2NoYXJ0U3RhdHVzfSBvbk9wZW5JbkVkaXRvcj17YWN0aW9ucy5yZWRpcmVjdFNRTExhYn0gb25PcGVuUHJvcGVydGllc01vZGFsPXthY3Rpb25zLm9wZW5Qcm9wZXJ0aWVzTW9kYWx9IHNsaWNlPXtzbGljZX0vPlxuICAgIDwvZGl2Pik7XG59O1xuZXhwb3J0IGRlZmF1bHQgd2l0aFRvYXN0cyhFeHBsb3JlQWN0aW9uQnV0dG9ucyk7XG4iXX0= */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\nconst ActionButton = props => {\n  const { icon, text, tooltip, className, onTooltipVisibilityChange, ...rest } = props;\n  return ___EmotionJSX(Tooltip, { id: `${icon}-tooltip`, placement: \"top\", title: tooltip, trigger: ['hover'], onVisibleChange: onTooltipVisibilityChange },\n  ___EmotionJSX(\"div\", _extends({ role: \"button\", tabIndex: 0, css: _ref,\n\n\n\n    className: className || 'btn btn-default btn-sm', style: { height: 30 } }, rest),\n  icon,\n  text && ___EmotionJSX(\"span\", { style: { marginLeft: 5 } }, text)));\n\n\n};\nconst ExploreActionButtons = props => {\n  const { actions, canDownloadCSV, chartStatus, latestQueryFormData, slice, addDangerToast } = props;\n  const copyTooltipText = t('Copy chart URL to clipboard');\n  const [copyTooltip, setCopyTooltip] = useState(copyTooltipText);\n  const longUrl = getExploreLongUrl(latestQueryFormData);\n  const getShortUrl = useUrlShortener(longUrl);\n  const doCopyLink = async () => {\n    try {\n      setCopyTooltip(t('Loading...'));\n      const shortUrl = await getShortUrl();\n      await copyTextToClipboard(shortUrl);\n      setCopyTooltip(t('Copied to clipboard!'));\n    }\n    catch (error) {\n      setCopyTooltip(t('Sorry, your browser does not support copying.'));\n    }\n  };\n  const doShareEmail = async () => {\n    try {\n      const subject = t('Superset Chart');\n      const shortUrl = await getShortUrl();\n      const body = t('%s%s', 'Check out this chart: ', shortUrl);\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    }\n    catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  };\n  const doExportCSV = canDownloadCSV ?\n  _bindInstanceProperty(exportChart).call(exportChart, this, {\n    formData: latestQueryFormData,\n    resultType: 'results',\n    resultFormat: 'csv' }) :\n\n  null;\n  const doExportJson = _bindInstanceProperty(exportChart).call(exportChart, this, {\n    formData: latestQueryFormData,\n    resultType: 'results',\n    resultFormat: 'json' });\n\n  const exportToCSVClasses = cx('btn btn-default btn-sm', {\n    disabled: !canDownloadCSV });\n\n  return ___EmotionJSX(\"div\", { className: \"btn-group results\", role: \"group\", \"data-test\": \"btn-group-results\" },\n  latestQueryFormData && ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(ActionButton, { icon: ___EmotionJSX(Icons.Link, { iconSize: \"l\" }), tooltip: copyTooltip, onClick: doCopyLink, \"data-test\": \"short-link-button\", onTooltipVisibilityChange: value => !value && _setTimeout(() => setCopyTooltip(copyTooltipText), 200) }),\n  ___EmotionJSX(ActionButton, { icon: ___EmotionJSX(Icons.Email, { iconSize: \"l\" }), tooltip: t('Share chart by email'), onClick: doShareEmail }),\n  ___EmotionJSX(EmbedCodeButton, { latestQueryFormData: latestQueryFormData }),\n  ___EmotionJSX(ActionButton, { icon: ___EmotionJSX(Icons.FileTextOutlined, { iconSize: \"m\" }), text: \".JSON\", tooltip: t('Export to .JSON format'), onClick: doExportJson }),\n  ___EmotionJSX(ActionButton, { icon: ___EmotionJSX(Icons.FileExcelOutlined, { iconSize: \"m\" }), text: \".CSV\", tooltip: t('Export to .CSV format'), onClick: doExportCSV, className: exportToCSVClasses })),\n\n  ___EmotionJSX(ExploreAdditionalActionsMenu, { latestQueryFormData: latestQueryFormData, chartStatus: chartStatus, onOpenInEditor: actions.redirectSQLLab, onOpenPropertiesModal: actions.openPropertiesModal, slice: slice }));\n\n};__signature__(ExploreActionButtons, \"useState{[copyTooltip, setCopyTooltip](copyTooltipText)}\\nuseUrlShortener{getShortUrl}\", () => [useUrlShortener]);const _default =\nwithToasts(ExploreActionButtons);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(ActionButton, \"ActionButton\", \"/app/superset-frontend/src/explore/components/ExploreActionButtons.tsx\");reactHotLoader.register(ExploreActionButtons, \"ExploreActionButtons\", \"/app/superset-frontend/src/explore/components/ExploreActionButtons.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/explore/components/ExploreActionButtons.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/explore/components/ExploreActionButtons.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport cx from 'classnames';\nimport { t } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Tooltip } from 'src/components/Tooltip';\nimport copyTextToClipboard from 'src/utils/copy';\nimport withToasts from 'src/messageToasts/enhancers/withToasts';\nimport { useUrlShortener } from 'src/common/hooks/useUrlShortener';\nimport EmbedCodeButton from './EmbedCodeButton';\nimport { exportChart, getExploreLongUrl } from '../exploreUtils';\nimport ExploreAdditionalActionsMenu from './ExploreAdditionalActionsMenu';\n\ntype ActionButtonProps = {\n  icon: React.ReactElement;\n  text?: string;\n  tooltip: string;\n  className?: string;\n  onClick: React.MouseEventHandler<HTMLElement>;\n  onTooltipVisibilityChange?: (visible: boolean) => void;\n  'data-test'?: string;\n};\n\ntype ExploreActionButtonsProps = {\n  actions: { redirectSQLLab: () => void; openPropertiesModal: () => void };\n  canDownloadCSV: boolean;\n  chartStatus: string;\n  latestQueryFormData: {};\n  queriesResponse: {};\n  slice: { slice_name: string };\n  addDangerToast: Function;\n};\n\nconst ActionButton = (props: ActionButtonProps) => {\n  const {\n    icon,\n    text,\n    tooltip,\n    className,\n    onTooltipVisibilityChange,\n    ...rest\n  } = props;\n  return (\n    <Tooltip\n      id={`${icon}-tooltip`}\n      placement=\"top\"\n      title={tooltip}\n      trigger={['hover']}\n      onVisibleChange={onTooltipVisibilityChange}\n    >\n      <div\n        role=\"button\"\n        tabIndex={0}\n        css={{\n          display: 'flex',\n          alignItems: 'center',\n          '&:focus, &:focus:active': { outline: 0 },\n        }}\n        className={className || 'btn btn-default btn-sm'}\n        style={{ height: 30 }}\n        {...rest}\n      >\n        {icon}\n        {text && <span style={{ marginLeft: 5 }}>{text}</span>}\n      </div>\n    </Tooltip>\n  );\n};\n\nconst ExploreActionButtons = (props: ExploreActionButtonsProps) => {\n  const {\n    actions,\n    canDownloadCSV,\n    chartStatus,\n    latestQueryFormData,\n    slice,\n    addDangerToast,\n  } = props;\n\n  const copyTooltipText = t('Copy chart URL to clipboard');\n  const [copyTooltip, setCopyTooltip] = useState(copyTooltipText);\n  const longUrl = getExploreLongUrl(latestQueryFormData);\n  const getShortUrl = useUrlShortener(longUrl);\n\n  const doCopyLink = async () => {\n    try {\n      setCopyTooltip(t('Loading...'));\n      const shortUrl = await getShortUrl();\n      await copyTextToClipboard(shortUrl);\n      setCopyTooltip(t('Copied to clipboard!'));\n    } catch (error) {\n      setCopyTooltip(t('Sorry, your browser does not support copying.'));\n    }\n  };\n\n  const doShareEmail = async () => {\n    try {\n      const subject = t('Superset Chart');\n      const shortUrl = await getShortUrl();\n      const body = t('%s%s', 'Check out this chart: ', shortUrl);\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  };\n\n  const doExportCSV = canDownloadCSV\n    ? exportChart.bind(this, {\n        formData: latestQueryFormData,\n        resultType: 'results',\n        resultFormat: 'csv',\n      })\n    : null;\n\n  const doExportJson = exportChart.bind(this, {\n    formData: latestQueryFormData,\n    resultType: 'results',\n    resultFormat: 'json',\n  });\n\n  const exportToCSVClasses = cx('btn btn-default btn-sm', {\n    disabled: !canDownloadCSV,\n  });\n\n  return (\n    <div\n      className=\"btn-group results\"\n      role=\"group\"\n      data-test=\"btn-group-results\"\n    >\n      {latestQueryFormData && (\n        <>\n          <ActionButton\n            icon={<Icons.Link iconSize=\"l\" />}\n            tooltip={copyTooltip}\n            onClick={doCopyLink}\n            data-test=\"short-link-button\"\n            onTooltipVisibilityChange={value =>\n              !value && setTimeout(() => setCopyTooltip(copyTooltipText), 200)\n            }\n          />\n          <ActionButton\n            icon={<Icons.Email iconSize=\"l\" />}\n            tooltip={t('Share chart by email')}\n            onClick={doShareEmail}\n          />\n          <EmbedCodeButton latestQueryFormData={latestQueryFormData} />\n          <ActionButton\n            icon={<Icons.FileTextOutlined iconSize=\"m\" />}\n            text=\".JSON\"\n            tooltip={t('Export to .JSON format')}\n            onClick={doExportJson}\n          />\n          <ActionButton\n            icon={<Icons.FileExcelOutlined iconSize=\"m\" />}\n            text=\".CSV\"\n            tooltip={t('Export to .CSV format')}\n            onClick={doExportCSV}\n            className={exportToCSVClasses}\n          />\n        </>\n      )}\n      <ExploreAdditionalActionsMenu\n        latestQueryFormData={latestQueryFormData}\n        chartStatus={chartStatus}\n        onOpenInEditor={actions.redirectSQLLab}\n        onOpenPropertiesModal={actions.openPropertiesModal}\n        slice={slice}\n      />\n    </div>\n  );\n};\n\nexport default withToasts(ExploreActionButtons);\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}