{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { GenericDataType } from '@superset-ui/core';\nimport { FALSE_STRING, NULL_STRING, TRUE_STRING } from 'src/utils/common';\nexport const getSelectExtraFormData = (col, value, emptyFilter = false, inverseSelection = false) => {\n  const extra = {};\n  if (emptyFilter) {\n    extra.adhoc_filters = [\n    {\n      expressionType: 'SQL',\n      clause: 'WHERE',\n      sqlExpression: '1 = 0' }];\n\n\n  } else\n  if (value !== undefined && value !== null && value.length !== 0) {\n    extra.filters = [\n    {\n      col,\n      op: inverseSelection ? 'NOT IN' : 'IN',\n      val: value }];\n\n\n  }\n  return extra;\n};\nexport const getRangeExtraFormData = (col, lower, upper) => {\n  const filters = [];\n  if (lower !== undefined && lower !== null) {\n    filters.push({ col, op: '>=', val: lower });\n  }\n  if (upper !== undefined && upper !== null) {\n    filters.push({ col, op: '<=', val: upper });\n  }\n  return filters.length ?\n  {\n    filters } :\n\n  {};\n};\nexport function getDataRecordFormatter({ timeFormatter, numberFormatter } = {}) {\n  return (value, dtype) => {\n    if (value === null || value === undefined) {\n      return NULL_STRING;\n    }\n    if (typeof value === 'boolean') {\n      return value ? TRUE_STRING : FALSE_STRING;\n    }\n    if (dtype === GenericDataType.BOOLEAN) {\n      try {\n        return JSON.parse(String(value).toLowerCase()) ?\n        TRUE_STRING :\n        FALSE_STRING;\n      }\n      catch {\n        return FALSE_STRING;\n      }\n    }\n    if (typeof value === 'string') {\n      return value;\n    }\n    if (timeFormatter && dtype === GenericDataType.TEMPORAL) {\n      return timeFormatter(value);\n    }\n    if (numberFormatter &&\n    typeof value === 'number' &&\n    dtype === GenericDataType.NUMERIC) {\n      return numberFormatter(value);\n    }\n    return String(value);\n  };\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(getSelectExtraFormData, \"getSelectExtraFormData\", \"/app/superset-frontend/src/filters/utils.ts\");reactHotLoader.register(getRangeExtraFormData, \"getRangeExtraFormData\", \"/app/superset-frontend/src/filters/utils.ts\");reactHotLoader.register(getDataRecordFormatter, \"getDataRecordFormatter\", \"/app/superset-frontend/src/filters/utils.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/filters/utils.ts"],"names":[],"mappings":"wSAAA;;;;;;;;;;;;;;;;;AAiBG;AACH,SAEE,eAFF,QAOO,mBAPP;AAQA,SAAS,YAAT,EAAuB,WAAvB,EAAoC,WAApC,QAAuD,kBAAvD;AAEA,OAAO,MAAM,sBAAsB,GAAG,CACpC,GADoC,EAEpC,KAFoC,EAGpC,WAAW,GAAG,KAHsB,EAIpC,gBAAgB,GAAG,KAJiB,KAKnB;AACjB,QAAM,KAAK,GAAkB,EAA7B;AACA,MAAI,WAAJ,EAAiB;AACf,IAAA,KAAK,CAAC,aAAN,GAAsB;AACpB;AACE,MAAA,cAAc,EAAE,KADlB;AAEE,MAAA,MAAM,EAAE,OAFV;AAGE,MAAA,aAAa,EAAE,OAHjB,EADoB,CAAtB;;;AAOD,GARD;AAQO,MAAI,KAAK,KAAK,SAAV,IAAuB,KAAK,KAAK,IAAjC,IAAyC,KAAK,CAAC,MAAN,KAAiB,CAA9D,EAAiE;AACtE,IAAA,KAAK,CAAC,OAAN,GAAgB;AACd;AACE,MAAA,GADF;AAEE,MAAA,EAAE,EAAE,gBAAgB,GAAI,QAAJ,GAA0B,IAFhD;AAGE,MAAA,GAAG,EAAE,KAHP,EADc,CAAhB;;;AAOD;AACD,SAAO,KAAP;AACD,CAzBM;AA2BP,OAAO,MAAM,qBAAqB,GAAG,CACnC,GADmC,EAEnC,KAFmC,EAGnC,KAHmC,KAIjC;AACF,QAAM,OAAO,GAA8B,EAA3C;AACA,MAAI,KAAK,KAAK,SAAV,IAAuB,KAAK,KAAK,IAArC,EAA2C;AACzC,IAAA,OAAO,CAAC,IAAR,CAAa,EAAE,GAAF,EAAO,EAAE,EAAE,IAAX,EAAiB,GAAG,EAAE,KAAtB,EAAb;AACD;AACD,MAAI,KAAK,KAAK,SAAV,IAAuB,KAAK,KAAK,IAArC,EAA2C;AACzC,IAAA,OAAO,CAAC,IAAR,CAAa,EAAE,GAAF,EAAO,EAAE,EAAE,IAAX,EAAiB,GAAG,EAAE,KAAtB,EAAb;AACD;AAED,SAAO,OAAO,CAAC,MAAR;AACH;AACE,IAAA,OADF,EADG;;AAIH,IAJJ;AAKD,CAlBM;AAwBP,OAAM,SAAU,sBAAV,CAAiC,EACrC,aADqC,EAErC,eAFqC,KAMnC,EANE,EAMA;AACJ,SAAO,CAAC,KAAD,EAAQ,KAAR,KAAiB;AACtB,QAAI,KAAK,KAAK,IAAV,IAAkB,KAAK,KAAK,SAAhC,EAA2C;AACzC,aAAO,WAAP;AACD;AACD,QAAI,OAAO,KAAP,KAAiB,SAArB,EAAgC;AAC9B,aAAO,KAAK,GAAG,WAAH,GAAiB,YAA7B;AACD;AACD,QAAI,KAAK,KAAK,eAAe,CAAC,OAA9B,EAAuC;AACrC,UAAI;AACF,eAAO,IAAI,CAAC,KAAL,CAAW,MAAM,CAAC,KAAD,CAAN,CAAc,WAAd,EAAX;AACH,QAAA,WADG;AAEH,QAAA,YAFJ;AAGD;AAAC,YAAM;AACN,eAAO,YAAP;AACD;AACF;AACD,QAAI,OAAO,KAAP,KAAiB,QAArB,EAA+B;AAC7B,aAAO,KAAP;AACD;AACD,QAAI,aAAa,IAAI,KAAK,KAAK,eAAe,CAAC,QAA/C,EAAyD;AACvD,aAAO,aAAa,CAAC,KAAD,CAApB;AACD;AACD,QACE,eAAe;AACf,WAAO,KAAP,KAAiB,QADjB;AAEA,IAAA,KAAK,KAAK,eAAe,CAAC,OAH5B,EAIE;AACA,aAAO,eAAe,CAAC,KAAD,CAAtB;AACD;AACD,WAAO,MAAM,CAAC,KAAD,CAAb;AACD,GA9BD;AA+BD,C,iLAzFY,sB,mGA2BA,qB,kGAwBG,sB","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataRecordValue,\n  GenericDataType,\n  NumberFormatter,\n  QueryObjectFilterClause,\n  TimeFormatter,\n  ExtraFormData,\n} from '@superset-ui/core';\nimport { FALSE_STRING, NULL_STRING, TRUE_STRING } from 'src/utils/common';\n\nexport const getSelectExtraFormData = (\n  col: string,\n  value?: null | (string | number)[],\n  emptyFilter = false,\n  inverseSelection = false,\n): ExtraFormData => {\n  const extra: ExtraFormData = {};\n  if (emptyFilter) {\n    extra.adhoc_filters = [\n      {\n        expressionType: 'SQL',\n        clause: 'WHERE',\n        sqlExpression: '1 = 0',\n      },\n    ];\n  } else if (value !== undefined && value !== null && value.length !== 0) {\n    extra.filters = [\n      {\n        col,\n        op: inverseSelection ? ('NOT IN' as const) : ('IN' as const),\n        val: value,\n      },\n    ];\n  }\n  return extra;\n};\n\nexport const getRangeExtraFormData = (\n  col: string,\n  lower?: number | null,\n  upper?: number | null,\n) => {\n  const filters: QueryObjectFilterClause[] = [];\n  if (lower !== undefined && lower !== null) {\n    filters.push({ col, op: '>=', val: lower });\n  }\n  if (upper !== undefined && upper !== null) {\n    filters.push({ col, op: '<=', val: upper });\n  }\n\n  return filters.length\n    ? {\n        filters,\n      }\n    : {};\n};\n\nexport interface DataRecordValueFormatter {\n  (value: DataRecordValue, dtype: GenericDataType): string;\n}\n\nexport function getDataRecordFormatter({\n  timeFormatter,\n  numberFormatter,\n}: {\n  timeFormatter?: TimeFormatter;\n  numberFormatter?: NumberFormatter;\n} = {}): DataRecordValueFormatter {\n  return (value, dtype) => {\n    if (value === null || value === undefined) {\n      return NULL_STRING;\n    }\n    if (typeof value === 'boolean') {\n      return value ? TRUE_STRING : FALSE_STRING;\n    }\n    if (dtype === GenericDataType.BOOLEAN) {\n      try {\n        return JSON.parse(String(value).toLowerCase())\n          ? TRUE_STRING\n          : FALSE_STRING;\n      } catch {\n        return FALSE_STRING;\n      }\n    }\n    if (typeof value === 'string') {\n      return value;\n    }\n    if (timeFormatter && dtype === GenericDataType.TEMPORAL) {\n      return timeFormatter(value);\n    }\n    if (\n      numberFormatter &&\n      typeof value === 'number' &&\n      dtype === GenericDataType.NUMERIC\n    ) {\n      return numberFormatter(value);\n    }\n    return String(value);\n  };\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}