{"ast":null,"code":"import \"core-js/modules/es.string.replace.js\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { t, supersetTheme, ThemeProvider } from '@superset-ui/core';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport throttle from 'lodash/throttle';\nimport TabbedSqlEditors from './TabbedSqlEditors';\nimport QueryAutoRefresh from './QueryAutoRefresh';\nimport QuerySearch from './QuerySearch';\nimport ToastPresenter from '../../messageToasts/containers/ToastPresenter';\nimport {\nLOCALSTORAGE_MAX_USAGE_KB,\nLOCALSTORAGE_WARNING_THRESHOLD,\nLOCALSTORAGE_WARNING_MESSAGE_THROTTLE_MS } from\n'../constants';\nimport * as Actions from '../actions/sqlLab';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nclass App extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hash: window.location.hash };\n\n\n    this.showLocalStorageUsageWarning = throttle(\n    this.showLocalStorageUsageWarning,\n    LOCALSTORAGE_WARNING_MESSAGE_THROTTLE_MS,\n    { trailing: false });\n\n  }\n\n  componentDidMount() {var _context;\n    window.addEventListener('hashchange', _bindInstanceProperty(_context = this.onHashChanged).call(_context, this));\n  }\n\n  componentDidUpdate() {\n    if (\n    this.props.localStorageUsageInKilobytes >=\n    LOCALSTORAGE_WARNING_THRESHOLD * LOCALSTORAGE_MAX_USAGE_KB)\n    {\n      this.showLocalStorageUsageWarning(\n      this.props.localStorageUsageInKilobytes);\n\n    }\n  }\n\n  componentWillUnmount() {var _context2;\n    window.removeEventListener('hashchange', _bindInstanceProperty(_context2 = this.onHashChanged).call(_context2, this));\n  }\n\n  onHashChanged() {\n    this.setState({ hash: window.location.hash });\n  }\n\n  showLocalStorageUsageWarning(currentUsage) {\n    this.props.actions.addDangerToast(\n    t(\n    \"SQL Lab uses your browser's local storage to store queries and results.\" +\n    `\\n Currently, you are using ${currentUsage.toFixed(\n    2)\n    } KB out of ${LOCALSTORAGE_MAX_USAGE_KB} KB. storage space.` +\n    '\\n To keep SQL Lab from crashing, please delete some query tabs.' +\n    '\\n You can re-access these queries by using the Save feature before you delete the tab. ' +\n    'Note that you will need to close other SQL Lab windows before you do this.'));\n\n\n  }\n\n  render() {\n    let content;\n    if (this.state.hash && this.state.hash === '#search') {\n      if (isFeatureEnabled(FeatureFlag.ENABLE_REACT_CRUD_VIEWS)) {\n        return window.location.replace('/superset/sqllab/history/');\n      }\n      content =\n      ___EmotionJSX(QuerySearch, {\n        actions: this.props.actions,\n        displayLimit: this.props.common.conf.DISPLAY_MAX_ROW });\n\n\n    } else {\n      content =\n      ___EmotionJSX(React.Fragment, null,\n      ___EmotionJSX(QueryAutoRefresh, null),\n      ___EmotionJSX(TabbedSqlEditors, null));\n\n\n    }\n    return (\n      ___EmotionJSX(ThemeProvider, { theme: supersetTheme },\n      ___EmotionJSX(\"div\", { className: \"App SqlLab\" },\n      content,\n      ___EmotionJSX(ToastPresenter, null))));\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nApp.propTypes = {\n  actions: PropTypes.object,\n  common: PropTypes.object,\n  localStorageUsageInKilobytes: PropTypes.number.isRequired };\n\n\nfunction mapStateToProps(state) {\n  const { common, localStorageUsageInKilobytes } = state;\n  return {\n    common,\n    localStorageUsageInKilobytes };\n\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(Actions, dispatch) };\n\n}const _default =\n\nconnect(mapStateToProps, mapDispatchToProps)(App);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(App, \"App\", \"/app/superset-frontend/src/SqlLab/components/App.jsx\");reactHotLoader.register(mapStateToProps, \"mapStateToProps\", \"/app/superset-frontend/src/SqlLab/components/App.jsx\");reactHotLoader.register(mapDispatchToProps, \"mapDispatchToProps\", \"/app/superset-frontend/src/SqlLab/components/App.jsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/SqlLab/components/App.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/SqlLab/components/App.jsx"],"names":["React","PropTypes","bindActionCreators","connect","t","supersetTheme","ThemeProvider","FeatureFlag","isFeatureEnabled","throttle","TabbedSqlEditors","QueryAutoRefresh","QuerySearch","ToastPresenter","LOCALSTORAGE_MAX_USAGE_KB","LOCALSTORAGE_WARNING_THRESHOLD","LOCALSTORAGE_WARNING_MESSAGE_THROTTLE_MS","Actions","App","PureComponent","constructor","props","state","hash","window","location","showLocalStorageUsageWarning","trailing","componentDidMount","addEventListener","onHashChanged","componentDidUpdate","localStorageUsageInKilobytes","componentWillUnmount","removeEventListener","setState","currentUsage","actions","addDangerToast","toFixed","render","content","ENABLE_REACT_CRUD_VIEWS","replace","common","conf","DISPLAY_MAX_ROW","propTypes","object","number","isRequired","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"8aAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,kBAAT,QAAmC,OAAnC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,CAAT,EAAYC,aAAZ,EAA2BC,aAA3B,QAAgD,mBAAhD;AACA,SAASC,WAAT,EAAsBC,gBAAtB,QAA8C,kBAA9C;AACA,OAAOC,QAAP,MAAqB,iBAArB;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,cAAP,MAA2B,+CAA3B;AACA;AACEC,yBADF;AAEEC,8BAFF;AAGEC,wCAHF;AAIO,cAJP;AAKA,OAAO,KAAKC,OAAZ,MAAyB,mBAAzB,C;;AAEA,MAAMC,GAAN,SAAkBlB,KAAK,CAACmB,aAAxB,CAAsC;AACpCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXC,MAAAA,IAAI,EAAEC,MAAM,CAACC,QAAP,CAAgBF,IADX,EAAb;;;AAIA,SAAKG,4BAAL,GAAoCjB,QAAQ;AAC1C,SAAKiB,4BADqC;AAE1CV,IAAAA,wCAF0C;AAG1C,MAAEW,QAAQ,EAAE,KAAZ,EAH0C,CAA5C;;AAKD;;AAEDC,EAAAA,iBAAiB,GAAG;AAClBJ,IAAAA,MAAM,CAACK,gBAAP,CAAwB,YAAxB,EAAsC,sCAAKC,aAAL,iBAAwB,IAAxB,CAAtC;AACD;;AAEDC,EAAAA,kBAAkB,GAAG;AACnB;AACE,SAAKV,KAAL,CAAWW,4BAAX;AACAjB,IAAAA,8BAA8B,GAAGD,yBAFnC;AAGE;AACA,WAAKY,4BAAL;AACE,WAAKL,KAAL,CAAWW,4BADb;;AAGD;AACF;;AAEDC,EAAAA,oBAAoB,GAAG;AACrBT,IAAAA,MAAM,CAACU,mBAAP,CAA2B,YAA3B,EAAyC,uCAAKJ,aAAL,kBAAwB,IAAxB,CAAzC;AACD;;AAEDA,EAAAA,aAAa,GAAG;AACd,SAAKK,QAAL,CAAc,EAAEZ,IAAI,EAAEC,MAAM,CAACC,QAAP,CAAgBF,IAAxB,EAAd;AACD;;AAEDG,EAAAA,4BAA4B,CAACU,YAAD,EAAe;AACzC,SAAKf,KAAL,CAAWgB,OAAX,CAAmBC,cAAnB;AACElC,IAAAA,CAAC;AACC;AACG,mCAA8BgC,YAAY,CAACG,OAAb;AAC7B,KAD6B;AAE7B,kBAAazB,yBAA0B,qBAH3C;AAIE,sEAJF;AAKE,8FALF;AAME,gFAPH,CADH;;;AAWD;;AAED0B,EAAAA,MAAM,GAAG;AACP,QAAIC,OAAJ;AACA,QAAI,KAAKnB,KAAL,CAAWC,IAAX,IAAmB,KAAKD,KAAL,CAAWC,IAAX,KAAoB,SAA3C,EAAsD;AACpD,UAAIf,gBAAgB,CAACD,WAAW,CAACmC,uBAAb,CAApB,EAA2D;AACzD,eAAOlB,MAAM,CAACC,QAAP,CAAgBkB,OAAhB,CAAwB,2BAAxB,CAAP;AACD;AACDF,MAAAA,OAAO;AACL,oBAAC,WAAD;AACE,QAAA,OAAO,EAAE,KAAKpB,KAAL,CAAWgB,OADtB;AAEE,QAAA,YAAY,EAAE,KAAKhB,KAAL,CAAWuB,MAAX,CAAkBC,IAAlB,CAAuBC,eAFvC,GADF;;;AAMD,KAVD,MAUO;AACLL,MAAAA,OAAO;AACL;AACE,oBAAC,gBAAD,OADF;AAEE,oBAAC,gBAAD,OAFF,CADF;;;AAMD;AACD;AACE,oBAAC,aAAD,IAAe,KAAK,EAAEpC,aAAtB;AACE,6BAAK,SAAS,EAAC,YAAf;AACGoC,MAAAA,OADH;AAEE,oBAAC,cAAD,OAFF,CADF,CADF;;;;AAQD,GA/EmC;AAAA;AAAA;AAkFtCvB,GAAG,CAAC6B,SAAJ,GAAgB;AACdV,EAAAA,OAAO,EAAEpC,SAAS,CAAC+C,MADL;AAEdJ,EAAAA,MAAM,EAAE3C,SAAS,CAAC+C,MAFJ;AAGdhB,EAAAA,4BAA4B,EAAE/B,SAAS,CAACgD,MAAV,CAAiBC,UAHjC,EAAhB;;;AAMA,SAASC,eAAT,CAAyB7B,KAAzB,EAAgC;AAC9B,QAAM,EAAEsB,MAAF,EAAUZ,4BAAV,KAA2CV,KAAjD;AACA,SAAO;AACLsB,IAAAA,MADK;AAELZ,IAAAA,4BAFK,EAAP;;AAID;;AAED,SAASoB,kBAAT,CAA4BC,QAA5B,EAAsC;AACpC,SAAO;AACLhB,IAAAA,OAAO,EAAEnC,kBAAkB,CAACe,OAAD,EAAUoC,QAAV,CADtB,EAAP;;AAGD,C;;AAEclD,OAAO,CAACgD,eAAD,EAAkBC,kBAAlB,CAAP,CAA6ClC,GAA7C,C,CAAf,wB,iLAtGMA,G,yFAwFGiC,e,qGAQAC,kB","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { t, supersetTheme, ThemeProvider } from '@superset-ui/core';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport throttle from 'lodash/throttle';\nimport TabbedSqlEditors from './TabbedSqlEditors';\nimport QueryAutoRefresh from './QueryAutoRefresh';\nimport QuerySearch from './QuerySearch';\nimport ToastPresenter from '../../messageToasts/containers/ToastPresenter';\nimport {\n  LOCALSTORAGE_MAX_USAGE_KB,\n  LOCALSTORAGE_WARNING_THRESHOLD,\n  LOCALSTORAGE_WARNING_MESSAGE_THROTTLE_MS,\n} from '../constants';\nimport * as Actions from '../actions/sqlLab';\n\nclass App extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hash: window.location.hash,\n    };\n\n    this.showLocalStorageUsageWarning = throttle(\n      this.showLocalStorageUsageWarning,\n      LOCALSTORAGE_WARNING_MESSAGE_THROTTLE_MS,\n      { trailing: false },\n    );\n  }\n\n  componentDidMount() {\n    window.addEventListener('hashchange', this.onHashChanged.bind(this));\n  }\n\n  componentDidUpdate() {\n    if (\n      this.props.localStorageUsageInKilobytes >=\n      LOCALSTORAGE_WARNING_THRESHOLD * LOCALSTORAGE_MAX_USAGE_KB\n    ) {\n      this.showLocalStorageUsageWarning(\n        this.props.localStorageUsageInKilobytes,\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('hashchange', this.onHashChanged.bind(this));\n  }\n\n  onHashChanged() {\n    this.setState({ hash: window.location.hash });\n  }\n\n  showLocalStorageUsageWarning(currentUsage) {\n    this.props.actions.addDangerToast(\n      t(\n        \"SQL Lab uses your browser's local storage to store queries and results.\" +\n          `\\n Currently, you are using ${currentUsage.toFixed(\n            2,\n          )} KB out of ${LOCALSTORAGE_MAX_USAGE_KB} KB. storage space.` +\n          '\\n To keep SQL Lab from crashing, please delete some query tabs.' +\n          '\\n You can re-access these queries by using the Save feature before you delete the tab. ' +\n          'Note that you will need to close other SQL Lab windows before you do this.',\n      ),\n    );\n  }\n\n  render() {\n    let content;\n    if (this.state.hash && this.state.hash === '#search') {\n      if (isFeatureEnabled(FeatureFlag.ENABLE_REACT_CRUD_VIEWS)) {\n        return window.location.replace('/superset/sqllab/history/');\n      }\n      content = (\n        <QuerySearch\n          actions={this.props.actions}\n          displayLimit={this.props.common.conf.DISPLAY_MAX_ROW}\n        />\n      );\n    } else {\n      content = (\n        <>\n          <QueryAutoRefresh />\n          <TabbedSqlEditors />\n        </>\n      );\n    }\n    return (\n      <ThemeProvider theme={supersetTheme}>\n        <div className=\"App SqlLab\">\n          {content}\n          <ToastPresenter />\n        </div>\n      </ThemeProvider>\n    );\n  }\n}\n\nApp.propTypes = {\n  actions: PropTypes.object,\n  common: PropTypes.object,\n  localStorageUsageInKilobytes: PropTypes.number.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  const { common, localStorageUsageInKilobytes } = state;\n  return {\n    common,\n    localStorageUsageInKilobytes,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(Actions, dispatch),\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}