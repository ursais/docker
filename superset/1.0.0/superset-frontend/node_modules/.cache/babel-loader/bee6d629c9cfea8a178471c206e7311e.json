{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState } from 'react';\nimport { styled, t } from '@superset-ui/core';\nimport SyntaxHighlighter from 'react-syntax-highlighter/dist/cjs/light';\nimport github from 'react-syntax-highlighter/dist/cjs/styles/hljs/github';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport Loading from 'src/components/Loading';\nimport { CopyButton } from 'src/explore/components/DataTableControl';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { getChartDataRequest } from 'src/chart/chartAction';\nimport markdownSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/markdown';\nimport htmlSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/htmlbars';\nimport sqlSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/sql';\nimport jsonSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/json';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst CopyButtonViewQuery = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\nSyntaxHighlighter.registerLanguage('markdown', markdownSyntax);\nSyntaxHighlighter.registerLanguage('html', htmlSyntax);\nSyntaxHighlighter.registerLanguage('sql', sqlSyntax);\nSyntaxHighlighter.registerLanguage('json', jsonSyntax);\nconst ViewQueryModal = props => {\n  const [language, setLanguage] = useState(null);\n  const [query, setQuery] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const loadChartData = resultType => {\n    setIsLoading(true);\n    getChartDataRequest({\n      formData: props.latestQueryFormData,\n      resultFormat: 'json',\n      resultType }).\n\n    then(response => {\n      // Only displaying the first query is currently supported\n      const result = response.result[0];\n      setLanguage(result.language);\n      setQuery(result.query);\n      setIsLoading(false);\n      setError(null);\n    }).\n    catch(response => {\n      getClientErrorObject(response).then(({ error, message }) => {\n        setError(error ||\n        message ||\n        response.statusText ||\n        t('Sorry, An error occurred'));\n        setIsLoading(false);\n      });\n    });\n  };\n  useEffect(() => {\n    loadChartData('query');\n  }, [props.latestQueryFormData]);\n  if (isLoading) {\n    return ___EmotionJSX(Loading, null);\n  }\n  if (error) {\n    return ___EmotionJSX(\"pre\", null, error);\n  }\n  if (query) {\n    return ___EmotionJSX(\"div\", null,\n    ___EmotionJSX(CopyToClipboard, { text: query, shouldShowText: false, copyNode: ___EmotionJSX(CopyButtonViewQuery, { buttonSize: \"xsmall\" },\n      ___EmotionJSX(\"i\", { className: \"fa fa-clipboard\" })) }),\n\n    ___EmotionJSX(SyntaxHighlighter, { language: language || undefined, style: github },\n    query));\n\n\n  }\n  return null;\n};__signature__(ViewQueryModal, \"useState{[language, setLanguage](null)}\\nuseState{[query, setQuery](null)}\\nuseState{[isLoading, setIsLoading](false)}\\nuseState{[error, setError](null)}\\nuseEffect{}\");const _default =\nViewQueryModal;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(CopyButtonViewQuery, \"CopyButtonViewQuery\", \"/app/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\");reactHotLoader.register(ViewQueryModal, \"ViewQueryModal\", \"/app/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState } from 'react';\nimport { styled, t } from '@superset-ui/core';\nimport SyntaxHighlighter from 'react-syntax-highlighter/dist/cjs/light';\nimport github from 'react-syntax-highlighter/dist/cjs/styles/hljs/github';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport Loading from 'src/components/Loading';\nimport { CopyButton } from 'src/explore/components/DataTableControl';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { getChartDataRequest } from 'src/chart/chartAction';\nimport markdownSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/markdown';\nimport htmlSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/htmlbars';\nimport sqlSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/sql';\nimport jsonSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/json';\n\nconst CopyButtonViewQuery = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nSyntaxHighlighter.registerLanguage('markdown', markdownSyntax);\nSyntaxHighlighter.registerLanguage('html', htmlSyntax);\nSyntaxHighlighter.registerLanguage('sql', sqlSyntax);\nSyntaxHighlighter.registerLanguage('json', jsonSyntax);\n\ninterface Props {\n  latestQueryFormData: object;\n}\n\nconst ViewQueryModal: React.FC<Props> = props => {\n  const [language, setLanguage] = useState(null);\n  const [query, setQuery] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loadChartData = (resultType: string) => {\n    setIsLoading(true);\n    getChartDataRequest({\n      formData: props.latestQueryFormData,\n      resultFormat: 'json',\n      resultType,\n    })\n      .then(response => {\n        // Only displaying the first query is currently supported\n        const result = response.result[0];\n        setLanguage(result.language);\n        setQuery(result.query);\n        setIsLoading(false);\n        setError(null);\n      })\n      .catch(response => {\n        getClientErrorObject(response).then(({ error, message }) => {\n          setError(\n            error ||\n              message ||\n              response.statusText ||\n              t('Sorry, An error occurred'),\n          );\n          setIsLoading(false);\n        });\n      });\n  };\n  useEffect(() => {\n    loadChartData('query');\n  }, [props.latestQueryFormData]);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n  if (error) {\n    return <pre>{error}</pre>;\n  }\n  if (query) {\n    return (\n      <div>\n        <CopyToClipboard\n          text={query}\n          shouldShowText={false}\n          copyNode={\n            <CopyButtonViewQuery buttonSize=\"xsmall\">\n              <i className=\"fa fa-clipboard\" />\n            </CopyButtonViewQuery>\n          }\n        />\n        <SyntaxHighlighter language={language || undefined} style={github}>\n          {query}\n        </SyntaxHighlighter>\n      </div>\n    );\n  }\n  return null;\n};\n\nexport default ViewQueryModal;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}