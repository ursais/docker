{"version":3,"sources":["../../../src/multipass/mask-pass.js"],"names":["Pass","MaskPass","constructor","gl","props","Object","assign","id","inverse","clearStencil","_renderPass","writeValue","clearValue","colorMask","depthMask","enable","stencilOp","stencilFunc"],"mappings":"AAMA,OAAOA,IAAP,MAAiB,QAAjB;AAEA,eAAe,MAAMC,QAAN,SAAuBD,IAAvB,CAA4B;AACzCE,EAAAA,WAAW,CAACC,EAAD,EAAKC,KAAK,GAAG,EAAb,EAAiB;AAC1B,UAAMD,EAAN,EAAUE,MAAM,CAACC,MAAP,CAAc;AAACC,MAAAA,EAAE,EAAE;AAAL,KAAd,EAAiCH,KAAjC,CAAV;AACA,SAAKI,OAAL,GAAe,KAAf;AACA,SAAKC,YAAL,GAAoB,IAApB;AACD;;AAEDC,EAAAA,WAAW,CAAC;AAACP,IAAAA;AAAD,GAAD,EAAO;AAChB,QAAIQ,UAAU,GAAG,CAAjB;AACA,QAAIC,UAAU,GAAG,CAAjB;;AACA,QAAI,KAAKJ,OAAT,EAAkB;AAChBG,MAAAA,UAAU,GAAG,CAAb;AACAC,MAAAA,UAAU,GAAG,CAAb;AACD;;AAGDT,IAAAA,EAAE,CAACU,SAAH,CAAa,KAAb,EAAoB,KAApB,EAA2B,KAA3B,EAAkC,KAAlC;AACAV,IAAAA,EAAE,CAACW,SAAH,CAAa,KAAb;AAGAX,IAAAA,EAAE,CAACY,MAAH;AACAZ,IAAAA,EAAE,CAACa,SAAH;AACAb,IAAAA,EAAE,CAACc,WAAH,MAA0BN,UAA1B,EAAsC,UAAtC;AACAR,IAAAA,EAAE,CAACM,YAAH,CAAgBG,UAAhB;AAOAT,IAAAA,EAAE,CAACU,SAAH,CAAa,IAAb,EAAmB,IAAnB,EAAyB,IAAzB,EAA+B,IAA/B;AACAV,IAAAA,EAAE,CAACW,SAAH,CAAa,IAAb;AAGAX,IAAAA,EAAE,CAACc,WAAH,MAAyB,CAAzB,EAA4B,UAA5B;AACAd,IAAAA,EAAE,CAACa,SAAH;AACD;;AApCwC","sourcesContent":["//\n// A mask pass.\n//\n// Attribution: This class and the multipass system were inspired by\n// the THREE.js EffectComposer and *Pass classes\n\nimport Pass from './pass';\n\nexport default class MaskPass extends Pass {\n  constructor(gl, props = {}) {\n    super(gl, Object.assign({id: 'mask-pass'}, props));\n    this.inverse = false;\n    this.clearStencil = true;\n  }\n\n  _renderPass({gl}) {\n    let writeValue = 1;\n    let clearValue = 0;\n    if (this.inverse) {\n      writeValue = 0;\n      clearValue = 1;\n    }\n\n    // don't update color or depth\n    gl.colorMask(false, false, false, false);\n    gl.depthMask(false);\n\n    // set up stencil\n    gl.enable(gl.STENCIL_TEST);\n    gl.stencilOp(gl.REPLACE, gl.REPLACE, gl.REPLACE);\n    gl.stencilFunc(gl.ALWAYS, writeValue, 0xffffffff);\n    gl.clearStencil(clearValue);\n\n    // TODO - draw into the stencil buffers of the two framebuffers\n    // renderer.render(this.scene, this.camera, this.readBuffer, this.clear);\n    // renderer.render(this.scene, this.camera, this.writeBuffer, this.clear);\n\n    // re-enable update of color and depth\n    gl.colorMask(true, true, true, true);\n    gl.depthMask(true);\n\n    // only render where stencil is set to 1\n    gl.stencilFunc(gl.EQUAL, 1, 0xffffffff); // draw if == 1\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n  }\n}\n"],"file":"mask-pass.js"}