{"version":3,"sources":["../../../src/multipass/mask-pass.js"],"names":["MaskPass","gl","props","Object","assign","id","inverse","clearStencil","writeValue","clearValue","colorMask","depthMask","enable","stencilOp","stencilFunc","Pass"],"mappings":";;;;;;;;;;;;;;;;;;;AAMA;;IAEqBA,Q;;;AACnB,oBAAYC,EAAZ,EAA4B;AAAA;;AAAA,QAAZC,KAAY,uEAAJ,EAAI;AAAA;AAC1B,oHAAMD,EAAN,EAAUE,MAAM,CAACC,MAAP,CAAc;AAACC,MAAAA,EAAE,EAAE;AAAL,KAAd,EAAiCH,KAAjC,CAAV;AACA,UAAKI,OAAL,GAAe,KAAf;AACA,UAAKC,YAAL,GAAoB,IAApB;AAH0B;AAI3B;;;;sCAEiB;AAAA,UAALN,EAAK,QAALA,EAAK;AAChB,UAAIO,UAAU,GAAG,CAAjB;AACA,UAAIC,UAAU,GAAG,CAAjB;;AACA,UAAI,KAAKH,OAAT,EAAkB;AAChBE,QAAAA,UAAU,GAAG,CAAb;AACAC,QAAAA,UAAU,GAAG,CAAb;AACD;;AAGDR,MAAAA,EAAE,CAACS,SAAH,CAAa,KAAb,EAAoB,KAApB,EAA2B,KAA3B,EAAkC,KAAlC;AACAT,MAAAA,EAAE,CAACU,SAAH,CAAa,KAAb;AAGAV,MAAAA,EAAE,CAACW,MAAH;AACAX,MAAAA,EAAE,CAACY,SAAH;AACAZ,MAAAA,EAAE,CAACa,WAAH,MAA0BN,UAA1B,EAAsC,UAAtC;AACAP,MAAAA,EAAE,CAACM,YAAH,CAAgBE,UAAhB;AAOAR,MAAAA,EAAE,CAACS,SAAH,CAAa,IAAb,EAAmB,IAAnB,EAAyB,IAAzB,EAA+B,IAA/B;AACAT,MAAAA,EAAE,CAACU,SAAH,CAAa,IAAb;AAGAV,MAAAA,EAAE,CAACa,WAAH,MAAyB,CAAzB,EAA4B,UAA5B;AACAb,MAAAA,EAAE,CAACY,SAAH;AACD;;;EApCmCE,gB","sourcesContent":["//\n// A mask pass.\n//\n// Attribution: This class and the multipass system were inspired by\n// the THREE.js EffectComposer and *Pass classes\n\nimport Pass from './pass';\n\nexport default class MaskPass extends Pass {\n  constructor(gl, props = {}) {\n    super(gl, Object.assign({id: 'mask-pass'}, props));\n    this.inverse = false;\n    this.clearStencil = true;\n  }\n\n  _renderPass({gl}) {\n    let writeValue = 1;\n    let clearValue = 0;\n    if (this.inverse) {\n      writeValue = 0;\n      clearValue = 1;\n    }\n\n    // don't update color or depth\n    gl.colorMask(false, false, false, false);\n    gl.depthMask(false);\n\n    // set up stencil\n    gl.enable(gl.STENCIL_TEST);\n    gl.stencilOp(gl.REPLACE, gl.REPLACE, gl.REPLACE);\n    gl.stencilFunc(gl.ALWAYS, writeValue, 0xffffffff);\n    gl.clearStencil(clearValue);\n\n    // TODO - draw into the stencil buffers of the two framebuffers\n    // renderer.render(this.scene, this.camera, this.readBuffer, this.clear);\n    // renderer.render(this.scene, this.camera, this.writeBuffer, this.clear);\n\n    // re-enable update of color and depth\n    gl.colorMask(true, true, true, true);\n    gl.depthMask(true);\n\n    // only render where stencil is set to 1\n    gl.stencilFunc(gl.EQUAL, 1, 0xffffffff); // draw if == 1\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n  }\n}\n"],"file":"mask-pass.js"}