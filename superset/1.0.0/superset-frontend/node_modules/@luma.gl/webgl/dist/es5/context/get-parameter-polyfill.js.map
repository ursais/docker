{"version":3,"sources":["../../../src/context/get-parameter-polyfill.js"],"names":["WEBGL_debug_renderer_info","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","getParameter","gl","originalFunc","pname","GL_UNMASKED_VENDOR_WEBGL","GL_UNMASKED_RENDERER_WEBGL","GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT","GL_FRAGMENT_SHADER_DERIVATIVE_HINT","GL_DONT_CARE","GL_GPU_DISJOINT_EXT","extensions","luma","info","getExtension","UNMASKED_VENDOR_WEBGL","UNMASKED_RENDERER_WEBGL","undefined","hasTimerQueries","ext","MAX_TEXTURE_MAX_ANISOTROPY_EXT"],"mappings":";;;;;;;AAKA;;AAEA,IAAMA,yBAAyB,GAAG,2BAAlC;AACA,IAAMC,wBAAwB,GAAG,0BAAjC;AACA,IAAMC,+BAA+B,GAAG,iCAAxC;AACA,IAAMC,8BAA8B,GAAG,gCAAvC;;AAGO,SAASC,YAAT,CAAsBC,EAAtB,EAA0BC,YAA1B,EAAwCC,KAAxC,EAA+C;AACpD,MAAMC,wBAAwB,GAAG,MAAjC;AACA,MAAMC,0BAA0B,GAAG,MAAnC;AAEA,MAAMC,iCAAiC,GAAG,MAA1C;AAEA,MAAMC,kCAAkC,GAAG,MAA3C;AACA,MAAMC,YAAY,GAAG,MAArB;AACA,MAAMC,mBAAmB,GAAG,MAA5B;AARoD,MAU7CC,UAV6C,GAU/BT,EAAE,CAACU,IAV4B,CAU7CD,UAV6C;AAYpD,MAAME,IAAI,GAAGX,EAAE,CAACY,YAAH,CAAgBjB,yBAAhB,CAAb;;AAEA,UAAQO,KAAR;AAEE,SAAKC,wBAAL;AACE,aAAOF,YAAY,CAAEU,IAAI,IAAIA,IAAI,CAACE,qBAAd,QAAD,CAAnB;;AACF,SAAKT,0BAAL;AACE,aAAOH,YAAY,CAAEU,IAAI,IAAIA,IAAI,CAACG,uBAAd,QAAD,CAAnB;;AAEF,SAAKR,kCAAL;AACE,aAAO,CAAC,0BAASN,EAAT,CAAD,GAAgBO,YAAhB,GAA+BQ,SAAtC;;AAEF,SAAKP,mBAAL;AACE,UAAMQ,eAAe,GACnB,CAACP,UAAU,CAACb,wBAAD,CAAX,IAAyC,CAACa,UAAU,CAACZ,+BAAD,CADtD;AAEA,aAAOmB,eAAe,GAAG,CAAH,GAAOD,SAA7B;;AAEF,SAAKV,iCAAL;AACE,UAAMY,GAAG,GAAGjB,EAAE,CAACU,IAAH,CAAQD,UAAR,CAAmBX,8BAAnB,CAAZ;AACAI,MAAAA,KAAK,GAAGe,GAAG,IAAIA,GAAG,CAACC,8BAAnB;AACA,aAAO,CAAChB,KAAD,GAAS,GAAT,GAAea,SAAtB;;AAEF;AACE,aAAOA,SAAP;AArBJ;AAuBD","sourcesContent":["// A major polyfill of \"gl.getParameter\"\n// Attempts to return sane values for extension constants\n// TODO - Move WebGL2 polyfills into webgl2-polyfill module\n/* eslint-disable camelcase */\nimport GL from '@luma.gl/constants';\nimport {isWebGL2} from '../webgl-utils';\n\nconst WEBGL_debug_renderer_info = 'WEBGL_debug_renderer_info';\nconst EXT_disjoint_timer_query = 'EXT_disjoint_timer_query';\nconst EXT_disjoint_timer_query_webgl2 = 'EXT_disjoint_timer_query_webgl2';\nconst EXT_texture_filter_anisotropic = 'EXT_texture_filter_anisotropic';\n\n// eslint-disable-next-line complexity\nexport function getParameter(gl, originalFunc, pname) {\n  const GL_UNMASKED_VENDOR_WEBGL = 0x9245; // vendor string of the graphics driver.\n  const GL_UNMASKED_RENDERER_WEBGL = 0x9246; // renderer string of the graphics driver.\n\n  const GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT = 0x84ff;\n\n  const GL_FRAGMENT_SHADER_DERIVATIVE_HINT = 0x8b8b;\n  const GL_DONT_CARE = 0x1100;\n  const GL_GPU_DISJOINT_EXT = 0x8fbb;\n\n  const {extensions} = gl.luma;\n\n  const info = gl.getExtension(WEBGL_debug_renderer_info);\n\n  switch (pname) {\n    // EXTENSIONS SOMETIMES DO NOT USE THE OFFICIAL CONSTANTS.\n    case GL_UNMASKED_VENDOR_WEBGL:\n      return originalFunc((info && info.UNMASKED_VENDOR_WEBGL) || GL.VENDOR);\n    case GL_UNMASKED_RENDERER_WEBGL:\n      return originalFunc((info && info.UNMASKED_RENDERER_WEBGL) || GL.RENDERER);\n\n    case GL_FRAGMENT_SHADER_DERIVATIVE_HINT:\n      return !isWebGL2(gl) ? GL_DONT_CARE : undefined;\n\n    case GL_GPU_DISJOINT_EXT:\n      const hasTimerQueries =\n        !extensions[EXT_disjoint_timer_query] && !extensions[EXT_disjoint_timer_query_webgl2];\n      return hasTimerQueries ? 0 : undefined;\n\n    case GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT:\n      const ext = gl.luma.extensions[EXT_texture_filter_anisotropic];\n      pname = ext && ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT;\n      return !pname ? 1.0 : undefined;\n\n    default:\n      return undefined;\n  }\n}\n"],"file":"get-parameter-polyfill.js"}