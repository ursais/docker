{"version":3,"sources":["../../../src/context/create-canvas.js"],"names":["isBrowser","isPage","document","isPageLoaded","readyState","pageLoadPromise","getPageLoadPromise","Promise","resolve","reject","window","onload","createCanvas","width","height","id","insert","canvas","createElement","style","Number","isFinite","body","insertBefore","firstChild","getCanvas","onError","targetCanvas","getElementById"],"mappings":"AAGA,SAAQA,SAAR,QAAwB,UAAxB;AAEA,IAAMC,MAAM,GAAGD,SAAS,IAAI,OAAOE,QAAP,KAAoB,WAAhD;AACA,IAAIC,YAAY,GAAGF,MAAM,IAAIC,QAAQ,CAACE,UAAT,KAAwB,UAArD;AAEA,IAAIC,eAAJ;AAOA,OAAO,SAASC,kBAAT,GAA8B;AACnC,MAAI,CAACD,eAAL,EAAsB;AACpBA,IAAAA,eAAe,GAAGJ,MAAM,GACpB,IAAIM,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC/B,UAAIR,MAAM,IAAIC,QAAQ,CAACE,UAAT,KAAwB,UAAtC,EAAkD;AAChDD,QAAAA,YAAY,GAAG,IAAf;AACAK,QAAAA,OAAO,CAACN,QAAD,CAAP;AACA;AACD;;AACDQ,MAAAA,MAAM,CAACC,MAAP,GAAgB,YAAM;AACpBR,QAAAA,YAAY,GAAG,IAAf;AACAK,QAAAA,OAAO,CAACN,QAAD,CAAP;AACD,OAHD;AAID,KAVD,CADoB,GAYpBK,OAAO,CAACC,OAAR,CAAgB,EAAhB,CAZJ;AAaD;;AACD,SAAOH,eAAP;AACD;AAOD,OAAO,SAASO,YAAT,OAAoF;AAAA,wBAA7DC,KAA6D;AAAA,MAA7DA,KAA6D,2BAArD,GAAqD;AAAA,yBAAhDC,MAAgD;AAAA,MAAhDA,MAAgD,4BAAvC,GAAuC;AAAA,qBAAlCC,EAAkC;AAAA,MAAlCA,EAAkC,wBAA7B,WAA6B;AAAA,yBAAhBC,MAAgB;AAAA,MAAhBA,MAAgB,4BAAP,IAAO;AACzF,MAAMC,MAAM,GAAGf,QAAQ,CAACgB,aAAT,CAAuB,QAAvB,CAAf;AACAD,EAAAA,MAAM,CAACF,EAAP,GAAYA,EAAZ;AACAE,EAAAA,MAAM,CAACE,KAAP,CAAaN,KAAb,GAAqBO,MAAM,CAACC,QAAP,CAAgBR,KAAhB,cAA4BA,KAA5B,UAAwC,MAA7D;AACAI,EAAAA,MAAM,CAACE,KAAP,CAAaL,MAAb,GAAsBM,MAAM,CAACC,QAAP,CAAgBP,MAAhB,cAA6BA,MAA7B,UAA0C,MAAhE;;AAEA,MAAIE,MAAJ,EAAY;AACV,QAAMM,IAAI,GAAGpB,QAAQ,CAACoB,IAAtB;AACAA,IAAAA,IAAI,CAACC,YAAL,CAAkBN,MAAlB,EAA0BK,IAAI,CAACE,UAA/B;AAED;;AACD,SAAOP,MAAP;AACD;AAED,OAAO,SAASQ,SAAT,QAAgE;AAAA,MAA5CR,MAA4C,SAA5CA,MAA4C;AAAA,MAApCJ,KAAoC,SAApCA,KAAoC;AAAA,MAA7BC,MAA6B,SAA7BA,MAA6B;AAAA,4BAArBY,OAAqB;AAAA,MAArBA,OAAqB,8BAAX,YAAM,CAAE,CAAG;AACrE,MAAIC,YAAJ;;AACA,MAAI,OAAOV,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,QAAI,CAACd,YAAL,EAAmB;AACjBuB,MAAAA,OAAO,6CAAsCT,MAAtC,8BAAP;AACD;;AACDU,IAAAA,YAAY,GAAGzB,QAAQ,CAAC0B,cAAT,CAAwBX,MAAxB,CAAf;AACD,GALD,MAKO,IAAIA,MAAJ,EAAY;AACjBU,IAAAA,YAAY,GAAGV,MAAf;AACD,GAFM,MAEA;AACLU,IAAAA,YAAY,GAAGf,YAAY,CAAC;AAACG,MAAAA,EAAE,EAAE,eAAL;AAAsBF,MAAAA,KAAK,EAALA,KAAtB;AAA6BC,MAAAA,MAAM,EAANA,MAA7B;AAAqCY,MAAAA,OAAO,EAAPA;AAArC,KAAD,CAA3B;AACD;;AAED,SAAOC,YAAP;AACD","sourcesContent":["// Resizing a webgl canvas\n\n/* global window, document */\nimport {isBrowser} from '../utils';\n\nconst isPage = isBrowser && typeof document !== 'undefined';\nlet isPageLoaded = isPage && document.readyState === 'complete';\n\nlet pageLoadPromise;\n\n/**\n * Returns a promise that resolves when the page is loaded\n * at this point the DOM can be manipulated, and e.g. a new canvas can be inserted\n * @return {Promise} - resolves when the page is loaded\n */\nexport function getPageLoadPromise() {\n  if (!pageLoadPromise) {\n    pageLoadPromise = isPage\n      ? new Promise((resolve, reject) => {\n          if (isPage && document.readyState === 'complete') {\n            isPageLoaded = true;\n            resolve(document);\n            return;\n          }\n          window.onload = () => {\n            isPageLoaded = true;\n            resolve(document);\n          };\n        })\n      : Promise.resolve({});\n  }\n  return pageLoadPromise;\n}\n\n/**\n * Create a canvas\n * @param {Number} width - set to 100%\n * @param {Number} height - set to 100%\n */\nexport function createCanvas({width = 800, height = 600, id = 'gl-canvas', insert = true}) {\n  const canvas = document.createElement('canvas');\n  canvas.id = id;\n  canvas.style.width = Number.isFinite(width) ? `${width}px` : '100%';\n  canvas.style.height = Number.isFinite(height) ? `${height}px` : '100%';\n  // add the canvas to the body element once the page has loaded\n  if (insert) {\n    const body = document.body;\n    body.insertBefore(canvas, body.firstChild);\n    // getPageLoadPromise().then(document => {});\n  }\n  return canvas;\n}\n\nexport function getCanvas({canvas, width, height, onError = () => {}}) {\n  let targetCanvas;\n  if (typeof canvas === 'string') {\n    if (!isPageLoaded) {\n      onError(`createGLContext called on canvas '${canvas}' before page was loaded`);\n    }\n    targetCanvas = document.getElementById(canvas);\n  } else if (canvas) {\n    targetCanvas = canvas;\n  } else {\n    targetCanvas = createCanvas({id: 'lumagl-canvas', width, height, onError});\n  }\n\n  return targetCanvas;\n}\n"],"file":"create-canvas.js"}