{"version":3,"sources":["../../../../src/effects/lighting/lighting-effect.js"],"names":["AmbientLight","DirectionalLight","Effect","DefaultAmbientLightProps","color","intensity","DefaultDirectionalLightProps","direction","LightingEffect","constructor","props","ambientLight","directionalLights","pointLights","key","lightSource","type","push","applyDefaultLights","getParameters","layer","getProjectedPointLights","getProjectedDirectionalLights","lightSources","length","projectedPointLights","i","pointLight","getProjectedLight","projectedDirectionalLights","directionalLight"],"mappings":"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","sourcesContent":["import {AmbientLight} from '@luma.gl/core';\nimport DirectionalLight from './directional-light';\nimport Effect from '../../lib/effect';\n\nconst DefaultAmbientLightProps = {color: [255, 255, 255], intensity: 1.0};\nconst DefaultDirectionalLightProps = [\n  {\n    color: [255, 255, 255],\n    intensity: 1.0,\n    direction: [-1, -3, -1]\n  },\n  {\n    color: [255, 255, 255],\n    intensity: 0.9,\n    direction: [1, 8, -2.5]\n  }\n];\n\n// Class to manage ambient, point and directional light sources in deck\nexport default class LightingEffect extends Effect {\n  constructor(props) {\n    super(props);\n    this.ambientLight = null;\n    this.directionalLights = [];\n    this.pointLights = [];\n\n    for (const key in props) {\n      const lightSource = props[key];\n\n      switch (lightSource.type) {\n        case 'ambient':\n          this.ambientLight = lightSource;\n          break;\n\n        case 'directional':\n          this.directionalLights.push(lightSource);\n          break;\n\n        case 'point':\n          this.pointLights.push(lightSource);\n          break;\n        default:\n      }\n    }\n    this.applyDefaultLights();\n  }\n\n  getParameters(layer) {\n    const {ambientLight} = this;\n    const pointLights = this.getProjectedPointLights(layer);\n    const directionalLights = this.getProjectedDirectionalLights(layer);\n    return {\n      lightSources: {ambientLight, directionalLights, pointLights}\n    };\n  }\n\n  // Private\n  applyDefaultLights() {\n    const {ambientLight, pointLights, directionalLights} = this;\n    if (!ambientLight && pointLights.length === 0 && directionalLights.length === 0) {\n      this.ambientLight = new AmbientLight(DefaultAmbientLightProps);\n      this.directionalLights.push(new DirectionalLight(DefaultDirectionalLightProps[0]));\n      this.directionalLights.push(new DirectionalLight(DefaultDirectionalLightProps[1]));\n    }\n  }\n\n  getProjectedPointLights(layer) {\n    const projectedPointLights = [];\n\n    for (let i = 0; i < this.pointLights.length; i++) {\n      const pointLight = this.pointLights[i];\n      projectedPointLights.push(pointLight.getProjectedLight({layer}));\n    }\n    return projectedPointLights;\n  }\n\n  getProjectedDirectionalLights(layer) {\n    const projectedDirectionalLights = [];\n\n    for (let i = 0; i < this.directionalLights.length; i++) {\n      const directionalLight = this.directionalLights[i];\n      projectedDirectionalLights.push(directionalLight.getProjectedLight({layer}));\n    }\n    return projectedDirectionalLights;\n  }\n}\n"],"file":"lighting-effect.js"}