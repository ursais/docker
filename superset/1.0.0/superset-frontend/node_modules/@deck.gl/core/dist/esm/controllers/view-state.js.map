{"version":3,"sources":["../../../src/controllers/view-state.js"],"names":["Vector3","_SphericalCoordinates","SphericalCoordinates","assert","defaultState","position","lookAt","up","rotationX","rotationY","fov","near","far","ViewState","opts","width","height","Number","isFinite","_viewportProps","_applyConstraints","Object","assign","spherical","bearing","pitch","direction","toVector3","normalize","viewState","props"],"mappings":";;AAAA,SAAQA,OAAR,EAAiBC,qBAAqB,IAAIC,oBAA1C,QAAqE,SAArE;AACA,OAAOC,MAAP,MAAmB,iBAAnB;AAEA,IAAMC,YAAY,GAAG;AACnBC,EAAAA,QAAQ,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CADS;AAEnBC,EAAAA,MAAM,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAFW;AAGnBC,EAAAA,EAAE,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAHe;AAKnBC,EAAAA,SAAS,EAAE,CALQ;AAMnBC,EAAAA,SAAS,EAAE,CANQ;AAQnBC,EAAAA,GAAG,EAAE,EARc;AASnBC,EAAAA,IAAI,EAAE,CATa;AAUnBC,EAAAA,GAAG,EAAE;AAVc,CAArB;;IAeqBC,S;AACnB,qBAAYC,IAAZ,EAAkB;AAAA;;AAAA,QAEdC,KAFc,GAOZD,IAPY,CAEdC,KAFc;AAAA,QAGdC,MAHc,GAOZF,IAPY,CAGdE,MAHc;AAAA,yBAOZF,IAPY,CAMdT,QANc;AAAA,QAMdA,QANc,+BAMHD,YAAY,CAACC,QANV;AAShBF,IAAAA,MAAM,CAACc,MAAM,CAACC,QAAP,CAAgBH,KAAhB,CAAD,EAAyB,0BAAzB,CAAN;AACAZ,IAAAA,MAAM,CAACc,MAAM,CAACC,QAAP,CAAgBF,MAAhB,CAAD,EAA0B,2BAA1B,CAAN;AAEA,SAAKG,cAAL,GAAsB,KAAKC,iBAAL,CACpBC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBR,IAAlB,EAAwB;AACtBT,MAAAA,QAAQ,EAAE,IAAIL,OAAJ,CAAYK,QAAZ;AADY,KAAxB,CADoB,CAAtB;AAKD;;;;uCAEkB;AACjB,aAAO,KAAKc,cAAZ;AACD;;;mCAEc;AACb,UAAMI,SAAS,GAAG,IAAIrB,oBAAJ,CAAyB;AACzCsB,QAAAA,OAAO,EAAE,KAAKL,cAAL,CAAoBK,OADY;AAEzCC,QAAAA,KAAK,EAAE,KAAKN,cAAL,CAAoBM;AAFc,OAAzB,CAAlB;AAIA,UAAMC,SAAS,GAAGH,SAAS,CAACI,SAAV,GAAsBC,SAAtB,EAAlB;AACA,aAAOF,SAAP;AACD;;;4CAEuBF,O,EAAS;AAC/B,UAAMD,SAAS,GAAG,IAAIrB,oBAAJ,CAAyB;AACzCsB,QAAAA,OAAO,EAAPA,OADyC;AAEzCC,QAAAA,KAAK,EAAE;AAFkC,OAAzB,CAAlB;AAIA,UAAMC,SAAS,GAAGH,SAAS,CAACI,SAAV,GAAsBC,SAAtB,EAAlB;AACA,aAAOF,SAAP;AACD;;;qCAEgBG,S,EAAW;AAC1B,aAAO,KAAKV,cAAZ;AACD;;;sCAIiBW,K,EAAO;AACvB,aAAOA,KAAP;AACD;;;;;;SAlDkBjB,S","sourcesContent":["import {Vector3, _SphericalCoordinates as SphericalCoordinates} from 'math.gl';\nimport assert from '../utils/assert';\n\nconst defaultState = {\n  position: [0, 0, 0],\n  lookAt: [0, 0, 0],\n  up: [0, 0, 1],\n\n  rotationX: 0,\n  rotationY: 0,\n\n  fov: 50,\n  near: 1,\n  far: 100\n};\n\n/* Helpers */\n\nexport default class ViewState {\n  constructor(opts) {\n    const {\n      width, // Width of viewport\n      height, // Height of viewport\n\n      // Position and orientation\n      position = defaultState.position // typically in meters from anchor point\n    } = opts;\n\n    assert(Number.isFinite(width), '`width` must be supplied');\n    assert(Number.isFinite(height), '`height` must be supplied');\n\n    this._viewportProps = this._applyConstraints(\n      Object.assign({}, opts, {\n        position: new Vector3(position)\n      })\n    );\n  }\n\n  getViewportProps() {\n    return this._viewportProps;\n  }\n\n  getDirection() {\n    const spherical = new SphericalCoordinates({\n      bearing: this._viewportProps.bearing,\n      pitch: this._viewportProps.pitch\n    });\n    const direction = spherical.toVector3().normalize();\n    return direction;\n  }\n\n  getDirectionFromBearing(bearing) {\n    const spherical = new SphericalCoordinates({\n      bearing,\n      pitch: 90\n    });\n    const direction = spherical.toVector3().normalize();\n    return direction;\n  }\n\n  shortestPathFrom(viewState) {\n    return this._viewportProps;\n  }\n\n  // Redefined by subclass\n  // Apply any constraints (mathematical or defined by _viewportProps) to map state\n  _applyConstraints(props) {\n    return props;\n  }\n}\n"],"file":"view-state.js"}