{"version":3,"sources":["../../../src/views/perspective-view.js"],"names":["View","Viewport","mat4","DEGREES_TO_RADIANS","Math","PI","PerspectiveView","props","x","y","width","height","viewState","eye","lookAt","up","fovy","near","far","aspect","Number","isFinite","fovyRadians","id","viewMatrix","projectionMatrix","perspective","displayName"],"mappings":";;;;;AAAA,OAAOA,IAAP,MAAiB,QAAjB;AACA,OAAOC,QAAP,MAAqB,uBAArB;AAEA,OAAO,KAAKC,IAAZ,MAAsB,gBAAtB;AAEA,IAAMC,kBAAkB,GAAGC,IAAI,CAACC,EAAL,GAAU,GAArC;;IAEqBC,e;;;;;;;;;;;iCACNC,K,EAAO;AAAA,UAGhBC,CAHgB,GASdD,KATc,CAGhBC,CAHgB;AAAA,UAIhBC,CAJgB,GASdF,KATc,CAIhBE,CAJgB;AAAA,UAKhBC,KALgB,GASdH,KATc,CAKhBG,KALgB;AAAA,UAMhBC,MANgB,GASdJ,KATc,CAMhBI,MANgB;AAAA,UAQhBC,SARgB,GASdL,KATc,CAQhBK,SARgB;AAAA,UAahBC,GAbgB,GAgBdD,SAhBc,CAahBC,GAbgB;AAAA,8BAgBdD,SAhBc,CAchBE,MAdgB;AAAA,UAchBA,MAdgB,kCAcP,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAdO;AAAA,0BAgBdF,SAhBc,CAehBG,EAfgB;AAAA,UAehBA,EAfgB,8BAeX,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAfW;AAoBlB,UAAMC,IAAI,GAAGT,KAAK,CAACS,IAAN,IAAcJ,SAAS,CAACI,IAAxB,IAAgC,EAA7C;AACA,UAAMC,IAAI,GAAGV,KAAK,CAACU,IAAN,IAAcL,SAAS,CAACK,IAAxB,IAAgC,CAA7C;AACA,UAAMC,GAAG,GAAGX,KAAK,CAACW,GAAN,IAAaN,SAAS,CAACM,GAAvB,IAA8B,GAA1C;AACA,UAAMC,MAAM,GAAGC,MAAM,CAACC,QAAP,CAAgBT,SAAS,CAACO,MAA1B,IAAoCP,SAAS,CAACO,MAA9C,GAAuDT,KAAK,GAAGC,MAA9E;AAEA,UAAMW,WAAW,GAAGN,IAAI,GAAGb,kBAA3B;AACA,aAAO,IAAIF,QAAJ,CAAa;AAClBsB,QAAAA,EAAE,EAAE,KAAKA,EADS;AAElBf,QAAAA,CAAC,EAADA,CAFkB;AAGlBC,QAAAA,CAAC,EAADA,CAHkB;AAIlBC,QAAAA,KAAK,EAALA,KAJkB;AAKlBC,QAAAA,MAAM,EAANA,MALkB;AAMlBa,QAAAA,UAAU,EAAEtB,IAAI,CAACY,MAAL,CAAY,EAAZ,EAAgBD,GAAhB,EAAqBC,MAArB,EAA6BC,EAA7B,CANM;AAOlBU,QAAAA,gBAAgB,EAAEvB,IAAI,CAACwB,WAAL,CAAiB,EAAjB,EAAqBJ,WAArB,EAAkCH,MAAlC,EAA0CF,IAA1C,EAAgDC,GAAhD;AAPA,OAAb,CAAP;AASD;;;;EApC0ClB,I;;SAAxBM,e;AAuCrBA,eAAe,CAACqB,WAAhB,GAA8B,iBAA9B","sourcesContent":["import View from './view';\nimport Viewport from '../viewports/viewport';\n\nimport * as mat4 from 'gl-matrix/mat4';\n\nconst DEGREES_TO_RADIANS = Math.PI / 180;\n\nexport default class PerspectiveView extends View {\n  _getViewport(props) {\n    const {\n      // viewport arguments\n      x,\n      y,\n      width, // Width of viewport\n      height, // Height of viewport\n\n      viewState\n    } = props;\n\n    const {\n      // view matrix arguments\n      eye, // Defines eye position\n      lookAt = [0, 0, 0], // Which point is camera looking at, default origin\n      up = [0, 1, 0] // Defines up direction, default positive y axis\n    } = viewState;\n\n    // Projection matrix arguments\n    // TODO - Extracting from viewState is deprecated\n    const fovy = props.fovy || viewState.fovy || 75; // Field of view covered by camera\n    const near = props.near || viewState.near || 1; // Distance of near clipping plane\n    const far = props.far || viewState.far || 100; // Distance of far clipping plane\n    const aspect = Number.isFinite(viewState.aspect) ? viewState.aspect : width / height;\n\n    const fovyRadians = fovy * DEGREES_TO_RADIANS;\n    return new Viewport({\n      id: this.id,\n      x,\n      y,\n      width,\n      height,\n      viewMatrix: mat4.lookAt([], eye, lookAt, up),\n      projectionMatrix: mat4.perspective([], fovyRadians, aspect, near, far)\n    });\n  }\n}\n\nPerspectiveView.displayName = 'PerspectiveView';\n"],"file":"perspective-view.js"}