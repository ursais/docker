{"version":3,"sources":["../../../../src/effects/lighting/lighting-effect.js"],"names":["DefaultAmbientLightProps","color","intensity","DefaultDirectionalLightProps","direction","LightingEffect","props","ambientLight","directionalLights","pointLights","key","lightSource","type","push","applyDefaultLights","layer","getProjectedPointLights","getProjectedDirectionalLights","lightSources","length","AmbientLight","DirectionalLight","projectedPointLights","i","pointLight","getProjectedLight","projectedDirectionalLights","directionalLight","Effect"],"mappings":"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","sourcesContent":["import {AmbientLight} from '@luma.gl/core';\nimport DirectionalLight from './directional-light';\nimport Effect from '../../lib/effect';\n\nconst DefaultAmbientLightProps = {color: [255, 255, 255], intensity: 1.0};\nconst DefaultDirectionalLightProps = [\n  {\n    color: [255, 255, 255],\n    intensity: 1.0,\n    direction: [-1, -3, -1]\n  },\n  {\n    color: [255, 255, 255],\n    intensity: 0.9,\n    direction: [1, 8, -2.5]\n  }\n];\n\n// Class to manage ambient, point and directional light sources in deck\nexport default class LightingEffect extends Effect {\n  constructor(props) {\n    super(props);\n    this.ambientLight = null;\n    this.directionalLights = [];\n    this.pointLights = [];\n\n    for (const key in props) {\n      const lightSource = props[key];\n\n      switch (lightSource.type) {\n        case 'ambient':\n          this.ambientLight = lightSource;\n          break;\n\n        case 'directional':\n          this.directionalLights.push(lightSource);\n          break;\n\n        case 'point':\n          this.pointLights.push(lightSource);\n          break;\n        default:\n      }\n    }\n    this.applyDefaultLights();\n  }\n\n  getParameters(layer) {\n    const {ambientLight} = this;\n    const pointLights = this.getProjectedPointLights(layer);\n    const directionalLights = this.getProjectedDirectionalLights(layer);\n    return {\n      lightSources: {ambientLight, directionalLights, pointLights}\n    };\n  }\n\n  // Private\n  applyDefaultLights() {\n    const {ambientLight, pointLights, directionalLights} = this;\n    if (!ambientLight && pointLights.length === 0 && directionalLights.length === 0) {\n      this.ambientLight = new AmbientLight(DefaultAmbientLightProps);\n      this.directionalLights.push(new DirectionalLight(DefaultDirectionalLightProps[0]));\n      this.directionalLights.push(new DirectionalLight(DefaultDirectionalLightProps[1]));\n    }\n  }\n\n  getProjectedPointLights(layer) {\n    const projectedPointLights = [];\n\n    for (let i = 0; i < this.pointLights.length; i++) {\n      const pointLight = this.pointLights[i];\n      projectedPointLights.push(pointLight.getProjectedLight({layer}));\n    }\n    return projectedPointLights;\n  }\n\n  getProjectedDirectionalLights(layer) {\n    const projectedDirectionalLights = [];\n\n    for (let i = 0; i < this.directionalLights.length; i++) {\n      const directionalLight = this.directionalLights[i];\n      projectedDirectionalLights.push(directionalLight.getProjectedLight({layer}));\n    }\n    return projectedDirectionalLights;\n  }\n}\n"],"file":"lighting-effect.js"}