{"version":3,"sources":["../../../src/lib/common.js"],"names":["config","EPSILON","debug","precision","printTypes","printDegrees","printRowMajor","configure","options","epsilon","checkNumber","value","Number","isFinite","Error","round","Math","formatValue","parseFloat","toPrecision","formatAngle","printAngles","degrees","isArray","Array","ArrayBuffer","isView","length","undefined","clone","array","map","func","result","i","radians","PI","sin","angle","cos","tan","asin","acos","atan","clamp","min","max","lerp","a","b","t","ai","equals","abs"],"mappings":"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","sourcesContent":["// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/* eslint-disable no-shadow */\n// TODO - remove\nconst config = {};\nconfig.EPSILON = 1e-12;\nconfig.debug = true;\nconfig.precision = 4;\nconfig.printTypes = false;\nconfig.printDegrees = false;\nconfig.printRowMajor = true;\n\nexport {config};\n\nexport function configure(options) {\n  if ('epsilon' in options) {\n    config.EPSILON = options.epsilon;\n  }\n\n  if ('debug' in options) {\n    config.debug = options.debug;\n  }\n}\n\nexport function checkNumber(value) {\n  if (!Number.isFinite(value)) {\n    throw new Error(`Invalid number ${value}`);\n  }\n  return value;\n}\n\nfunction round(value) {\n  return Math.round(value / config.EPSILON) * config.EPSILON;\n}\n\nexport function formatValue(value, {precision = config.precision || 4} = {}) {\n  value = round(value);\n  return parseFloat(value.toPrecision(precision));\n}\n\nexport function formatAngle(\n  value,\n  {precision = config.precision || 4, printDegrees = config.printAngles} = {}\n) {\n  value = printDegrees ? degrees(value) : value;\n  value = round(value);\n  return `${parseFloat(value.toPrecision(precision))}${printDegrees ? 'Â°' : ''}`;\n}\n\n// Returns true if value is either an array or a typed array\n// Note: does not return true for ArrayBuffers and DataViews\nexport function isArray(value) {\n  return Array.isArray(value) || (ArrayBuffer.isView(value) && value.length !== undefined);\n}\n\n// If the array has a clone function, calls it, otherwise returns a copy\nexport function clone(array) {\n  return array.clone ? array.clone() : new Array(array);\n}\n\n// If the argument value is an array, applies the func element wise,\n// otherwise applies func to the argument value\nfunction map(value, func) {\n  if (isArray(value)) {\n    const result = clone(value);\n    for (let i = 0; i < result.length; ++i) {\n      result[i] = func(result[i], i, result);\n    }\n    return result;\n  }\n  return func(value);\n}\n\n//\n// GLSL math function equivalents\n// Works on both single values and vectors\n//\n\nexport function radians(degrees) {\n  return map(degrees, degrees => (degrees / 180) * Math.PI);\n}\n\n// GLSL equivalent: Works on single values and vectors\nexport function degrees(radians) {\n  return map(radians, radians => (radians * 180) / Math.PI);\n}\n\n// GLSL equivalent: Works on single values and vectors\nexport function sin(radians) {\n  return map(radians, angle => Math.sin(angle));\n}\n\n// GLSL equivalent: Works on single values and vectors\nexport function cos(radians) {\n  return map(radians, angle => Math.cos(angle));\n}\n\n// GLSL equivalent: Works on single values and vectors\nexport function tan(radians) {\n  return map(radians, angle => Math.tan(angle));\n}\n\n// GLSL equivalent: Works on single values and vectors\nexport function asin(radians) {\n  return map(radians, angle => Math.asin(angle));\n}\n\n// GLSL equivalent: Works on single values and vectors\nexport function acos(radians) {\n  return map(radians, angle => Math.acos(angle));\n}\n\n// GLSL equivalent: Works on single values and vectors\nexport function atan(radians) {\n  return map(radians, angle => Math.atan(angle));\n}\n\nexport function clamp(value, min, max) {\n  return map(value, value => Math.max(min, Math.min(max, value)));\n}\n\n// Interpolate between two numbers or two arrays\nexport function lerp(a, b, t) {\n  if (isArray(a)) {\n    return a.map((ai, i) => lerp(ai, b[i], t));\n  }\n  return t * b + (1 - t) * a;\n}\n\nexport function equals(a, b) {\n  if (isArray(a) && isArray(b)) {\n    if (a === b) {\n      return true;\n    }\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; ++i) {\n      if (!equals(a[i], b[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return Math.abs(a - b) <= config.EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\n"],"file":"common.js"}