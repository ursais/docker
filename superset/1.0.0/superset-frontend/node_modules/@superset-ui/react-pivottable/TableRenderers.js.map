{"version":3,"sources":["src/TableRenderers.jsx"],"names":["redColorScaleGenerator","values","min","Math","apply","max","x","nonRed","round","backgroundColor","defaultBarchartScaleGenerator","range","maxScale","scaler","val","text","bgColor","bBase","position","height","bottom","left","right","abs","padding","displayHeaderCell","needToggle","arrowIcon","onArrowClick","value","namesMapping","name","makeRenderer","opts","TableRenderer","props","state","collapsedRows","collapsedCols","clickHeaderHandler","bind","clickHandler","colAttrs","cols","rowAttrs","rows","tableOptions","Object","assign","rowTotals","colTotals","length","subtotalOptions","arrowCollapsed","arrowExpanded","colSubtotalDisplay","displayOnTop","enabled","hideOnExpand","rowSubtotalDisplay","pivotData","PivotData","subtotals","rowEnabled","colEnabled","rowPartialOnTop","colPartialOnTop","rowKeys","getRowKeys","colKeys","getColKeys","cellCallbacks","rowTotalCallbacks","colTotalCallbacks","grandTotalCallback","clickCallback","rowKey","flatRowKey","colKey","heatmapMappers","tableColorScaleGenerator","barchartMapper","barScaleGenerator","rowValues","colValues","getAggregator","filters","colLimit","i","attr","rowLimit","e","attrs","attrIdx","callback","isSubtotal","isGrandTotal","rowOrCol","allKeys","stopPropagation","keyLen","collapsed","filter","k","map","flatKey","updates","forEach","setState","slice","flatColKey","attrArr","numAttrs","spans","li","Array","lv","cv","ent","depth","limit","push","attrName","pivotSettings","visibleColKeys","colAttrSpans","maxColVisible","highlightHeaderCellsOnHover","omittedHighlightHeaderGroups","highlightedHeaderCells","spaceCell","arrowClickHandle","subArrow","collapseAttr","expandAttr","attrNameCell","attrValueCells","rowIncrSpan","colSpan","colLabelClass","includes","isArray","rowSpan","toggleColKey","clickColumnHeaderCallback","totalCell","cells","maxRowVisible","r","needLabelToggle","clickRowHeaderCallback","rowIdx","rowAttrSpans","valueCellColors","cellStyle","valueCellBar","colIncrSpan","valueCellClassName","needRowToggle","toggleRowKey","attrValuePaddingCell","rowClickHandlers","valueCells","agg","aggValue","style","fontWeight","format","rowCells","totalLabelCell","totalValueStyle","totalValueCells","grandTotalCell","totalCells","keys","subtotalDisplay","key","some","j","cachedProps","cachedBasePivotSettings","getBasePivotSettings","visibleRowKeys","visibleKeys","calcAttrSpans","c","renderColHeaderRow","renderRowHeaderRow","renderTableRow","renderTotalsRow","colorScaleGenerator","rowTotalColors","colTotalColors","heatmapMode","colTotalValues","a","rowTotalValues","allValues","tree","cd","colorScale","v","rowColorScales","entries","rk","colColorScales","ck","t","rowTotalBar","colTotalBar","barchartMode","textAlign","paddingTop","barScales","rowBarScales","colBarScales","React","Component","defaultProps","propTypes","PropTypes","func","object","TSVExportRenderer","headerRow","aggregatorName","join","result","row","unshift","width","window","innerWidth","innerHeight","PureComponent","Table"],"mappings":"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","file":"TableRenderers.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport {PivotData, flatKey} from './Utilities';\n\n/* eslint-disable react/prop-types */\n// eslint can't see inherited propTypes!\n\nfunction redColorScaleGenerator(values) {\n  const min = Math.min.apply(Math, values);\n  const max = Math.max.apply(Math, values);\n  return (x) => {\n    // eslint-disable-next-line no-magic-numbers\n    const nonRed = 255 - Math.round((255 * (x - min)) / (max - min));\n    return {backgroundColor: `rgb(255,${nonRed},${nonRed})`};\n  };\n}\n\nfunction defaultBarchartScaleGenerator(values) {\n  const min = Math.min.apply(Math, values);\n  const max = Math.max.apply(Math, values);\n  const range = min < 0 ? max - min : Math.max(max, 0);\n  // eslint-disable-next-line no-magic-numbers\n  const maxScale = 100 / 1.4;\n  const scaler = (val) => Math.min(maxScale, maxScale * (val / range));\n\n  return (val, text) => {\n    let bgColor = 'gray';\n    let bBase = 0;\n    if (min < 0) {\n      bBase = scaler(-min);\n    }\n    if (val < 0) {\n      bBase += scaler(val);\n      bgColor = 'darkred';\n    }\n\n    return (\n      <div style={{position: 'relative', height: '100%'}}>\n        <div\n          style={{\n            position: 'absolute',\n            bottom: bBase + '%',\n            left: 0,\n            right: 0,\n            height: scaler(Math.abs(val)) + '%',\n            backgroundColor: bgColor,\n          }}\n        />\n        <div style={{position: 'relative', padding: '0 5px'}}>{text}</div>\n      </div>\n    );\n  };\n}\n\nfunction displayHeaderCell(\n  needToggle,\n  arrowIcon,\n  onArrowClick,\n  value,\n  namesMapping\n) {\n  const name = namesMapping[value] || value;\n  return needToggle ? (\n    <span className=\"toggle-wrapper\">\n      <span className=\"toggle\" onClick={onArrowClick}>\n        {arrowIcon}\n      </span>\n      <span className=\"toggle-val\">{name}</span>\n    </span>\n  ) : (\n    name\n  );\n}\n\nfunction makeRenderer(opts = {}) {\n  class TableRenderer extends React.Component {\n    constructor(props) {\n      super(props);\n\n      // We need state to record which entries are collapsed and which aren't.\n      // This is an object with flat-keys indicating if the corresponding rows\n      // should be collapsed.\n      this.state = {collapsedRows: {}, collapsedCols: {}};\n\n      this.clickHeaderHandler = this.clickHeaderHandler.bind(this);\n      this.clickHandler = this.clickHandler.bind(this);\n    }\n\n    getBasePivotSettings() {\n      // One-time extraction of pivot settings that we'll use throughout the render.\n\n      const props = this.props;\n      const colAttrs = props.cols;\n      const rowAttrs = props.rows;\n\n      const tableOptions = Object.assign(\n        {\n          rowTotals: true,\n          colTotals: true,\n        },\n        props.tableOptions\n      );\n      const rowTotals = tableOptions.rowTotals || colAttrs.length === 0;\n      const colTotals = tableOptions.colTotals || rowAttrs.length === 0;\n\n      const namesMapping = props.namesMapping || {};\n      const subtotalOptions = Object.assign(\n        {\n          arrowCollapsed: '\\u25B2',\n          arrowExpanded: '\\u25BC',\n        },\n        props.subtotalOptions\n      );\n\n      const colSubtotalDisplay = Object.assign(\n        {\n          displayOnTop: false,\n          enabled: rowTotals,\n          hideOnExpand: false,\n        },\n        subtotalOptions.colSubtotalDisplay\n      );\n\n      const rowSubtotalDisplay = Object.assign(\n        {\n          displayOnTop: false,\n          enabled: colTotals,\n          hideOnExpand: false,\n        },\n        subtotalOptions.rowSubtotalDisplay\n      );\n\n      const pivotData = new PivotData(\n        props,\n        !opts.subtotals\n          ? {}\n          : {\n              rowEnabled: rowSubtotalDisplay.enabled,\n              colEnabled: colSubtotalDisplay.enabled,\n              rowPartialOnTop: rowSubtotalDisplay.displayOnTop,\n              colPartialOnTop: colSubtotalDisplay.displayOnTop,\n            }\n      );\n      const rowKeys = pivotData.getRowKeys();\n      const colKeys = pivotData.getColKeys();\n\n      // Also pre-calculate all the callbacks for cells, etc... This is nice to have to\n      // avoid re-calculations of the call-backs on cell expansions, etc...\n      const cellCallbacks = {};\n      const rowTotalCallbacks = {};\n      const colTotalCallbacks = {};\n      let grandTotalCallback = null;\n      if (tableOptions.clickCallback) {\n        for (const rowKey of rowKeys) {\n          const flatRowKey = flatKey(rowKey);\n          if (!(flatRowKey in cellCallbacks)) {\n            cellCallbacks[flatRowKey] = {};\n          }\n          for (const colKey of colKeys) {\n            cellCallbacks[flatRowKey][flatKey(colKey)] = this.clickHandler(\n              pivotData,\n              rowKey,\n              colKey\n            );\n          }\n        }\n\n        // Add in totals as well.\n        if (rowTotals) {\n          for (const rowKey of rowKeys) {\n            rowTotalCallbacks[flatKey(rowKey)] = this.clickHandler(\n              pivotData,\n              rowKey,\n              []\n            );\n          }\n        }\n        if (colTotals) {\n          for (const colKey of colKeys) {\n            colTotalCallbacks[flatKey(colKey)] = this.clickHandler(\n              pivotData,\n              [],\n              colKey\n            );\n          }\n        }\n        if (rowTotals && colTotals) {\n          grandTotalCallback = this.clickHandler(pivotData, [], []);\n        }\n      }\n\n      return Object.assign(\n        {\n          pivotData,\n          colAttrs,\n          rowAttrs,\n          colKeys,\n          rowKeys,\n          rowTotals,\n          colTotals,\n          arrowCollapsed: subtotalOptions.arrowCollapsed,\n          arrowExpanded: subtotalOptions.arrowExpanded,\n          colSubtotalDisplay,\n          rowSubtotalDisplay,\n          cellCallbacks,\n          rowTotalCallbacks,\n          colTotalCallbacks,\n          grandTotalCallback,\n          namesMapping,\n        },\n        TableRenderer.heatmapMappers(\n          pivotData,\n          props.tableColorScaleGenerator,\n          colTotals,\n          rowTotals\n        ),\n        TableRenderer.barchartMapper(\n          pivotData,\n          props.barScaleGenerator,\n          colTotals,\n          rowTotals\n        )\n      );\n    }\n\n    clickHandler(pivotData, rowValues, colValues) {\n      const colAttrs = this.props.cols;\n      const rowAttrs = this.props.rows;\n      const value = pivotData.getAggregator(rowValues, colValues).value();\n      const filters = {};\n      const colLimit = Math.min(colAttrs.length, colValues.length);\n      for (let i = 0; i < colLimit; i++) {\n        const attr = colAttrs[i];\n        if (colValues[i] !== null) {\n          filters[attr] = colValues[i];\n        }\n      }\n      const rowLimit = Math.min(rowAttrs.length, rowValues.length);\n      for (let i = 0; i < rowLimit; i++) {\n        const attr = rowAttrs[i];\n        if (rowValues[i] !== null) {\n          filters[attr] = rowValues[i];\n        }\n      }\n      return (e) =>\n        this.props.tableOptions.clickCallback(e, value, filters, pivotData);\n    }\n\n    clickHeaderHandler(\n      pivotData,\n      values,\n      attrs,\n      attrIdx,\n      callback,\n      isSubtotal = false,\n      isGrandTotal = false\n    ) {\n      const filters = {};\n      for (let i = 0; i <= attrIdx; i++) {\n        const attr = attrs[i];\n        filters[attr] = values[i];\n      }\n      return (e) =>\n        callback(\n          e,\n          values[attrIdx],\n          filters,\n          pivotData,\n          isSubtotal,\n          isGrandTotal\n        );\n    }\n\n    collapseAttr(rowOrCol, attrIdx, allKeys) {\n      return (e) => {\n        // Collapse an entire attribute.\n        e.stopPropagation();\n        const keyLen = attrIdx + 1;\n        const collapsed = allKeys\n          .filter((k) => k.length === keyLen)\n          .map(flatKey);\n\n        const updates = {};\n        collapsed.forEach((k) => {\n          updates[k] = true;\n        });\n\n        if (rowOrCol) {\n          this.setState((state) => ({\n            collapsedRows: Object.assign({}, state.collapsedRows, updates),\n          }));\n        } else {\n          this.setState((state) => ({\n            collapsedCols: Object.assign({}, state.collapsedCols, updates),\n          }));\n        }\n      };\n    }\n\n    expandAttr(rowOrCol, attrIdx, allKeys) {\n      return (e) => {\n        // Expand an entire attribute. This implicitly implies expanding all of the\n        // parents as well. It's a bit inefficient but ah well...\n        e.stopPropagation();\n        const updates = {};\n        allKeys.forEach((k) => {\n          for (let i = 0; i <= attrIdx; i++) {\n            updates[flatKey(k.slice(0, i + 1))] = false;\n          }\n        });\n\n        if (rowOrCol) {\n          this.setState((state) => ({\n            collapsedRows: Object.assign({}, state.collapsedRows, updates),\n          }));\n        } else {\n          this.setState((state) => ({\n            collapsedCols: Object.assign({}, state.collapsedCols, updates),\n          }));\n        }\n      };\n    }\n\n    toggleRowKey(flatRowKey) {\n      return (e) => {\n        e.stopPropagation();\n        this.setState((state) => ({\n          collapsedRows: Object.assign({}, state.collapsedRows, {\n            [flatRowKey]: !state.collapsedRows[flatRowKey],\n          }),\n        }));\n      };\n    }\n\n    toggleColKey(flatColKey) {\n      return (e) => {\n        e.stopPropagation();\n        this.setState((state) => ({\n          collapsedCols: Object.assign({}, state.collapsedCols, {\n            [flatColKey]: !state.collapsedCols[flatColKey],\n          }),\n        }));\n      };\n    }\n\n    calcAttrSpans(attrArr, numAttrs) {\n      // Given an array of attribute values (i.e. each element is another array with\n      // the value at every level), compute the spans for every attribute value at\n      // every level. The return value is a nested array of the same shape. It has\n      // -1's for repeated values and the span number otherwise.\n\n      const spans = [];\n      // Index of the last new value\n      const li = Array(numAttrs).map(() => 0);\n      let lv = Array(numAttrs).map(() => null);\n      for (let i = 0; i < attrArr.length; i++) {\n        // Keep increasing span values as long as the last keys are the same. For\n        // the rest, record spans of 1. Update the indices too.\n        const cv = attrArr[i];\n        const ent = [];\n        let depth = 0;\n        const limit = Math.min(lv.length, cv.length);\n        while (depth < limit && lv[depth] === cv[depth]) {\n          ent.push(-1);\n          spans[li[depth]][depth]++;\n          depth++;\n        }\n        while (depth < cv.length) {\n          li[depth] = i;\n          ent.push(1);\n          depth++;\n        }\n        spans.push(ent);\n        lv = cv;\n      }\n      return spans;\n    }\n\n    static heatmapMappers(\n      pivotData,\n      colorScaleGenerator,\n      colTotals,\n      rowTotals\n    ) {\n      let valueCellColors = () => ({});\n      let rowTotalColors = () => ({});\n      let colTotalColors = () => ({});\n      if (opts.heatmapMode) {\n        if (colTotals) {\n          const colTotalValues = Object.values(pivotData.colTotals).map((a) =>\n            a.value()\n          );\n          colTotalColors = colorScaleGenerator(colTotalValues);\n        }\n        if (rowTotals) {\n          const rowTotalValues = Object.values(pivotData.rowTotals).map((a) =>\n            a.value()\n          );\n          rowTotalColors = colorScaleGenerator(rowTotalValues);\n        }\n        if (opts.heatmapMode === 'full') {\n          const allValues = [];\n          Object.values(pivotData.tree).map((cd) =>\n            Object.values(cd).map(\n              (a) => !a.isSubtotal && allValues.push(a.value())\n            )\n          );\n          const colorScale = colorScaleGenerator(allValues);\n          valueCellColors = (r, c, v) => colorScale(v);\n        } else if (opts.heatmapMode === 'row') {\n          const rowColorScales = {};\n          Object.entries(pivotData.tree).map(([rk, cd]) => {\n            const rowValues = Object.values(cd).map(\n              (a) => !a.isSubtotal && a.value()\n            );\n            rowColorScales[rk] = colorScaleGenerator(rowValues);\n          });\n          valueCellColors = (r, c, v) => rowColorScales[flatKey(r)](v);\n        } else if (opts.heatmapMode === 'col') {\n          const colColorScales = {};\n          const colValues = {};\n          Object.values(pivotData.tree).map((cd) =>\n            Object.entries(cd).map(([ck, a]) => {\n              if (!(ck in colValues)) {\n                colValues[ck] = [];\n              }\n              if (!a.isSubtotal) {\n                colValues[ck].push(a.value());\n              }\n            })\n          );\n          for (const k in colValues) {\n            colColorScales[k] = colorScaleGenerator(colValues[k]);\n          }\n          valueCellColors = (r, c, v) => colColorScales[flatKey(c)](v);\n        }\n      }\n      return {valueCellColors, rowTotalColors, colTotalColors};\n    }\n\n    static barchartMapper(pivotData, barScaleGenerator, colTotals, rowTotals) {\n      let cellStyle = {};\n      let valueCellBar = (r, c, v, t) => t;\n      let rowTotalBar = (v, t) => t;\n      let colTotalBar = (v, t) => t;\n\n      if (opts.barchartMode) {\n        cellStyle = {\n          textAlign: 'center',\n          padding: 0,\n          paddingTop: '5px',\n          height: '60px',\n        };\n        if (colTotals) {\n          const colTotalValues = Object.values(pivotData.colTotals)\n            .filter((a) => !a.isSubtotal)\n            .map((a) => a.value());\n          colTotalBar = barScaleGenerator(colTotalValues);\n        }\n        if (rowTotals) {\n          const rowTotalValues = Object.values(pivotData.rowTotals)\n            .filter((a) => !a.isSubtotal)\n            .map((a) => a.value());\n          rowTotalBar = barScaleGenerator(rowTotalValues);\n        }\n        if (opts.barchartMode === 'full') {\n          const allValues = [];\n          Object.values(pivotData.tree).map((cd) =>\n            Object.values(cd).map(\n              (a) => !a.isSubtotal && allValues.push(a.value())\n            )\n          );\n          const barScales = barScaleGenerator(allValues);\n          valueCellBar = (r, c, v, t) => barScales(v, t);\n        } else if (opts.barchartMode === 'row') {\n          const rowBarScales = {};\n          Object.entries(pivotData.tree).map(([rk, cd]) => {\n            const rowValues = Object.values(cd).map(\n              (a) => !a.isSubtotal && a.value()\n            );\n            rowBarScales[rk] = barScaleGenerator(rowValues);\n          });\n          valueCellBar = (r, c, v, t) => rowBarScales[flatKey(r)](v, t);\n        } else if (opts.barchartMode === 'col') {\n          const colBarScales = {};\n          const colValues = {};\n          Object.values(pivotData.tree).map((cd) =>\n            Object.entries(cd).map(([ck, a]) => {\n              if (!(ck in colValues)) {\n                colValues[ck] = [];\n              }\n              if (!a.isSubtotal) {\n                colValues[ck].push(a.value());\n              }\n            })\n          );\n          for (const k in colValues) {\n            colBarScales[k] = barScaleGenerator(colValues[k]);\n          }\n          valueCellBar = (r, c, v, t) => colBarScales[flatKey(c)](v, t);\n        }\n      }\n      return {cellStyle, valueCellBar, rowTotalBar, colTotalBar};\n    }\n\n    renderColHeaderRow(attrName, attrIdx, pivotSettings) {\n      // Render a single row in the column header at the top of the pivot table.\n\n      const {\n        rowAttrs,\n        colAttrs,\n        colKeys,\n        visibleColKeys,\n        colAttrSpans,\n        rowTotals,\n        arrowExpanded,\n        arrowCollapsed,\n        colSubtotalDisplay,\n        maxColVisible,\n        pivotData,\n        namesMapping,\n      } = pivotSettings;\n      const {\n        highlightHeaderCellsOnHover,\n        omittedHighlightHeaderGroups = [],\n        highlightedHeaderCells,\n      } = this.props.tableOptions;\n\n      const spaceCell =\n        attrIdx === 0 && rowAttrs.length !== 0 ? (\n          <th\n            key=\"padding\"\n            colSpan={rowAttrs.length}\n            rowSpan={colAttrs.length}\n          />\n        ) : null;\n\n      const needToggle =\n        opts.subtotals &&\n        colSubtotalDisplay.enabled &&\n        attrIdx !== colAttrs.length - 1;\n      let arrowClickHandle = null;\n      let subArrow = null;\n      if (needToggle) {\n        arrowClickHandle =\n          attrIdx + 1 < maxColVisible\n            ? this.collapseAttr(false, attrIdx, colKeys)\n            : this.expandAttr(false, attrIdx, colKeys);\n        subArrow =\n          (attrIdx + 1 < maxColVisible ? arrowExpanded : arrowCollapsed) + ' ';\n      }\n      const attrNameCell = (\n        <th key=\"label\" className=\"pvtAxisLabel\">\n          {displayHeaderCell(\n            needToggle,\n            subArrow,\n            arrowClickHandle,\n            attrName,\n            namesMapping\n          )}\n        </th>\n      );\n\n      const attrValueCells = [];\n      const rowIncrSpan = rowAttrs.length !== 0 ? 1 : 0;\n      // Iterate through columns. Jump over duplicate values.\n      let i = 0;\n      while (i < visibleColKeys.length) {\n        const colKey = visibleColKeys[i];\n        const colSpan = attrIdx < colKey.length ? colAttrSpans[i][attrIdx] : 1;\n        let colLabelClass = 'pvtColLabel';\n        if (colSpan > 1) {\n          colLabelClass += ' label-centered';\n        }\n        if (attrIdx < colKey.length) {\n          if (\n            highlightHeaderCellsOnHover &&\n            !omittedHighlightHeaderGroups.includes(colAttrs[attrIdx])\n          ) {\n            colLabelClass += ' hoverable';\n          }\n          if (\n            highlightedHeaderCells &&\n            Array.isArray(highlightedHeaderCells[colAttrs[attrIdx]]) &&\n            highlightedHeaderCells[colAttrs[attrIdx]].includes(colKey[attrIdx])\n          ) {\n            colLabelClass += ' active';\n          }\n\n          const rowSpan =\n            1 + (attrIdx === colAttrs.length - 1 ? rowIncrSpan : 0);\n          const flatColKey = flatKey(colKey.slice(0, attrIdx + 1));\n          const onArrowClick = needToggle\n            ? this.toggleColKey(flatColKey)\n            : null;\n          attrValueCells.push(\n            <th\n              className={colLabelClass}\n              key={'colKey-' + flatColKey}\n              colSpan={colSpan}\n              rowSpan={rowSpan}\n              onClick={this.clickHeaderHandler(\n                pivotData,\n                colKey,\n                this.props.cols,\n                attrIdx,\n                this.props.tableOptions.clickColumnHeaderCallback\n              )}\n            >\n              {displayHeaderCell(\n                needToggle,\n                (this.state.collapsedCols[flatColKey]\n                  ? arrowCollapsed\n                  : arrowExpanded) + ' ',\n                onArrowClick,\n                colKey[attrIdx],\n                namesMapping\n              )}\n            </th>\n          );\n        } else if (attrIdx === colKey.length) {\n          const rowSpan = colAttrs.length - colKey.length + rowIncrSpan;\n          attrValueCells.push(\n            <th\n              className={`${colLabelClass} pvtSubtotalLabel`}\n              key={'colKeyBuffer-' + flatKey(colKey)}\n              colSpan={colSpan}\n              rowSpan={rowSpan}\n              onClick={this.clickHeaderHandler(\n                pivotData,\n                colKey,\n                this.props.cols,\n                attrIdx,\n                this.props.tableOptions.clickColumnHeaderCallback,\n                true\n              )}\n            >\n              Subtotal\n            </th>\n          );\n        }\n        // The next colSpan columns will have the same value anyway...\n        i = i + colSpan;\n      }\n\n      const totalCell =\n        attrIdx === 0 && rowTotals ? (\n          <th\n            key=\"total\"\n            className=\"pvtTotalLabel\"\n            rowSpan={colAttrs.length + Math.min(rowAttrs.length, 1)}\n            onClick={this.clickHeaderHandler(\n              pivotData,\n              [],\n              this.props.cols,\n              attrIdx,\n              this.props.tableOptions.clickColumnHeaderCallback,\n              false,\n              true\n            )}\n          >\n            Totals\n          </th>\n        ) : null;\n\n      const cells = [spaceCell, attrNameCell, ...attrValueCells, totalCell];\n      return <tr key={`colAttr-${attrIdx}`}>{cells}</tr>;\n    }\n\n    renderRowHeaderRow(pivotSettings) {\n      // Render just the attribute names of the rows (the actual attribute values\n      // will show up in the individual rows).\n\n      const {\n        rowAttrs,\n        colAttrs,\n        rowKeys,\n        arrowCollapsed,\n        arrowExpanded,\n        rowSubtotalDisplay,\n        maxRowVisible,\n        pivotData,\n        namesMapping,\n      } = pivotSettings;\n      return (\n        <tr key=\"rowHdr\">\n          {rowAttrs.map((r, i) => {\n            const needLabelToggle =\n              opts.subtotals &&\n              rowSubtotalDisplay.enabled &&\n              i !== rowAttrs.length - 1;\n            let arrowClickHandle = null;\n            let subArrow = null;\n            if (needLabelToggle) {\n              arrowClickHandle =\n                i + 1 < maxRowVisible\n                  ? this.collapseAttr(true, i, rowKeys)\n                  : this.expandAttr(true, i, rowKeys);\n              subArrow =\n                (i + 1 < maxRowVisible ? arrowExpanded : arrowCollapsed) + ' ';\n            }\n            return (\n              <th className=\"pvtAxisLabel\" key={`rowAttr-${i}`}>\n                {displayHeaderCell(\n                  needLabelToggle,\n                  subArrow,\n                  arrowClickHandle,\n                  r,\n                  namesMapping\n                )}\n              </th>\n            );\n          })}\n          <th\n            className=\"pvtTotalLabel\"\n            key=\"padding\"\n            onClick={this.clickHeaderHandler(\n              pivotData,\n              [],\n              this.props.rows,\n              0,\n              this.props.tableOptions.clickRowHeaderCallback,\n              false,\n              true\n            )}\n          >\n            {colAttrs.length === 0 ? 'Totals' : null}\n          </th>\n        </tr>\n      );\n    }\n\n    renderTableRow(rowKey, rowIdx, pivotSettings) {\n      // Render a single row in the pivot table.\n\n      const {\n        rowAttrs,\n        colAttrs,\n        rowAttrSpans,\n        visibleColKeys,\n        pivotData,\n        rowTotals,\n        rowSubtotalDisplay,\n        valueCellColors,\n        cellStyle,\n        valueCellBar,\n        arrowExpanded,\n        arrowCollapsed,\n        cellCallbacks,\n        rowTotalCallbacks,\n        namesMapping,\n      } = pivotSettings;\n\n      const {\n        highlightHeaderCellsOnHover,\n        omittedHighlightHeaderGroups = [],\n        highlightedHeaderCells,\n      } = this.props.tableOptions;\n      const flatRowKey = flatKey(rowKey);\n\n      const colIncrSpan = colAttrs.length !== 0 ? 1 : 0;\n      const attrValueCells = rowKey.map((r, i) => {\n        let valueCellClassName = 'pvtRowLabel';\n        if (\n          highlightHeaderCellsOnHover &&\n          !omittedHighlightHeaderGroups.includes(rowAttrs[i])\n        ) {\n          valueCellClassName += ' hoverable';\n        }\n        if (\n          highlightedHeaderCells &&\n          Array.isArray(highlightedHeaderCells[rowAttrs[i]]) &&\n          highlightedHeaderCells[rowAttrs[i]].includes(r)\n        ) {\n          valueCellClassName += ' active';\n        }\n        const rowSpan = rowAttrSpans[rowIdx][i];\n        if (rowSpan > 0) {\n          const flatRowKey = flatKey(rowKey.slice(0, i + 1));\n          const colSpan = 1 + (i === rowAttrs.length - 1 ? colIncrSpan : 0);\n          const needRowToggle =\n            opts.subtotals &&\n            rowSubtotalDisplay.enabled &&\n            i !== rowAttrs.length - 1;\n          const onArrowClick = needRowToggle\n            ? this.toggleRowKey(flatRowKey)\n            : null;\n          return (\n            <th\n              key={`rowKeyLabel-${i}`}\n              className={valueCellClassName}\n              rowSpan={rowSpan}\n              colSpan={colSpan}\n              onClick={this.clickHeaderHandler(\n                pivotData,\n                rowKey,\n                this.props.rows,\n                i,\n                this.props.tableOptions.clickRowHeaderCallback\n              )}\n            >\n              {displayHeaderCell(\n                needRowToggle,\n                (this.state.collapsedRows[flatRowKey]\n                  ? arrowCollapsed\n                  : arrowExpanded) + ' ',\n                onArrowClick,\n                r,\n                namesMapping\n              )}\n            </th>\n          );\n        }\n        return null;\n      });\n\n      const attrValuePaddingCell =\n        rowKey.length < rowAttrs.length ? (\n          <th\n            className=\"pvtRowLabel pvtSubtotalLabel\"\n            key=\"rowKeyBuffer\"\n            colSpan={rowAttrs.length - rowKey.length + colIncrSpan}\n            rowSpan={1}\n            onClick={this.clickHeaderHandler(\n              pivotData,\n              rowKey,\n              this.props.rows,\n              rowKey.length,\n              this.props.tableOptions.clickRowHeaderCallback,\n              true\n            )}\n          >\n            Subtotal\n          </th>\n        ) : null;\n\n      const rowClickHandlers = cellCallbacks[flatRowKey] || {};\n      const valueCells = visibleColKeys.map((colKey) => {\n        const flatColKey = flatKey(colKey);\n        const agg = pivotData.getAggregator(rowKey, colKey);\n        const aggValue = agg.value();\n        const style = Object.assign(\n          {},\n          agg.isSubtotal\n            ? {fontWeight: 'bold'}\n            : valueCellColors(rowKey, colKey, aggValue),\n          cellStyle\n        );\n        return (\n          <td\n            className=\"pvtVal\"\n            key={'pvtVal-' + flatColKey}\n            onClick={rowClickHandlers[flatColKey]}\n            style={style}\n          >\n            {agg.isSubtotal\n              ? agg.format(aggValue)\n              : valueCellBar(rowKey, colKey, aggValue, agg.format(aggValue))}\n          </td>\n        );\n      });\n\n      let totalCell = null;\n      if (rowTotals) {\n        const agg = pivotData.getAggregator(rowKey, []);\n        const aggValue = agg.value();\n        totalCell = (\n          <td\n            key=\"total\"\n            className=\"pvtTotal\"\n            onClick={rowTotalCallbacks[flatRowKey]}\n            style={cellStyle}\n          >\n            {agg.format(aggValue)}\n          </td>\n        );\n      }\n\n      const rowCells = [\n        ...attrValueCells,\n        attrValuePaddingCell,\n        ...valueCells,\n        totalCell,\n      ];\n\n      return <tr key={'keyRow-' + flatRowKey}>{rowCells}</tr>;\n    }\n\n    renderTotalsRow(pivotSettings) {\n      // Render the final totals rows that has the totals for all the columns.\n\n      const {\n        rowAttrs,\n        colAttrs,\n        visibleColKeys,\n        rowTotals,\n        pivotData,\n        cellStyle,\n        colTotalCallbacks,\n        grandTotalCallback,\n      } = pivotSettings;\n\n      const totalLabelCell = (\n        <th\n          key=\"label\"\n          className=\"pvtTotalLabel pvtRowTotalLabel\"\n          colSpan={rowAttrs.length + Math.min(colAttrs.length, 1)}\n          onClick={this.clickHeaderHandler(\n            pivotData,\n            [],\n            this.props.rows,\n            0,\n            this.props.tableOptions.clickRowHeaderCallback,\n            false,\n            true\n          )}\n        >\n          Totals\n        </th>\n      );\n\n      const totalValueStyle = Object.assign({}, cellStyle, {\n        padding: '5px',\n      });\n      const totalValueCells = visibleColKeys.map((colKey) => {\n        const flatColKey = flatKey(colKey);\n        const agg = pivotData.getAggregator([], colKey);\n        const aggValue = agg.value();\n\n        return (\n          <td\n            className=\"pvtTotal pvtRowTotal\"\n            key={'total-' + flatColKey}\n            onClick={colTotalCallbacks[flatColKey]}\n            style={totalValueStyle}\n          >\n            {agg.format(aggValue)}\n          </td>\n        );\n      });\n\n      let grandTotalCell = null;\n      if (rowTotals) {\n        const agg = pivotData.getAggregator([], []);\n        const aggValue = agg.value();\n        grandTotalCell = (\n          <td\n            key=\"total\"\n            className=\"pvtGrandTotal pvtRowTotal\"\n            onClick={grandTotalCallback}\n          >\n            {agg.format(aggValue)}\n          </td>\n        );\n      }\n\n      const totalCells = [totalLabelCell, ...totalValueCells, grandTotalCell];\n\n      return <tr key=\"total\">{totalCells}</tr>;\n    }\n\n    visibleKeys(keys, collapsed, numAttrs, subtotalDisplay) {\n      return keys.filter(\n        (key) =>\n          // Is the key hidden by one of its parents?\n          !key.some((k, j) => collapsed[flatKey(key.slice(0, j))]) &&\n          // Leaf key.\n          (key.length === numAttrs ||\n            // Children hidden. Must show total.\n            flatKey(key) in collapsed ||\n            // Don't hide totals.\n            !subtotalDisplay.hideOnExpand)\n      );\n    }\n\n    render() {\n      if (this.cachedProps !== this.props) {\n        this.cachedProps = this.props;\n        this.cachedBasePivotSettings = this.getBasePivotSettings();\n      }\n      const {\n        colAttrs,\n        rowAttrs,\n        rowKeys,\n        colKeys,\n        colTotals,\n        rowSubtotalDisplay,\n        colSubtotalDisplay,\n      } = this.cachedBasePivotSettings;\n\n      // Need to account for exclusions to compute the effective row\n      // and column keys.\n      const visibleRowKeys = opts.subtotals\n        ? this.visibleKeys(\n            rowKeys,\n            this.state.collapsedRows,\n            rowAttrs.length,\n            rowSubtotalDisplay\n          )\n        : rowKeys;\n      const visibleColKeys = opts.subtotals\n        ? this.visibleKeys(\n            colKeys,\n            this.state.collapsedCols,\n            colAttrs.length,\n            colSubtotalDisplay\n          )\n        : colKeys;\n\n      const pivotSettings = Object.assign(\n        {\n          visibleRowKeys,\n          maxRowVisible: Math.max(...visibleRowKeys.map((k) => k.length)),\n          visibleColKeys,\n          maxColVisible: Math.max(...visibleColKeys.map((k) => k.length)),\n          rowAttrSpans: this.calcAttrSpans(visibleRowKeys, rowAttrs.length),\n          colAttrSpans: this.calcAttrSpans(visibleColKeys, colAttrs.length),\n        },\n        this.cachedBasePivotSettings\n      );\n\n      return (\n        <table className=\"pvtTable\">\n          <thead>\n            {colAttrs.map((c, j) =>\n              this.renderColHeaderRow(c, j, pivotSettings)\n            )}\n            {rowAttrs.length !== 0 && this.renderRowHeaderRow(pivotSettings)}\n          </thead>\n          <tbody>\n            {visibleRowKeys.map((r, i) =>\n              this.renderTableRow(r, i, pivotSettings)\n            )}\n            {colTotals && this.renderTotalsRow(pivotSettings)}\n          </tbody>\n        </table>\n      );\n    }\n  }\n\n  TableRenderer.defaultProps = PivotData.defaultProps;\n  TableRenderer.propTypes = PivotData.propTypes;\n  TableRenderer.defaultProps.tableColorScaleGenerator = redColorScaleGenerator;\n  TableRenderer.defaultProps.barScaleGenerator = defaultBarchartScaleGenerator;\n  TableRenderer.defaultProps.tableOptions = {};\n  TableRenderer.propTypes.tableColorScaleGenerator = PropTypes.func;\n  TableRenderer.propTypes.tableOptions = PropTypes.object;\n  return TableRenderer;\n}\n\nclass TSVExportRenderer extends React.PureComponent {\n  render() {\n    const pivotData = new PivotData(this.props);\n    const rowKeys = pivotData.getRowKeys();\n    const colKeys = pivotData.getColKeys();\n    if (rowKeys.length === 0) {\n      rowKeys.push([]);\n    }\n    if (colKeys.length === 0) {\n      colKeys.push([]);\n    }\n\n    const headerRow = pivotData.props.rows.map((r) => r);\n    if (colKeys.length === 1 && colKeys[0].length === 0) {\n      headerRow.push(this.props.aggregatorName);\n    } else {\n      colKeys.map((c) => headerRow.push(c.join('-')));\n    }\n\n    const result = rowKeys.map((r) => {\n      const row = r.map((x) => x);\n      colKeys.map((c) => {\n        const v = pivotData.getAggregator(r, c).value();\n        row.push(v ? v : '');\n      });\n      return row;\n    });\n\n    result.unshift(headerRow);\n\n    return (\n      <textarea\n        value={result.map((r) => r.join('\\t')).join('\\n')}\n        style={{width: window.innerWidth / 2, height: window.innerHeight / 2}}\n        readOnly={true}\n      />\n    );\n  }\n}\n\nTSVExportRenderer.defaultProps = PivotData.defaultProps;\nTSVExportRenderer.propTypes = PivotData.propTypes;\n\nexport default {\n  Table: makeRenderer(),\n  'Table Heatmap': makeRenderer({heatmapMode: 'full'}),\n  'Table Col Heatmap': makeRenderer({heatmapMode: 'col'}),\n  'Table Row Heatmap': makeRenderer({heatmapMode: 'row'}),\n  'Table Barchart': makeRenderer({barchartMode: 'full'}),\n  'Table Col Barchart': makeRenderer({barchartMode: 'col'}),\n  'Table Row Barchart': makeRenderer({barchartMode: 'row'}),\n  'Table With Subtotal': makeRenderer({subtotals: true}),\n  'Table With Subtotal Heatmap': makeRenderer({\n    heatmapMode: 'full',\n    subtotals: true,\n  }),\n  'Table With Subtotal Col Heatmap': makeRenderer({\n    heatmapMode: 'col',\n    subtotals: true,\n  }),\n  'Table With Subtotal Row Heatmap': makeRenderer({\n    heatmapMode: 'row',\n    subtotals: true,\n  }),\n  'Table With Subtotal Barchart': makeRenderer({\n    barchartMode: 'full',\n    subtotals: true,\n  }),\n  'Table With Subtotal Col Barchart': makeRenderer({\n    barchartMode: 'col',\n    subtotals: true,\n  }),\n  'Table With Subtotal Row Barchart': makeRenderer({\n    barchartMode: 'row',\n    subtotals: true,\n  }),\n  'Exportable TSV': TSVExportRenderer,\n};\n"]}