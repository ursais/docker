(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[31],{

/***/ "./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/Calendar.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/Calendar.js ***!
  \********************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! prop-types */ \"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var d3_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! d3-array */ \"./node_modules/@superset-ui/legacy-plugin-chart-calendar/node_modules/d3-array/src/extent.js\");\n/* harmony import */ var d3_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! d3-array */ \"./node_modules/@superset-ui/legacy-plugin-chart-calendar/node_modules/d3-array/src/range.js\");\n/* harmony import */ var d3_selection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! d3-selection */ \"./node_modules/d3-selection/src/select.js\");\n/* harmony import */ var _superset_ui_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @superset-ui/core */ \"./node_modules/@superset-ui/core/esm/number-format/NumberFormatterRegistrySingleton.js\");\n/* harmony import */ var _superset_ui_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @superset-ui/core */ \"./node_modules/@superset-ui/core/esm/time-format/TimeFormatterRegistrySingleton.js\");\n/* harmony import */ var _superset_ui_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @superset-ui/core */ \"./node_modules/@superset-ui/core/esm/color/SequentialSchemeRegistrySingleton.js\");\n/* harmony import */ var _vendor_cal_heatmap__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./vendor/cal-heatmap */ \"./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.js\");\n/* harmony import */ var _vendor_cal_heatmap_css__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./vendor/cal-heatmap.css */ \"./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css\");\n/* harmony import */ var _vendor_cal_heatmap_css__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_vendor_cal_heatmap_css__WEBPACK_IMPORTED_MODULE_8__);\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n\n\n\n\n\n\nfunction convertUTC(dttm) {\n  return new Date(dttm.getUTCFullYear(), dttm.getUTCMonth(), dttm.getUTCDate(), dttm.getUTCHours(), dttm.getUTCMinutes(), dttm.getUTCSeconds());\n}\n\nconst convertUTCTS = uts => convertUTC(new Date(uts)).getTime();\n\nconst propTypes = {\n  data: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.shape({\n    // Object hashed by metric name,\n    // then hashed by timestamp (in seconds, not milliseconds) as float\n    // the innermost value is count\n    // e.g. { count_distinct_something: { 1535034236.0: 3 } }\n    data: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.object,\n    domain: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.string,\n    range: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.number,\n    // timestamp in milliseconds\n    start: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.number,\n    subdomain: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.string\n  }),\n  height: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellPadding: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellRadius: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellSize: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.number,\n  linearColorScheme: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.string,\n  showLegend: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.bool,\n  showMetricName: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.bool,\n  showValues: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.bool,\n  steps: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.number,\n  timeFormat: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.string,\n  valueFormat: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.string,\n  verboseMap: prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.object\n};\n\nfunction Calendar(element, props) {\n  const {\n    data,\n    height,\n    cellPadding = 3,\n    cellRadius = 0,\n    cellSize = 10,\n    domainGranularity,\n    linearColorScheme,\n    showLegend,\n    showMetricName,\n    showValues,\n    steps,\n    subdomainGranularity,\n    timeFormat,\n    valueFormat,\n    verboseMap\n  } = props;\n  const valueFormatter = Object(_superset_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"getNumberFormatter\"])(valueFormat);\n  const timeFormatter = Object(_superset_ui_core__WEBPACK_IMPORTED_MODULE_5__[\"getTimeFormatter\"])(timeFormat);\n  const container = Object(d3_selection__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(element).classed('superset-legacy-chart-calendar', true).style('height', height);\n  container.selectAll('*').remove();\n  const div = container.append('div');\n  const subDomainTextFormat = showValues ? (date, value) => valueFormatter(value) : null; // Trick to convert all timestamps to UTC\n  // TODO: Verify if this conversion is really necessary\n  // since all timestamps should always be in UTC.\n\n  const metricsData = {};\n  Object.keys(data.data).forEach(metric => {\n    metricsData[metric] = {};\n    Object.keys(data.data[metric]).forEach(ts => {\n      metricsData[metric][convertUTCTS(ts * 1000) / 1000] = data.data[metric][ts];\n    });\n  });\n  Object.keys(metricsData).forEach(metric => {\n    const calContainer = div.append('div');\n\n    if (showMetricName) {\n      calContainer.text(`Metric: ${verboseMap[metric] || metric}`);\n    }\n\n    const timestamps = metricsData[metric];\n    const extents = Object(d3_array__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(Object.keys(timestamps), key => timestamps[key]);\n    const step = (extents[1] - extents[0]) / (steps - 1);\n    const colorScale = Object(_superset_ui_core__WEBPACK_IMPORTED_MODULE_6__[\"default\"])().get(linearColorScheme).createLinearScale(extents);\n    const legend = Object(d3_array__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(steps).map(i => extents[0] + step * i);\n    const legendColors = legend.map(x => colorScale(x));\n    const cal = new _vendor_cal_heatmap__WEBPACK_IMPORTED_MODULE_7__[\"default\"]();\n    cal.init({\n      start: convertUTCTS(data.start),\n      data: timestamps,\n      itemSelector: calContainer.node(),\n      legendVerticalPosition: 'top',\n      cellSize,\n      cellPadding,\n      cellRadius,\n      legendCellSize: cellSize,\n      legendCellPadding: 2,\n      legendCellRadius: cellRadius,\n      tooltip: true,\n      domain: domainGranularity,\n      subDomain: subdomainGranularity,\n      range: data.range,\n      browsing: true,\n      legend,\n      legendColors: {\n        colorScale,\n        min: legendColors[0],\n        max: legendColors[legendColors.length - 1],\n        empty: 'white'\n      },\n      displayLegend: showLegend,\n      itemName: '',\n      valueFormatter,\n      timeFormatter,\n      subDomainTextFormat\n    });\n  });\n}\n\nCalendar.displayName = 'Calendar';\nCalendar.propTypes = propTypes;\n/* harmony default export */ __webpack_exports__[\"default\"] = (Calendar);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL0NhbGVuZGFyLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzdXBlcnNldC11aS9sZWdhY3ktcGx1Z2luLWNoYXJ0LWNhbGVuZGFyL2VzbS9DYWxlbmRhci5qcz9kNTU1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgeyBleHRlbnQgYXMgZDNFeHRlbnQsIHJhbmdlIGFzIGQzUmFuZ2UgfSBmcm9tICdkMy1hcnJheSc7XG5pbXBvcnQgeyBzZWxlY3QgYXMgZDNTZWxlY3QgfSBmcm9tICdkMy1zZWxlY3Rpb24nO1xuaW1wb3J0IHsgZ2V0TnVtYmVyRm9ybWF0dGVyLCBnZXRUaW1lRm9ybWF0dGVyLCBnZXRTZXF1ZW50aWFsU2NoZW1lUmVnaXN0cnkgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgQ2FsSGVhdE1hcCBmcm9tICcuL3ZlbmRvci9jYWwtaGVhdG1hcCc7XG5pbXBvcnQgJy4vdmVuZG9yL2NhbC1oZWF0bWFwLmNzcyc7XG5cbmZ1bmN0aW9uIGNvbnZlcnRVVEMoZHR0bSkge1xuICByZXR1cm4gbmV3IERhdGUoZHR0bS5nZXRVVENGdWxsWWVhcigpLCBkdHRtLmdldFVUQ01vbnRoKCksIGR0dG0uZ2V0VVRDRGF0ZSgpLCBkdHRtLmdldFVUQ0hvdXJzKCksIGR0dG0uZ2V0VVRDTWludXRlcygpLCBkdHRtLmdldFVUQ1NlY29uZHMoKSk7XG59XG5cbmNvbnN0IGNvbnZlcnRVVENUUyA9IHV0cyA9PiBjb252ZXJ0VVRDKG5ldyBEYXRlKHV0cykpLmdldFRpbWUoKTtcblxuY29uc3QgcHJvcFR5cGVzID0ge1xuICBkYXRhOiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgIC8vIE9iamVjdCBoYXNoZWQgYnkgbWV0cmljIG5hbWUsXG4gICAgLy8gdGhlbiBoYXNoZWQgYnkgdGltZXN0YW1wIChpbiBzZWNvbmRzLCBub3QgbWlsbGlzZWNvbmRzKSBhcyBmbG9hdFxuICAgIC8vIHRoZSBpbm5lcm1vc3QgdmFsdWUgaXMgY291bnRcbiAgICAvLyBlLmcuIHsgY291bnRfZGlzdGluY3Rfc29tZXRoaW5nOiB7IDE1MzUwMzQyMzYuMDogMyB9IH1cbiAgICBkYXRhOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIGRvbWFpbjogUHJvcFR5cGVzLnN0cmluZyxcbiAgICByYW5nZTogUHJvcFR5cGVzLm51bWJlcixcbiAgICAvLyB0aW1lc3RhbXAgaW4gbWlsbGlzZWNvbmRzXG4gICAgc3RhcnQ6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgc3ViZG9tYWluOiBQcm9wVHlwZXMuc3RyaW5nXG4gIH0pLFxuICBoZWlnaHQ6IFByb3BUeXBlcy5udW1iZXIsXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9zb3J0LXByb3AtdHlwZXNcbiAgY2VsbFBhZGRpbmc6IFByb3BUeXBlcy5udW1iZXIsXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9zb3J0LXByb3AtdHlwZXNcbiAgY2VsbFJhZGl1czogUHJvcFR5cGVzLm51bWJlcixcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L3NvcnQtcHJvcC10eXBlc1xuICBjZWxsU2l6ZTogUHJvcFR5cGVzLm51bWJlcixcbiAgbGluZWFyQ29sb3JTY2hlbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIHNob3dMZWdlbmQ6IFByb3BUeXBlcy5ib29sLFxuICBzaG93TWV0cmljTmFtZTogUHJvcFR5cGVzLmJvb2wsXG4gIHNob3dWYWx1ZXM6IFByb3BUeXBlcy5ib29sLFxuICBzdGVwczogUHJvcFR5cGVzLm51bWJlcixcbiAgdGltZUZvcm1hdDogUHJvcFR5cGVzLnN0cmluZyxcbiAgdmFsdWVGb3JtYXQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIHZlcmJvc2VNYXA6IFByb3BUeXBlcy5vYmplY3Rcbn07XG5cbmZ1bmN0aW9uIENhbGVuZGFyKGVsZW1lbnQsIHByb3BzKSB7XG4gIGNvbnN0IHtcbiAgICBkYXRhLFxuICAgIGhlaWdodCxcbiAgICBjZWxsUGFkZGluZyA9IDMsXG4gICAgY2VsbFJhZGl1cyA9IDAsXG4gICAgY2VsbFNpemUgPSAxMCxcbiAgICBkb21haW5HcmFudWxhcml0eSxcbiAgICBsaW5lYXJDb2xvclNjaGVtZSxcbiAgICBzaG93TGVnZW5kLFxuICAgIHNob3dNZXRyaWNOYW1lLFxuICAgIHNob3dWYWx1ZXMsXG4gICAgc3RlcHMsXG4gICAgc3ViZG9tYWluR3JhbnVsYXJpdHksXG4gICAgdGltZUZvcm1hdCxcbiAgICB2YWx1ZUZvcm1hdCxcbiAgICB2ZXJib3NlTWFwXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgdmFsdWVGb3JtYXR0ZXIgPSBnZXROdW1iZXJGb3JtYXR0ZXIodmFsdWVGb3JtYXQpO1xuICBjb25zdCB0aW1lRm9ybWF0dGVyID0gZ2V0VGltZUZvcm1hdHRlcih0aW1lRm9ybWF0KTtcbiAgY29uc3QgY29udGFpbmVyID0gZDNTZWxlY3QoZWxlbWVudCkuY2xhc3NlZCgnc3VwZXJzZXQtbGVnYWN5LWNoYXJ0LWNhbGVuZGFyJywgdHJ1ZSkuc3R5bGUoJ2hlaWdodCcsIGhlaWdodCk7XG4gIGNvbnRhaW5lci5zZWxlY3RBbGwoJyonKS5yZW1vdmUoKTtcbiAgY29uc3QgZGl2ID0gY29udGFpbmVyLmFwcGVuZCgnZGl2Jyk7XG4gIGNvbnN0IHN1YkRvbWFpblRleHRGb3JtYXQgPSBzaG93VmFsdWVzID8gKGRhdGUsIHZhbHVlKSA9PiB2YWx1ZUZvcm1hdHRlcih2YWx1ZSkgOiBudWxsOyAvLyBUcmljayB0byBjb252ZXJ0IGFsbCB0aW1lc3RhbXBzIHRvIFVUQ1xuICAvLyBUT0RPOiBWZXJpZnkgaWYgdGhpcyBjb252ZXJzaW9uIGlzIHJlYWxseSBuZWNlc3NhcnlcbiAgLy8gc2luY2UgYWxsIHRpbWVzdGFtcHMgc2hvdWxkIGFsd2F5cyBiZSBpbiBVVEMuXG5cbiAgY29uc3QgbWV0cmljc0RhdGEgPSB7fTtcbiAgT2JqZWN0LmtleXMoZGF0YS5kYXRhKS5mb3JFYWNoKG1ldHJpYyA9PiB7XG4gICAgbWV0cmljc0RhdGFbbWV0cmljXSA9IHt9O1xuICAgIE9iamVjdC5rZXlzKGRhdGEuZGF0YVttZXRyaWNdKS5mb3JFYWNoKHRzID0+IHtcbiAgICAgIG1ldHJpY3NEYXRhW21ldHJpY11bY29udmVydFVUQ1RTKHRzICogMTAwMCkgLyAxMDAwXSA9IGRhdGEuZGF0YVttZXRyaWNdW3RzXTtcbiAgICB9KTtcbiAgfSk7XG4gIE9iamVjdC5rZXlzKG1ldHJpY3NEYXRhKS5mb3JFYWNoKG1ldHJpYyA9PiB7XG4gICAgY29uc3QgY2FsQ29udGFpbmVyID0gZGl2LmFwcGVuZCgnZGl2Jyk7XG5cbiAgICBpZiAoc2hvd01ldHJpY05hbWUpIHtcbiAgICAgIGNhbENvbnRhaW5lci50ZXh0KGBNZXRyaWM6ICR7dmVyYm9zZU1hcFttZXRyaWNdIHx8IG1ldHJpY31gKTtcbiAgICB9XG5cbiAgICBjb25zdCB0aW1lc3RhbXBzID0gbWV0cmljc0RhdGFbbWV0cmljXTtcbiAgICBjb25zdCBleHRlbnRzID0gZDNFeHRlbnQoT2JqZWN0LmtleXModGltZXN0YW1wcyksIGtleSA9PiB0aW1lc3RhbXBzW2tleV0pO1xuICAgIGNvbnN0IHN0ZXAgPSAoZXh0ZW50c1sxXSAtIGV4dGVudHNbMF0pIC8gKHN0ZXBzIC0gMSk7XG4gICAgY29uc3QgY29sb3JTY2FsZSA9IGdldFNlcXVlbnRpYWxTY2hlbWVSZWdpc3RyeSgpLmdldChsaW5lYXJDb2xvclNjaGVtZSkuY3JlYXRlTGluZWFyU2NhbGUoZXh0ZW50cyk7XG4gICAgY29uc3QgbGVnZW5kID0gZDNSYW5nZShzdGVwcykubWFwKGkgPT4gZXh0ZW50c1swXSArIHN0ZXAgKiBpKTtcbiAgICBjb25zdCBsZWdlbmRDb2xvcnMgPSBsZWdlbmQubWFwKHggPT4gY29sb3JTY2FsZSh4KSk7XG4gICAgY29uc3QgY2FsID0gbmV3IENhbEhlYXRNYXAoKTtcbiAgICBjYWwuaW5pdCh7XG4gICAgICBzdGFydDogY29udmVydFVUQ1RTKGRhdGEuc3RhcnQpLFxuICAgICAgZGF0YTogdGltZXN0YW1wcyxcbiAgICAgIGl0ZW1TZWxlY3RvcjogY2FsQ29udGFpbmVyLm5vZGUoKSxcbiAgICAgIGxlZ2VuZFZlcnRpY2FsUG9zaXRpb246ICd0b3AnLFxuICAgICAgY2VsbFNpemUsXG4gICAgICBjZWxsUGFkZGluZyxcbiAgICAgIGNlbGxSYWRpdXMsXG4gICAgICBsZWdlbmRDZWxsU2l6ZTogY2VsbFNpemUsXG4gICAgICBsZWdlbmRDZWxsUGFkZGluZzogMixcbiAgICAgIGxlZ2VuZENlbGxSYWRpdXM6IGNlbGxSYWRpdXMsXG4gICAgICB0b29sdGlwOiB0cnVlLFxuICAgICAgZG9tYWluOiBkb21haW5HcmFudWxhcml0eSxcbiAgICAgIHN1YkRvbWFpbjogc3ViZG9tYWluR3JhbnVsYXJpdHksXG4gICAgICByYW5nZTogZGF0YS5yYW5nZSxcbiAgICAgIGJyb3dzaW5nOiB0cnVlLFxuICAgICAgbGVnZW5kLFxuICAgICAgbGVnZW5kQ29sb3JzOiB7XG4gICAgICAgIGNvbG9yU2NhbGUsXG4gICAgICAgIG1pbjogbGVnZW5kQ29sb3JzWzBdLFxuICAgICAgICBtYXg6IGxlZ2VuZENvbG9yc1tsZWdlbmRDb2xvcnMubGVuZ3RoIC0gMV0sXG4gICAgICAgIGVtcHR5OiAnd2hpdGUnXG4gICAgICB9LFxuICAgICAgZGlzcGxheUxlZ2VuZDogc2hvd0xlZ2VuZCxcbiAgICAgIGl0ZW1OYW1lOiAnJyxcbiAgICAgIHZhbHVlRm9ybWF0dGVyLFxuICAgICAgdGltZUZvcm1hdHRlcixcbiAgICAgIHN1YkRvbWFpblRleHRGb3JtYXRcbiAgICB9KTtcbiAgfSk7XG59XG5cbkNhbGVuZGFyLmRpc3BsYXlOYW1lID0gJ0NhbGVuZGFyJztcbkNhbGVuZGFyLnByb3BUeXBlcyA9IHByb3BUeXBlcztcbmV4cG9ydCBkZWZhdWx0IENhbGVuZGFyOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/Calendar.js\n");

/***/ }),

/***/ "./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/ReactCalendar.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/ReactCalendar.js ***!
  \*************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prop-types */ \"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _superset_ui_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @superset-ui/core */ \"./node_modules/@superset-ui/core/esm/chart/components/reactify.js\");\n/* harmony import */ var _superset_ui_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @superset-ui/core */ \"./node_modules/@superset-ui/core/esm/style/index.js\");\n/* harmony import */ var _Calendar__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Calendar */ \"./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/Calendar.js\");\n/* harmony import */ var _emotion_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @emotion/react */ \"./node_modules/@emotion/react/dist/emotion-react.browser.esm.js\");\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n\n\n\n\nconst ReactComponent = Object(_superset_ui_core__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_Calendar__WEBPACK_IMPORTED_MODULE_4__[\"default\"]);\n\nconst Calender = ({\n  className,\n  ...otherProps\n}) => Object(_emotion_react__WEBPACK_IMPORTED_MODULE_5__[\"jsx\"])(\"div\", {\n  className: className\n}, Object(_emotion_react__WEBPACK_IMPORTED_MODULE_5__[\"jsx\"])(ReactComponent, otherProps));\n\nCalender.defaultProps = {\n  otherProps: {}\n};\nCalender.propTypes = {\n  className: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string.isRequired,\n  otherProps: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.objectOf(prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.any)\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(_superset_ui_core__WEBPACK_IMPORTED_MODULE_3__[\"styled\"])(Calender)`\n  .superset-legacy-chart-calendar {\n    padding: 10px;\n    position: static !important;\n    overflow: auto !important;\n  }\n\n  .superset-legacy-chart-calendar .ch-tooltip {\n    margin-left: 20px;\n    margin-top: 5px;\n  }\n`);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL1JlYWN0Q2FsZW5kYXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL1JlYWN0Q2FsZW5kYXIuanM/YjYwZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB7IHJlYWN0aWZ5LCBzdHlsZWQgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vQ2FsZW5kYXInO1xuaW1wb3J0IHsganN4IGFzIF9fX0Vtb3Rpb25KU1ggfSBmcm9tIFwiQGVtb3Rpb24vcmVhY3RcIjtcbmNvbnN0IFJlYWN0Q29tcG9uZW50ID0gcmVhY3RpZnkoQ29tcG9uZW50KTtcblxuY29uc3QgQ2FsZW5kZXIgPSAoe1xuICBjbGFzc05hbWUsXG4gIC4uLm90aGVyUHJvcHNcbn0pID0+IF9fX0Vtb3Rpb25KU1goXCJkaXZcIiwge1xuICBjbGFzc05hbWU6IGNsYXNzTmFtZVxufSwgX19fRW1vdGlvbkpTWChSZWFjdENvbXBvbmVudCwgb3RoZXJQcm9wcykpO1xuXG5DYWxlbmRlci5kZWZhdWx0UHJvcHMgPSB7XG4gIG90aGVyUHJvcHM6IHt9XG59O1xuQ2FsZW5kZXIucHJvcFR5cGVzID0ge1xuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgb3RoZXJQcm9wczogUHJvcFR5cGVzLm9iamVjdE9mKFByb3BUeXBlcy5hbnkpXG59O1xuZXhwb3J0IGRlZmF1bHQgc3R5bGVkKENhbGVuZGVyKWBcbiAgLnN1cGVyc2V0LWxlZ2FjeS1jaGFydC1jYWxlbmRhciB7XG4gICAgcGFkZGluZzogMTBweDtcbiAgICBwb3NpdGlvbjogc3RhdGljICFpbXBvcnRhbnQ7XG4gICAgb3ZlcmZsb3c6IGF1dG8gIWltcG9ydGFudDtcbiAgfVxuXG4gIC5zdXBlcnNldC1sZWdhY3ktY2hhcnQtY2FsZW5kYXIgLmNoLXRvb2x0aXAge1xuICAgIG1hcmdpbi1sZWZ0OiAyMHB4O1xuICAgIG1hcmdpbi10b3A6IDVweDtcbiAgfVxuYDsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/ReactCalendar.js\n");

/***/ }),

/***/ "./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css ***!
  \*******************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var content = __webpack_require__(/*! !../../../../css-loader??ref--7-1!./cal-heatmap.css */ \"./node_modules/css-loader/index.js?!./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css\");\n\nif (typeof content === 'string') {\n  content = [[module.i, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = __webpack_require__(/*! ../../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js */ \"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9jYWwtaGVhdG1hcC5jc3MuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9jYWwtaGVhdG1hcC5jc3M/YzljYSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uLy4uLy4uL2Nzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tNy0xIS4vY2FsLWhlYXRtYXAuY3NzXCIpO1xuXG5pZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbn1cblxudmFyIG9wdGlvbnMgPSB7fVxuXG5vcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xub3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcblxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vLi4vLi4vLi4vc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIikoY29udGVudCwgb3B0aW9ucyk7XG5cbmlmIChjb250ZW50LmxvY2Fscykge1xuICBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css\n");

/***/ }),

/***/ "./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.js ***!
  \******************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var d3_tip__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! d3-tip */ \"./node_modules/d3-tip/index.js\");\n/* harmony import */ var _d3tip_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./d3tip.css */ \"./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css\");\n/* harmony import */ var _d3tip_css__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_d3tip_css__WEBPACK_IMPORTED_MODULE_1__);\n// [LICENSE TBD]\n\n/* Copied and altered from http://cal-heatmap.com/ , alterations around:\n * - tuning tooltips\n * - supporting multi-colors scales\n * - legend format\n * - UTC handling\n */\n\n/* eslint-disable */\n\n\nvar d3 =  true ? __webpack_require__(/*! d3 */ \"./node_modules/d3/d3.js\") : undefined;\nvar d3 =  true ? __webpack_require__(/*! d3 */ \"./node_modules/d3/d3.js\") : undefined;\n\nvar CalHeatMap = function () {\n  'use strict';\n\n  var self = this;\n  self.tip = Object(d3_tip__WEBPACK_IMPORTED_MODULE_0__[\"default\"])().attr('class', 'd3-tip').direction('n').offset([-5, 0]).html(d => `\n      ${self.options.timeFormatter(d.t)}: <strong>${self.options.valueFormatter(d.v)}</strong>\n    `);\n  self.legendTip = Object(d3_tip__WEBPACK_IMPORTED_MODULE_0__[\"default\"])().attr('class', 'd3-tip').direction('n').offset([-5, 0]).html(d => self.options.valueFormatter(d));\n  this.allowedDataType = ['json', 'csv', 'tsv', 'txt']; // Default settings\n\n  this.options = {\n    // selector string of the container to append the graph to\n    // Accept any string value accepted by document.querySelector or CSS3\n    // or an Element object\n    itemSelector: '#cal-heatmap',\n    // Whether to paint the calendar on init()\n    // Used by testsuite to reduce testing time\n    paintOnLoad: true,\n    // ================================================\n    // DOMAIN\n    // ================================================\n    // Number of domain to display on the graph\n    range: 12,\n    // Size of each cell, in pixel\n    cellSize: 10,\n    // Padding between each cell, in pixel\n    cellPadding: 2,\n    // For rounded subdomain rectangles, in pixels\n    cellRadius: 0,\n    domainGutter: 2,\n    domainMargin: [0, 0, 0, 0],\n    valueFormatter: d => d,\n    timeFormatter: d => d,\n    domain: 'hour',\n    subDomain: 'min',\n    // Number of columns to split the subDomains to\n    // If not null, will takes precedence over rowLimit\n    colLimit: null,\n    // Number of rows to split the subDomains to\n    // Will be ignored if colLimit is not null\n    rowLimit: null,\n    // First day of the week is Monday\n    // 0 to start the week on Sunday\n    weekStartOnMonday: true,\n    // Start date of the graph\n    // @default now\n    start: new Date(),\n    minDate: null,\n    maxDate: null,\n    // ================================================\n    // DATA\n    // ================================================\n    // Data source\n    // URL, where to fetch the original datas\n    data: '',\n    // Data type\n    // Default: json\n    dataType: this.allowedDataType[0],\n    // Payload sent when using POST http method\n    // Leave to null (default) for GET request\n    // Expect a string, formatted like \"a=b;c=d\"\n    dataPostPayload: null,\n    // Additional headers sent when requesting data\n    // Expect an object formatted like:\n    // { 'X-CSRF-TOKEN': 'token' }\n    dataRequestHeaders: null,\n    // Whether to consider missing date:value from the datasource\n    // as equal to 0, or just leave them as missing\n    considerMissingDataAsZero: false,\n    // Load remote data on calendar creation\n    // When false, the calendar will be left empty\n    loadOnInit: true,\n    // Calendar orientation\n    // false: display domains side by side\n    // true : display domains one under the other\n    verticalOrientation: false,\n    // Domain dynamic width/height\n    // The width on a domain depends on the number of\n    domainDynamicDimension: true,\n    // Domain Label properties\n    label: {\n      // valid: top, right, bottom, left\n      position: 'bottom',\n      // Valid: left, center, right\n      // Also valid are the direct svg values: start, middle, end\n      align: 'center',\n      // By default, there is no margin/padding around the label\n      offset: {\n        x: 0,\n        y: 0\n      },\n      rotate: null,\n      // Used only on vertical orientation\n      width: 100,\n      // Used only on horizontal orientation\n      height: null\n    },\n    // ================================================\n    // LEGEND\n    // ================================================\n    // Threshold for the legend\n    legend: [10, 20, 30, 40],\n    // Whether to display the legend\n    displayLegend: true,\n    legendCellSize: 10,\n    legendCellPadding: 2,\n    legendMargin: [0, 0, 0, 0],\n    // Legend vertical position\n    // top: place legend above calendar\n    // bottom: place legend below the calendar\n    legendVerticalPosition: 'bottom',\n    // Legend horizontal position\n    // accepted values: left, center, right\n    legendHorizontalPosition: 'left',\n    // Legend rotation\n    // accepted values: horizontal, vertical\n    legendOrientation: 'horizontal',\n    // Objects holding all the heatmap different colors\n    // null to disable, and use the default css styles\n    //\n    // Examples:\n    // legendColors: {\n    //    min: \"green\",\n    //    max: \"red\",\n    //    empty: \"#ffffff\",\n    //    base: \"grey\",\n    //    overflow: \"red\",\n    //    colorScaler: null,\n    // }\n    legendColors: null,\n    // ================================================\n    // HIGHLIGHT\n    // ================================================\n    // List of dates to highlight\n    // Valid values:\n    // - []: don't highlight anything\n    // - \"now\": highlight the current date\n    // - an array of Date objects: highlight the specified dates\n    highlight: [],\n    // ================================================\n    // TEXT FORMATTING / i18n\n    // ================================================\n    // Name of the items to represent in the calendar\n    itemName: ['item', 'items'],\n    // Formatting of the domain label\n    // @default: null, will use the formatting according to domain type\n    // Accept a string used as specifier by d3.time.format()\n    // or a function\n    //\n    // Refer to https://github.com/mbostock/d3/wiki/Time-Formatting\n    // for accepted date formatting used by d3.time.format()\n    domainLabelFormat: null,\n    // Formatting of the title displayed when hovering a subDomain cell\n    subDomainTitleFormat: {\n      empty: '{date}',\n      filled: '{count} {name} {connector} {date}'\n    },\n    // Formatting of the {date} used in subDomainTitleFormat\n    // @default: null, will use the formatting according to subDomain type\n    // Accept a string used as specifier by d3.time.format()\n    // or a function\n    //\n    // Refer to https://github.com/mbostock/d3/wiki/Time-Formatting\n    // for accepted date formatting used by d3.time.format()\n    subDomainDateFormat: null,\n    // Formatting of the text inside each subDomain cell\n    // @default: null, no text\n    // Accept a string used as specifier by d3.time.format()\n    // or a function\n    //\n    // Refer to https://github.com/mbostock/d3/wiki/Time-Formatting\n    // for accepted date formatting used by d3.time.format()\n    subDomainTextFormat: null,\n    // Formatting of the title displayed when hovering a legend cell\n    legendTitleFormat: {\n      lower: 'less than {min} {name}',\n      inner: 'between {down} and {up} {name}',\n      upper: 'more than {max} {name}'\n    },\n    // Animation duration, in ms\n    animationDuration: 500,\n    nextSelector: false,\n    previousSelector: false,\n    itemNamespace: 'cal-heatmap',\n    tooltip: false,\n    // ================================================\n    // EVENTS CALLBACK\n    // ================================================\n    // Callback when clicking on a time block\n    onClick: null,\n    // Callback after painting the empty calendar\n    // Can be used to trigger an API call, once the calendar is ready to be filled\n    afterLoad: null,\n    // Callback after loading the next domain in the calendar\n    afterLoadNextDomain: null,\n    // Callback after loading the previous domain in the calendar\n    afterLoadPreviousDomain: null,\n    // Callback after finishing all actions on the calendar\n    onComplete: null,\n    // Callback after fetching the datas, but before applying them to the calendar\n    // Used mainly to convert the datas if they're not formatted like expected\n    // Takes the fetched \"data\" object as argument, must return a json object\n    // formatted like {timestamp:count, timestamp2:count2},\n    afterLoadData: function (data) {\n      return data;\n    },\n    // Callback triggered after calling and completing update().\n    afterUpdate: null,\n    // Callback triggered after calling next().\n    // The `status` argument is equal to true if there is no\n    // more next domain to load\n    //\n    // This callback is also executed once, after calling previous(),\n    // only when the max domain is reached\n    onMaxDomainReached: null,\n    // Callback triggered after calling previous().\n    // The `status` argument is equal to true if there is no\n    // more previous domain to load\n    //\n    // This callback is also executed once, after calling next(),\n    // only when the min domain is reached\n    onMinDomainReached: null\n  };\n  this._domainType = {\n    min: {\n      name: 'minute',\n      level: 10,\n      maxItemNumber: 60,\n      defaultRowNumber: 10,\n      defaultColumnNumber: 6,\n      row: function (d) {\n        return self.getSubDomainRowNumber(d);\n      },\n      column: function (d) {\n        return self.getSubDomainColumnNumber(d);\n      },\n      position: {\n        x: function (d) {\n          return Math.floor(d.getMinutes() / self._domainType.min.row(d));\n        },\n        y: function (d) {\n          return d.getMinutes() % self._domainType.min.row(d);\n        }\n      },\n      format: {\n        date: '%H:%M, %A %B %-e, %Y',\n        legend: '',\n        connector: 'at'\n      },\n      extractUnit: function (d) {\n        return new Date(d.getFullYear(), d.getMonth(), d.getDate(), d.getHours(), d.getMinutes()).getTime();\n      }\n    },\n    hour: {\n      name: 'hour',\n      level: 20,\n      maxItemNumber: function (d) {\n        switch (self.options.domain) {\n          case 'day':\n            return 24;\n\n          case 'week':\n            return 24 * 7;\n\n          case 'month':\n            return 24 * (self.options.domainDynamicDimension ? self.getDayCountInMonth(d) : 31);\n        }\n      },\n      defaultRowNumber: 6,\n      defaultColumnNumber: function (d) {\n        switch (self.options.domain) {\n          case 'day':\n            return 4;\n\n          case 'week':\n            return 28;\n\n          case 'month':\n            return self.options.domainDynamicDimension ? self.getDayCountInMonth(d) : 31;\n        }\n      },\n      row: function (d) {\n        return self.getSubDomainRowNumber(d);\n      },\n      column: function (d) {\n        return self.getSubDomainColumnNumber(d);\n      },\n      position: {\n        x: function (d) {\n          if (self.options.domain === 'month') {\n            if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n              return Math.floor((d.getHours() + (d.getDate() - 1) * 24) / self._domainType.hour.row(d));\n            }\n\n            return Math.floor(d.getHours() / self._domainType.hour.row(d)) + (d.getDate() - 1) * 4;\n          } else if (self.options.domain === 'week') {\n            if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n              return Math.floor((d.getHours() + self.getWeekDay(d) * 24) / self._domainType.hour.row(d));\n            }\n\n            return Math.floor(d.getHours() / self._domainType.hour.row(d)) + self.getWeekDay(d) * 4;\n          }\n\n          return Math.floor(d.getHours() / self._domainType.hour.row(d));\n        },\n        y: function (d) {\n          var p = d.getHours();\n\n          if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n            switch (self.options.domain) {\n              case 'month':\n                p += (d.getDate() - 1) * 24;\n                break;\n\n              case 'week':\n                p += self.getWeekDay(d) * 24;\n                break;\n            }\n          }\n\n          return Math.floor(p % self._domainType.hour.row(d));\n        }\n      },\n      format: {\n        date: '%Hh, %A %B %-e, %Y',\n        legend: '%H:00',\n        connector: 'at'\n      },\n      extractUnit: function (d) {\n        return new Date(d.getFullYear(), d.getMonth(), d.getDate(), d.getHours()).getTime();\n      }\n    },\n    day: {\n      name: 'day',\n      level: 30,\n      maxItemNumber: function (d) {\n        switch (self.options.domain) {\n          case 'week':\n            return 7;\n\n          case 'month':\n            return self.options.domainDynamicDimension ? self.getDayCountInMonth(d) : 31;\n\n          case 'year':\n            return self.options.domainDynamicDimension ? self.getDayCountInYear(d) : 366;\n        }\n      },\n      defaultColumnNumber: function (d) {\n        d = new Date(d);\n\n        switch (self.options.domain) {\n          case 'week':\n            return 1;\n\n          case 'month':\n            return self.options.domainDynamicDimension && !self.options.verticalOrientation ? self.getWeekNumber(new Date(d.getFullYear(), d.getMonth() + 1, 0)) - self.getWeekNumber(d) + 1 : 6;\n\n          case 'year':\n            return self.options.domainDynamicDimension ? self.getWeekNumber(new Date(d.getFullYear(), 11, 31)) - self.getWeekNumber(new Date(d.getFullYear(), 0)) + 1 : 54;\n        }\n      },\n      defaultRowNumber: 7,\n      row: function (d) {\n        return self.getSubDomainRowNumber(d);\n      },\n      column: function (d) {\n        return self.getSubDomainColumnNumber(d);\n      },\n      position: {\n        x: function (d) {\n          switch (self.options.domain) {\n            case 'week':\n              return Math.floor(self.getWeekDay(d) / self._domainType.day.row(d));\n\n            case 'month':\n              if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n                return Math.floor((d.getDate() - 1) / self._domainType.day.row(d));\n              }\n\n              return self.getWeekNumber(d) - self.getWeekNumber(new Date(d.getFullYear(), d.getMonth()));\n\n            case 'year':\n              if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n                return Math.floor((self.getDayOfYear(d) - 1) / self._domainType.day.row(d));\n              }\n\n              return self.getWeekNumber(d);\n          }\n        },\n        y: function (d) {\n          var p = self.getWeekDay(d);\n\n          if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n            switch (self.options.domain) {\n              case 'year':\n                p = self.getDayOfYear(d) - 1;\n                break;\n\n              case 'week':\n                p = self.getWeekDay(d);\n                break;\n\n              case 'month':\n                p = d.getDate() - 1;\n                break;\n            }\n          }\n\n          return Math.floor(p % self._domainType.day.row(d));\n        }\n      },\n      format: {\n        date: '%A %B %-e, %Y',\n        legend: '%e %b',\n        connector: 'on'\n      },\n      extractUnit: function (d) {\n        return new Date(d.getFullYear(), d.getMonth(), d.getDate()).getTime();\n      }\n    },\n    week: {\n      name: 'week',\n      level: 40,\n      maxItemNumber: 54,\n      defaultColumnNumber: function (d) {\n        d = new Date(d);\n\n        switch (self.options.domain) {\n          case 'year':\n            return self._domainType.week.maxItemNumber;\n\n          case 'month':\n            return self.options.domainDynamicDimension ? self.getWeekNumber(new Date(d.getFullYear(), d.getMonth() + 1, 0)) - self.getWeekNumber(d) : 5;\n        }\n      },\n      defaultRowNumber: 1,\n      row: function (d) {\n        return self.getSubDomainRowNumber(d);\n      },\n      column: function (d) {\n        return self.getSubDomainColumnNumber(d);\n      },\n      position: {\n        x: function (d) {\n          switch (self.options.domain) {\n            case 'year':\n              return Math.floor(self.getWeekNumber(d) / self._domainType.week.row(d));\n\n            case 'month':\n              return Math.floor(self.getMonthWeekNumber(d) / self._domainType.week.row(d));\n          }\n        },\n        y: function (d) {\n          return self.getWeekNumber(d) % self._domainType.week.row(d);\n        }\n      },\n      format: {\n        date: '%B Week #%W',\n        legend: '%B Week #%W',\n        connector: 'in'\n      },\n      extractUnit: function (d) {\n        var dt = new Date(d.getFullYear(), d.getMonth(), d.getDate()); // According to ISO-8601, week number computation are based on week starting on Monday\n\n        var weekDay = dt.getDay() - (self.options.weekStartOnMonday ? 1 : 0);\n\n        if (weekDay < 0) {\n          weekDay = 6;\n        }\n\n        dt.setDate(dt.getDate() - weekDay);\n        return dt.getTime();\n      }\n    },\n    month: {\n      name: 'month',\n      level: 50,\n      maxItemNumber: 12,\n      defaultColumnNumber: 12,\n      defaultRowNumber: 1,\n      row: function () {\n        return self.getSubDomainRowNumber();\n      },\n      column: function () {\n        return self.getSubDomainColumnNumber();\n      },\n      position: {\n        x: function (d) {\n          return Math.floor(d.getMonth() / self._domainType.month.row(d));\n        },\n        y: function (d) {\n          return d.getMonth() % self._domainType.month.row(d);\n        }\n      },\n      format: {\n        date: '%B %Y',\n        legend: '%B',\n        connector: 'in'\n      },\n      extractUnit: function (d) {\n        return new Date(d.getFullYear(), d.getMonth()).getTime();\n      }\n    },\n    year: {\n      name: 'year',\n      level: 60,\n      row: function () {\n        return self.options.rowLimit || 1;\n      },\n      column: function () {\n        return self.options.colLimit || 1;\n      },\n      position: {\n        x: function () {\n          return 1;\n        },\n        y: function () {\n          return 1;\n        }\n      },\n      format: {\n        date: '%Y',\n        legend: '%Y',\n        connector: 'in'\n      },\n      extractUnit: function (d) {\n        return new Date(d.getFullYear()).getTime();\n      }\n    }\n  };\n\n  for (var type in this._domainType) {\n    if (this._domainType.hasOwnProperty(type)) {\n      var d = this._domainType[type];\n      this._domainType['x_' + type] = {\n        name: 'x_' + type,\n        level: d.type,\n        maxItemNumber: d.maxItemNumber,\n        defaultRowNumber: d.defaultRowNumber,\n        defaultColumnNumber: d.defaultColumnNumber,\n        row: d.column,\n        column: d.row,\n        position: {\n          x: d.position.y,\n          y: d.position.x\n        },\n        format: d.format,\n        extractUnit: d.extractUnit\n      };\n    }\n  } // Record the address of the last inserted domain when browsing\n\n\n  this.lastInsertedSvg = null;\n  this._completed = false; // Record all the valid domains\n  // Each domain value is a timestamp in milliseconds\n\n  this._domains = d3.map();\n  this.graphDim = {\n    width: 0,\n    height: 0\n  };\n  this.legendDim = {\n    width: 0,\n    height: 0\n  };\n  this.NAVIGATE_LEFT = 1;\n  this.NAVIGATE_RIGHT = 2; // Various update mode when using the update() API\n\n  this.RESET_ALL_ON_UPDATE = 0;\n  this.RESET_SINGLE_ON_UPDATE = 1;\n  this.APPEND_ON_UPDATE = 2;\n  this.DEFAULT_LEGEND_MARGIN = 10;\n  this.root = null;\n  this.tooltip = null;\n  this._maxDomainReached = false;\n  this._minDomainReached = false;\n  this.domainPosition = new DomainPosition();\n  this.Legend = null;\n  this.legendScale = null; // List of domains that are skipped because of DST\n  // All times belonging to these domains should be re-assigned to the previous domain\n\n  this.DSTDomain = [];\n  /**\n   * Display the graph for the first time\n   * @return bool True if the calendar is created\n   */\n\n  this._init = function () {\n    self.getDomain(self.options.start).map(function (d) {\n      return d.getTime();\n    }).map(function (d) {\n      self._domains.set(d, self.getSubDomain(d).map(function (d) {\n        return {\n          t: self._domainType[self.options.subDomain].extractUnit(d),\n          v: null\n        };\n      }));\n    });\n    self.root = d3.select(self.options.itemSelector).append('svg').attr('class', 'cal-heatmap-container');\n    self.root.attr('x', 0).attr('y', 0).append('svg').attr('class', 'graph');\n    self.Legend = new Legend(self);\n\n    if (self.options.paintOnLoad) {\n      _initCalendar();\n    }\n\n    self.root.call(self.tip);\n    self.root.call(self.legendTip);\n    return true;\n  };\n\n  function _initCalendar() {\n    self.verticalDomainLabel = self.options.label.position === 'top' || self.options.label.position === 'bottom';\n    self.domainVerticalLabelHeight = self.options.label.height === null ? Math.max(25, self.options.cellSize * 2) : self.options.label.height;\n    self.domainHorizontalLabelWidth = 0;\n\n    if (self.options.domainLabelFormat === '' && self.options.label.height === null) {\n      self.domainVerticalLabelHeight = 0;\n    }\n\n    if (!self.verticalDomainLabel) {\n      self.domainVerticalLabelHeight = 0;\n      self.domainHorizontalLabelWidth = self.options.label.width;\n    }\n\n    self.paint(); // =========================================================================//\n    // ATTACHING DOMAIN NAVIGATION EVENT                    //\n    // =========================================================================//\n\n    if (self.options.nextSelector !== false) {\n      d3.select(self.options.nextSelector).on('click.' + self.options.itemNamespace, function () {\n        d3.event.preventDefault();\n        return self.loadNextDomain(1);\n      });\n    }\n\n    if (self.options.previousSelector !== false) {\n      d3.select(self.options.previousSelector).on('click.' + self.options.itemNamespace, function () {\n        d3.event.preventDefault();\n        return self.loadPreviousDomain(1);\n      });\n    }\n\n    self.Legend.redraw(self.graphDim.width - self.options.domainGutter - self.options.cellPadding);\n    self.afterLoad();\n    var domains = self.getDomainKeys(); // Fill the graph with some datas\n\n    if (self.options.loadOnInit) {\n      self.getDatas(self.options.data, new Date(domains[0]), self.getSubDomain(domains[domains.length - 1]).pop(), function () {\n        self.fill();\n        self.onComplete();\n      });\n    } else {\n      self.onComplete();\n    }\n\n    self.checkIfMinDomainIsReached(domains[0]);\n    self.checkIfMaxDomainIsReached(self.getNextDomain().getTime());\n  } // Return the width of the domain block, without the domain gutter\n  // @param int d Domain start timestamp\n\n\n  function w(d, outer) {\n    var width = self.options.cellSize * self._domainType[self.options.subDomain].column(d) + self.options.cellPadding * self._domainType[self.options.subDomain].column(d);\n\n    if (arguments.length === 2 && outer === true) {\n      return width += self.domainHorizontalLabelWidth + self.options.domainGutter + self.options.domainMargin[1] + self.options.domainMargin[3];\n    }\n\n    return width;\n  } // Return the height of the domain block, without the domain gutter\n\n\n  function h(d, outer) {\n    var height = self.options.cellSize * self._domainType[self.options.subDomain].row(d) + self.options.cellPadding * self._domainType[self.options.subDomain].row(d);\n\n    if (arguments.length === 2 && outer === true) {\n      height += self.options.domainGutter + self.domainVerticalLabelHeight + self.options.domainMargin[0] + self.options.domainMargin[2];\n    }\n\n    return height;\n  }\n  /**\n   *\n   *\n   * @param int navigationDir\n   */\n\n\n  this.paint = function (navigationDir) {\n    var options = self.options;\n\n    if (arguments.length === 0) {\n      navigationDir = false;\n    } // Painting all the domains\n\n\n    var domainSvg = self.root.select('.graph').selectAll('.graph-domain').data(function () {\n      var data = self.getDomainKeys();\n      return navigationDir === self.NAVIGATE_LEFT ? data.reverse() : data;\n    }, function (d) {\n      return d;\n    });\n    var enteringDomainDim = 0;\n    var exitingDomainDim = 0; // =========================================================================//\n    // PAINTING DOMAIN                              //\n    // =========================================================================//\n\n    var svg = domainSvg.enter().append('svg').attr('width', function (d) {\n      return w(d, true);\n    }).attr('height', function (d) {\n      return h(d, true);\n    }).attr('x', function (d) {\n      if (options.verticalOrientation) {\n        self.graphDim.width = Math.max(self.graphDim.width, w(d, true));\n        return 0;\n      } else {\n        return getDomainPosition(d, self.graphDim, 'width', w(d, true));\n      }\n    }).attr('y', function (d) {\n      if (options.verticalOrientation) {\n        return getDomainPosition(d, self.graphDim, 'height', h(d, true));\n      } else {\n        self.graphDim.height = Math.max(self.graphDim.height, h(d, true));\n        return 0;\n      }\n    }).attr('class', function (d) {\n      var classname = 'graph-domain';\n      var date = new Date(d);\n\n      switch (options.domain) {\n        case 'hour':\n          classname += ' h_' + date.getHours();\n\n        /* falls through */\n\n        case 'day':\n          classname += ' d_' + date.getDate() + ' dy_' + date.getDay();\n\n        /* falls through */\n\n        case 'week':\n          classname += ' w_' + self.getWeekNumber(date);\n\n        /* falls through */\n\n        case 'month':\n          classname += ' m_' + (date.getMonth() + 1);\n\n        /* falls through */\n\n        case 'year':\n          classname += ' y_' + date.getFullYear();\n      }\n\n      return classname;\n    });\n    self.lastInsertedSvg = svg;\n\n    function getDomainPosition(domainIndex, graphDim, axis, domainDim) {\n      var tmp = 0;\n\n      switch (navigationDir) {\n        case false:\n          tmp = graphDim[axis];\n          graphDim[axis] += domainDim;\n          self.domainPosition.setPosition(domainIndex, tmp);\n          return tmp;\n\n        case self.NAVIGATE_RIGHT:\n          self.domainPosition.setPosition(domainIndex, graphDim[axis]);\n          enteringDomainDim = domainDim;\n          exitingDomainDim = self.domainPosition.getPositionFromIndex(1);\n          self.domainPosition.shiftRightBy(exitingDomainDim);\n          return graphDim[axis];\n\n        case self.NAVIGATE_LEFT:\n          tmp = -domainDim;\n          enteringDomainDim = -tmp;\n          exitingDomainDim = graphDim[axis] - self.domainPosition.getLast();\n          self.domainPosition.setPosition(domainIndex, tmp);\n          self.domainPosition.shiftLeftBy(enteringDomainDim);\n          return tmp;\n      }\n    }\n\n    svg.append('rect').attr('width', function (d) {\n      return w(d, true) - options.domainGutter - options.cellPadding;\n    }).attr('height', function (d) {\n      return h(d, true) - options.domainGutter - options.cellPadding;\n    }).attr('class', 'domain-background'); // =========================================================================//\n    // PAINTING SUBDOMAINS                            //\n    // =========================================================================//\n\n    var subDomainSvgGroup = svg.append('svg').attr('x', function () {\n      if (options.label.position === 'left') {\n        return self.domainHorizontalLabelWidth + options.domainMargin[3];\n      } else {\n        return options.domainMargin[3];\n      }\n    }).attr('y', function () {\n      if (options.label.position === 'top') {\n        return self.domainVerticalLabelHeight + options.domainMargin[0];\n      } else {\n        return options.domainMargin[0];\n      }\n    }).attr('class', 'graph-subdomain-group');\n    var rect = subDomainSvgGroup.selectAll('g').data(function (d) {\n      return self._domains.get(d);\n    }).enter().append('g');\n    rect.append('rect').attr('class', function (d) {\n      return 'graph-rect' + self.getHighlightClassName(d.t) + (options.onClick !== null ? ' hover_cursor' : '');\n    }).attr('width', options.cellSize).attr('height', options.cellSize).attr('x', function (d) {\n      return self.positionSubDomainX(d.t);\n    }).attr('y', function (d) {\n      return self.positionSubDomainY(d.t);\n    }).on('click', function (d) {\n      if (options.onClick !== null) {\n        return self.onClick(new Date(d.t), d.v);\n      }\n    }).call(function (selection) {\n      if (options.cellRadius > 0) {\n        selection.attr('rx', options.cellRadius).attr('ry', options.cellRadius);\n      }\n\n      if (self.legendScale !== null && options.legendColors !== null && options.legendColors.hasOwnProperty('base')) {\n        selection.attr('fill', options.legendColors.base);\n      }\n\n      if (options.tooltip) {\n        selection.on('mouseover', function (d) {\n          self.tip.show(d, this);\n        }).on('mouseout', function () {\n          self.tip.hide(d);\n        });\n      }\n    }); // Appending a title to each subdomain\n\n    if (!options.tooltip) {\n      rect.append('title').text(function (d) {\n        return self.formatDate(new Date(d.t), options.subDomainDateFormat);\n      });\n    } // =========================================================================//\n    // PAINTING LABEL                              //\n    // =========================================================================//\n\n\n    if (options.domainLabelFormat !== '') {\n      svg.append('text').attr('class', 'graph-label').attr('y', function (d) {\n        var y = options.domainMargin[0];\n\n        switch (options.label.position) {\n          case 'top':\n            y += self.domainVerticalLabelHeight / 2;\n            break;\n\n          case 'bottom':\n            y += h(d) + self.domainVerticalLabelHeight / 2;\n        }\n\n        return y + options.label.offset.y * (options.label.rotate === 'right' && options.label.position === 'right' || options.label.rotate === 'left' && options.label.position === 'left' ? -1 : 1);\n      }).attr('x', function (d) {\n        var x = options.domainMargin[3];\n\n        switch (options.label.position) {\n          case 'right':\n            x += w(d);\n            break;\n\n          case 'bottom':\n          case 'top':\n            x += w(d) / 2;\n        }\n\n        if (options.label.align === 'right') {\n          return x + self.domainHorizontalLabelWidth - options.label.offset.x * (options.label.rotate === 'right' ? -1 : 1);\n        }\n\n        return x + options.label.offset.x;\n      }).attr('text-anchor', function () {\n        switch (options.label.align) {\n          case 'start':\n          case 'left':\n            return 'start';\n\n          case 'end':\n          case 'right':\n            return 'end';\n\n          default:\n            return 'middle';\n        }\n      }).attr('dominant-baseline', function () {\n        return self.verticalDomainLabel ? 'middle' : 'top';\n      }).text(function (d) {\n        return self.formatDate(new Date(d), options.domainLabelFormat);\n      }).call(domainRotate);\n    }\n\n    function domainRotate(selection) {\n      switch (options.label.rotate) {\n        case 'right':\n          selection.attr('transform', function (d) {\n            var s = 'rotate(90), ';\n\n            switch (options.label.position) {\n              case 'right':\n                s += 'translate(-' + w(d) + ' , -' + w(d) + ')';\n                break;\n\n              case 'left':\n                s += 'translate(0, -' + self.domainHorizontalLabelWidth + ')';\n                break;\n            }\n\n            return s;\n          });\n          break;\n\n        case 'left':\n          selection.attr('transform', function (d) {\n            var s = 'rotate(270), ';\n\n            switch (options.label.position) {\n              case 'right':\n                s += 'translate(-' + (w(d) + self.domainHorizontalLabelWidth) + ' , ' + w(d) + ')';\n                break;\n\n              case 'left':\n                s += 'translate(-' + self.domainHorizontalLabelWidth + ' , ' + self.domainHorizontalLabelWidth + ')';\n                break;\n            }\n\n            return s;\n          });\n          break;\n      }\n    } // =========================================================================//\n    // PAINTING DOMAIN SUBDOMAIN CONTENT                    //\n    // =========================================================================//\n\n\n    if (options.subDomainTextFormat !== null) {\n      rect.append('text').attr('class', function (d) {\n        return 'subdomain-text' + self.getHighlightClassName(d.t);\n      }).attr('x', function (d) {\n        return self.positionSubDomainX(d.t) + options.cellSize / 2;\n      }).attr('y', function (d) {\n        return self.positionSubDomainY(d.t) + options.cellSize / 2;\n      }).attr('text-anchor', 'middle').attr('dominant-baseline', 'central').text(function (d) {\n        return self.formatDate(new Date(d.t), options.subDomainTextFormat);\n      });\n    } // =========================================================================//\n    // ANIMATION                                //\n    // =========================================================================//\n\n\n    if (navigationDir !== false) {\n      domainSvg.transition().duration(options.animationDuration).attr('x', function (d) {\n        return options.verticalOrientation ? 0 : self.domainPosition.getPosition(d);\n      }).attr('y', function (d) {\n        return options.verticalOrientation ? self.domainPosition.getPosition(d) : 0;\n      });\n    }\n\n    var tempWidth = self.graphDim.width;\n    var tempHeight = self.graphDim.height;\n\n    if (options.verticalOrientation) {\n      self.graphDim.height += enteringDomainDim - exitingDomainDim;\n    } else {\n      self.graphDim.width += enteringDomainDim - exitingDomainDim;\n    } // At the time of exit, domainsWidth and domainsHeight already automatically shifted\n\n\n    domainSvg.exit().transition().duration(options.animationDuration).attr('x', function (d) {\n      if (options.verticalOrientation) {\n        return 0;\n      } else {\n        switch (navigationDir) {\n          case self.NAVIGATE_LEFT:\n            return Math.min(self.graphDim.width, tempWidth);\n\n          case self.NAVIGATE_RIGHT:\n            return -w(d, true);\n        }\n      }\n    }).attr('y', function (d) {\n      if (options.verticalOrientation) {\n        switch (navigationDir) {\n          case self.NAVIGATE_LEFT:\n            return Math.min(self.graphDim.height, tempHeight);\n\n          case self.NAVIGATE_RIGHT:\n            return -h(d, true);\n        }\n      } else {\n        return 0;\n      }\n    }).remove(); // Resize the root container\n\n    self.resize();\n  };\n};\n\nCalHeatMap.prototype = {\n  /**\n   * Validate and merge user settings with default settings\n   *\n   * @param  {object} settings User settings\n   * @return {bool} False if settings contains error\n   */\n\n  /* jshint maxstatements:false */\n  init: function (settings) {\n    'use strict';\n\n    var parent = this;\n    var options = parent.options = mergeRecursive(parent.options, settings); // Fatal errors\n    // Stop script execution on error\n\n    validateDomainType();\n    validateSelector(options.itemSelector, false, 'itemSelector');\n\n    if (parent.allowedDataType.indexOf(options.dataType) === -1) {\n      throw new Error(\"The data type '\" + options.dataType + \"' is not valid data type\");\n    }\n\n    if (d3.select(options.itemSelector)[0][0] === null) {\n      throw new Error(\"The node '\" + options.itemSelector + \"' specified in itemSelector does not exists\");\n    }\n\n    try {\n      validateSelector(options.nextSelector, true, 'nextSelector');\n      validateSelector(options.previousSelector, true, 'previousSelector');\n    } catch (error) {\n      console.log(error.message);\n      return false;\n    } // If other settings contains error, will fallback to default\n\n\n    if (!settings.hasOwnProperty('subDomain')) {\n      this.options.subDomain = getOptimalSubDomain(settings.domain);\n    }\n\n    if (typeof options.itemNamespace !== 'string' || options.itemNamespace === '') {\n      console.log('itemNamespace can not be empty, falling back to cal-heatmap');\n      options.itemNamespace = 'cal-heatmap';\n    } // Don't touch these settings\n\n\n    var s = ['data', 'onComplete', 'onClick', 'afterLoad', 'afterLoadData', 'afterLoadPreviousDomain', 'afterLoadNextDomain', 'afterUpdate'];\n\n    for (var k in s) {\n      if (settings.hasOwnProperty(s[k])) {\n        options[s[k]] = settings[s[k]];\n      }\n    }\n\n    options.subDomainDateFormat = typeof options.subDomainDateFormat === 'string' || typeof options.subDomainDateFormat === 'function' ? options.subDomainDateFormat : this._domainType[options.subDomain].format.date;\n    options.domainLabelFormat = typeof options.domainLabelFormat === 'string' || typeof options.domainLabelFormat === 'function' ? options.domainLabelFormat : this._domainType[options.domain].format.legend;\n    options.subDomainTextFormat = typeof options.subDomainTextFormat === 'string' && options.subDomainTextFormat !== '' || typeof options.subDomainTextFormat === 'function' ? options.subDomainTextFormat : null;\n    options.domainMargin = expandMarginSetting(options.domainMargin);\n    options.legendMargin = expandMarginSetting(options.legendMargin);\n    options.highlight = parent.expandDateSetting(options.highlight);\n    options.itemName = expandItemName(options.itemName);\n    options.colLimit = parseColLimit(options.colLimit);\n    options.rowLimit = parseRowLimit(options.rowLimit);\n\n    if (!settings.hasOwnProperty('legendMargin')) {\n      autoAddLegendMargin();\n    }\n\n    autoAlignLabel();\n    /**\n     * Validate that a queryString is valid\n     *\n     * @param  {Element|string|bool} selector   The queryString to test\n     * @param  {bool}  canBeFalse  Whether false is an accepted and valid value\n     * @param  {string} name    Name of the tested selector\n     * @throws {Error}        If the selector is not valid\n     * @return {bool}        True if the selector is a valid queryString\n     */\n\n    function validateSelector(selector, canBeFalse, name) {\n      if ((canBeFalse && selector === false || selector instanceof Element || typeof selector === 'string') && selector !== '') {\n        return true;\n      }\n\n      throw new Error('The ' + name + ' is not valid');\n    }\n    /**\n     * Return the optimal subDomain for the specified domain\n     *\n     * @param  {string} domain a domain name\n     * @return {string}        the subDomain name\n     */\n\n\n    function getOptimalSubDomain(domain) {\n      switch (domain) {\n        case 'year':\n          return 'month';\n\n        case 'month':\n          return 'day';\n\n        case 'week':\n          return 'day';\n\n        case 'day':\n          return 'hour';\n\n        default:\n          return 'min';\n      }\n    }\n    /**\n     * Ensure that the domain and subdomain are valid\n     *\n     * @throw {Error} when domain or subdomain are not valid\n     * @return {bool} True if domain and subdomain are valid and compatible\n     */\n\n\n    function validateDomainType() {\n      if (!parent._domainType.hasOwnProperty(options.domain) || options.domain === 'min' || options.domain.substring(0, 2) === 'x_') {\n        throw new Error(\"The domain '\" + options.domain + \"' is not valid\");\n      }\n\n      if (!parent._domainType.hasOwnProperty(options.subDomain) || options.subDomain === 'year') {\n        throw new Error(\"The subDomain '\" + options.subDomain + \"' is not valid\");\n      }\n\n      if (parent._domainType[options.domain].level <= parent._domainType[options.subDomain].level) {\n        throw new Error(\"'\" + options.subDomain + \"' is not a valid subDomain to '\" + options.domain + \"'\");\n      }\n\n      return true;\n    }\n    /**\n     * Fine-tune the label alignement depending on its position\n     *\n     * @return void\n     */\n\n\n    function autoAlignLabel() {\n      // Auto-align label, depending on it's position\n      if (!settings.hasOwnProperty('label') || settings.hasOwnProperty('label') && !settings.label.hasOwnProperty('align')) {\n        switch (options.label.position) {\n          case 'left':\n            options.label.align = 'right';\n            break;\n\n          case 'right':\n            options.label.align = 'left';\n            break;\n\n          default:\n            options.label.align = 'center';\n        }\n\n        if (options.label.rotate === 'left') {\n          options.label.align = 'right';\n        } else if (options.label.rotate === 'right') {\n          options.label.align = 'left';\n        }\n      }\n\n      if (!settings.hasOwnProperty('label') || settings.hasOwnProperty('label') && !settings.label.hasOwnProperty('offset')) {\n        if (options.label.position === 'left' || options.label.position === 'right') {\n          options.label.offset = {\n            x: 10,\n            y: 15\n          };\n        }\n      }\n    }\n    /**\n     * If not specified, add some margin around the legend depending on its position\n     *\n     * @return void\n     */\n\n\n    function autoAddLegendMargin() {\n      switch (options.legendVerticalPosition) {\n        case 'top':\n          options.legendMargin[2] = parent.DEFAULT_LEGEND_MARGIN;\n          break;\n\n        case 'bottom':\n          options.legendMargin[0] = parent.DEFAULT_LEGEND_MARGIN;\n          break;\n\n        case 'middle':\n        case 'center':\n          options.legendMargin[options.legendHorizontalPosition === 'right' ? 3 : 1] = parent.DEFAULT_LEGEND_MARGIN;\n      }\n    }\n    /**\n     * Expand a number of an array of numbers to an usable 4 values array\n     *\n     * @param  {integer|array} value\n     * @return {array}        array\n     */\n\n\n    function expandMarginSetting(value) {\n      if (typeof value === 'number') {\n        value = [value];\n      }\n\n      if (!Array.isArray(value)) {\n        console.log('Margin only takes an integer or an array of integers');\n        value = [0];\n      }\n\n      switch (value.length) {\n        case 1:\n          return [value[0], value[0], value[0], value[0]];\n\n        case 2:\n          return [value[0], value[1], value[0], value[1]];\n\n        case 3:\n          return [value[0], value[1], value[2], value[1]];\n\n        case 4:\n          return value;\n\n        default:\n          return value.slice(0, 4);\n      }\n    }\n    /**\n     * Convert a string to an array like [singular-form, plural-form]\n     *\n     * @param  {string|array} value Date to convert\n     * @return {array}       An array like [singular-form, plural-form]\n     */\n\n\n    function expandItemName(value) {\n      if (typeof value === 'string') {\n        return [value, value + (value !== '' ? 's' : '')];\n      }\n\n      if (Array.isArray(value)) {\n        if (value.length === 1) {\n          return [value[0], value[0] + 's'];\n        } else if (value.length > 2) {\n          return value.slice(0, 2);\n        }\n\n        return value;\n      }\n\n      return ['item', 'items'];\n    }\n\n    function parseColLimit(value) {\n      return value > 0 ? value : null;\n    }\n\n    function parseRowLimit(value) {\n      if (value > 0 && options.colLimit > 0) {\n        console.log('colLimit and rowLimit are mutually exclusive, rowLimit will be ignored');\n        return null;\n      }\n\n      return value > 0 ? value : null;\n    }\n\n    return this._init();\n  },\n\n  /**\n   * Convert a keyword or an array of keyword/date to an array of date objects\n   *\n   * @param  {string|array|Date} value Data to convert\n   * @return {array}       An array of Dates\n   */\n  expandDateSetting: function (value) {\n    'use strict';\n\n    if (!Array.isArray(value)) {\n      value = [value];\n    }\n\n    return value.map(function (data) {\n      if (data === 'now') {\n        return new Date();\n      }\n\n      if (data instanceof Date) {\n        return data;\n      }\n\n      return false;\n    }).filter(function (d) {\n      return d !== false;\n    });\n  },\n\n  /**\n   * Fill the calendar by coloring the cells\n   *\n   * @param array svg An array of html node to apply the transformation to (optional)\n   *                  It's used to limit the painting to only a subset of the calendar\n   * @return void\n   */\n  fill: function (svg) {\n    'use strict';\n\n    var parent = this;\n    var options = parent.options;\n\n    if (arguments.length === 0) {\n      svg = parent.root.selectAll('.graph-domain');\n    }\n\n    var rect = svg.selectAll('svg').selectAll('g').data(function (d) {\n      return parent._domains.get(d);\n    });\n    /**\n     * Colorize the cell via a style attribute if enabled\n     */\n\n    function addStyle(element) {\n      if (parent.legendScale === null) {\n        return false;\n      }\n\n      element.attr('fill', function (d) {\n        if (d.v === null && options.hasOwnProperty('considerMissingDataAsZero') && !options.considerMissingDataAsZero) {\n          if (options.legendColors.hasOwnProperty('base')) {\n            return options.legendColors.base;\n          }\n        }\n\n        if (options.legendColors !== null && options.legendColors.hasOwnProperty('empty') && (d.v === 0 || d.v === null && options.hasOwnProperty('considerMissingDataAsZero') && options.considerMissingDataAsZero)) {\n          return options.legendColors.empty;\n        }\n\n        if (d.v < 0 && options.legend[0] > 0 && options.legendColors !== null && options.legendColors.hasOwnProperty('overflow')) {\n          return options.legendColors.overflow;\n        }\n\n        return parent.legendScale(Math.min(d.v, options.legend[options.legend.length - 1]));\n      });\n    }\n\n    rect.transition().duration(options.animationDuration).select('rect').attr('class', function (d) {\n      var htmlClass = parent.getHighlightClassName(d.t).trim().split(' ');\n      var pastDate = parent.dateIsLessThan(d.t, new Date());\n      var sameDate = parent.dateIsEqual(d.t, new Date());\n\n      if (parent.legendScale === null || d.v === null && options.hasOwnProperty('considerMissingDataAsZero') && !options.considerMissingDataAsZero && !options.legendColors.hasOwnProperty('base')) {\n        htmlClass.push('graph-rect');\n      }\n\n      if (sameDate) {\n        htmlClass.push('now');\n      } else if (!pastDate) {\n        htmlClass.push('future');\n      }\n\n      if (d.v !== null) {\n        htmlClass.push(parent.Legend.getClass(d.v, parent.legendScale === null));\n      } else if (options.considerMissingDataAsZero && pastDate) {\n        htmlClass.push(parent.Legend.getClass(0, parent.legendScale === null));\n      }\n\n      if (options.onClick !== null) {\n        htmlClass.push('hover_cursor');\n      }\n\n      return htmlClass.join(' ');\n    }).call(addStyle);\n    rect.transition().duration(options.animationDuration).select('title').text(function (d) {\n      return parent.getSubDomainTitle(d);\n    });\n\n    function formatSubDomainText(element) {\n      if (typeof options.subDomainTextFormat === 'function') {\n        element.text(function (d) {\n          return options.subDomainTextFormat(d.t, d.v);\n        });\n      }\n    }\n    /**\n     * Change the subDomainText class if necessary\n     * Also change the text, e.g when text is representing the value\n     * instead of the date\n     */\n\n\n    rect.transition().duration(options.animationDuration).select('text').attr('class', function (d) {\n      return 'subdomain-text' + parent.getHighlightClassName(d.t);\n    }).call(formatSubDomainText);\n  },\n\n  /**\n   * Sprintf like function.\n   * Replaces placeholders {0} in string with values from provided object.\n   *\n   * @param string formatted String containing placeholders.\n   * @param object args Object with properties to replace placeholders in string.\n   *\n   * @return String\n   */\n  formatStringWithObject: function (formatted, args) {\n    'use strict';\n\n    for (var prop in args) {\n      if (args.hasOwnProperty(prop)) {\n        var regexp = new RegExp('\\\\{' + prop + '\\\\}', 'gi');\n        formatted = formatted.replace(regexp, args[prop]);\n      }\n    }\n\n    return formatted;\n  },\n  // =========================================================================//\n  // EVENTS CALLBACK                              //\n  // =========================================================================//\n\n  /**\n   * Helper method for triggering event callback\n   *\n   * @param  string  eventName       Name of the event to trigger\n   * @param  array  successArgs     List of argument to pass to the callback\n   * @param  boolean  skip      Whether to skip the event triggering\n   * @return mixed  True when the triggering was skipped, false on error, else the callback function\n   */\n  triggerEvent: function (eventName, successArgs, skip) {\n    'use strict';\n\n    if (arguments.length === 3 && skip || this.options[eventName] === null) {\n      return true;\n    }\n\n    if (typeof this.options[eventName] === 'function') {\n      if (typeof successArgs === 'function') {\n        successArgs = successArgs();\n      }\n\n      return this.options[eventName].apply(this, successArgs);\n    } else {\n      console.log('Provided callback for ' + eventName + ' is not a function.');\n      return false;\n    }\n  },\n\n  /**\n   * Event triggered on a mouse click on a subDomain cell\n   *\n   * @param  Date    d    Date of the subdomain block\n   * @param  int    itemNb  Number of items in that date\n   */\n  onClick: function (d, itemNb) {\n    'use strict';\n\n    return this.triggerEvent('onClick', [d, itemNb]);\n  },\n\n  /**\n   * Event triggered after drawing the calendar, byt before filling it with data\n   */\n  afterLoad: function () {\n    'use strict';\n\n    return this.triggerEvent('afterLoad');\n  },\n\n  /**\n   * Event triggered after completing drawing and filling the calendar\n   */\n  onComplete: function () {\n    'use strict';\n\n    var response = this.triggerEvent('onComplete', [], this._completed);\n    this._completed = true;\n    return response;\n  },\n\n  /**\n   * Event triggered after shifting the calendar one domain back\n   *\n   * @param  Date    start  Domain start date\n   * @param  Date    end    Domain end date\n   */\n  afterLoadPreviousDomain: function (start) {\n    'use strict';\n\n    var parent = this;\n    return this.triggerEvent('afterLoadPreviousDomain', function () {\n      var subDomain = parent.getSubDomain(start);\n      return [subDomain.shift(), subDomain.pop()];\n    });\n  },\n\n  /**\n   * Event triggered after shifting the calendar one domain above\n   *\n   * @param  Date    start  Domain start date\n   * @param  Date    end    Domain end date\n   */\n  afterLoadNextDomain: function (start) {\n    'use strict';\n\n    var parent = this;\n    return this.triggerEvent('afterLoadNextDomain', function () {\n      var subDomain = parent.getSubDomain(start);\n      return [subDomain.shift(), subDomain.pop()];\n    });\n  },\n\n  /**\n   * Event triggered after loading the leftmost domain allowed by minDate\n   *\n   * @param  boolean  reached True if the leftmost domain was reached\n   */\n  onMinDomainReached: function (reached) {\n    'use strict';\n\n    this._minDomainReached = reached;\n    return this.triggerEvent('onMinDomainReached', [reached]);\n  },\n\n  /**\n   * Event triggered after loading the rightmost domain allowed by maxDate\n   *\n   * @param  boolean  reached True if the rightmost domain was reached\n   */\n  onMaxDomainReached: function (reached) {\n    'use strict';\n\n    this._maxDomainReached = reached;\n    return this.triggerEvent('onMaxDomainReached', [reached]);\n  },\n  checkIfMinDomainIsReached: function (date, upperBound) {\n    'use strict';\n\n    if (this.minDomainIsReached(date)) {\n      this.onMinDomainReached(true);\n    }\n\n    if (arguments.length === 2) {\n      if (this._maxDomainReached && !this.maxDomainIsReached(upperBound)) {\n        this.onMaxDomainReached(false);\n      }\n    }\n  },\n  checkIfMaxDomainIsReached: function (date, lowerBound) {\n    'use strict';\n\n    if (this.maxDomainIsReached(date)) {\n      this.onMaxDomainReached(true);\n    }\n\n    if (arguments.length === 2) {\n      if (this._minDomainReached && !this.minDomainIsReached(lowerBound)) {\n        this.onMinDomainReached(false);\n      }\n    }\n  },\n  afterUpdate: function () {\n    'use strict';\n\n    return this.triggerEvent('afterUpdate');\n  },\n  // =========================================================================//\n  // FORMATTER                                //\n  // =========================================================================//\n  formatNumber: d3.format(',g'),\n  formatDate: function (d, format) {\n    'use strict';\n\n    if (arguments.length < 2) {\n      format = 'title';\n    }\n\n    if (typeof format === 'function') {\n      return format(d);\n    } else {\n      var f = d3.time.format(format);\n      return f(d);\n    }\n  },\n  getSubDomainTitle: function (d) {\n    'use strict';\n\n    if (d.v === null && !this.options.considerMissingDataAsZero) {\n      return this.formatStringWithObject(this.options.subDomainTitleFormat.empty, {\n        date: this.formatDate(new Date(d.t), this.options.subDomainDateFormat)\n      });\n    } else {\n      var value = d.v; // Consider null as 0\n\n      if (value === null && this.options.considerMissingDataAsZero) {\n        value = 0;\n      }\n\n      return this.formatStringWithObject(this.options.subDomainTitleFormat.filled, {\n        count: this.formatNumber(value),\n        name: this.options.itemName[value !== 1 ? 1 : 0],\n        connector: this._domainType[this.options.subDomain].format.connector,\n        date: this.formatDate(new Date(d.t), this.options.subDomainDateFormat)\n      });\n    }\n  },\n  // =========================================================================//\n  // DOMAIN NAVIGATION                            //\n  // =========================================================================//\n\n  /**\n   * Shift the calendar one domain forward\n   *\n   * The new domain is loaded only if it's not beyond maxDate\n   *\n   * @param int n Number of domains to load\n   * @return bool True if the next domain was loaded, else false\n   */\n  loadNextDomain: function (n) {\n    'use strict';\n\n    if (this._maxDomainReached || n === 0) {\n      return false;\n    }\n\n    var bound = this.loadNewDomains(this.NAVIGATE_RIGHT, this.getDomain(this.getNextDomain(), n));\n    this.afterLoadNextDomain(bound.end);\n    this.checkIfMaxDomainIsReached(this.getNextDomain().getTime(), bound.start);\n    return true;\n  },\n\n  /**\n   * Shift the calendar one domain backward\n   *\n   * The previous domain is loaded only if it's not beyond the minDate\n   *\n   * @param int n Number of domains to load\n   * @return bool True if the previous domain was loaded, else false\n   */\n  loadPreviousDomain: function (n) {\n    'use strict';\n\n    if (this._minDomainReached || n === 0) {\n      return false;\n    }\n\n    var bound = this.loadNewDomains(this.NAVIGATE_LEFT, this.getDomain(this.getDomainKeys()[0], -n).reverse());\n    this.afterLoadPreviousDomain(bound.start);\n    this.checkIfMinDomainIsReached(bound.start, bound.end);\n    return true;\n  },\n  loadNewDomains: function (direction, newDomains) {\n    'use strict';\n\n    var parent = this;\n    var backward = direction === this.NAVIGATE_LEFT;\n    var i = -1;\n    var total = newDomains.length;\n    var domains = this.getDomainKeys();\n\n    function buildSubDomain(d) {\n      return {\n        t: parent._domainType[parent.options.subDomain].extractUnit(d),\n        v: null\n      };\n    } // Remove out of bound domains from list of new domains to prepend\n\n\n    while (++i < total) {\n      if (backward && this.minDomainIsReached(newDomains[i])) {\n        newDomains = newDomains.slice(0, i + 1);\n        break;\n      }\n\n      if (!backward && this.maxDomainIsReached(newDomains[i])) {\n        newDomains = newDomains.slice(0, i);\n        break;\n      }\n    }\n\n    newDomains = newDomains.slice(-this.options.range);\n\n    for (i = 0, total = newDomains.length; i < total; i += 1) {\n      this._domains.set(newDomains[i].getTime(), this.getSubDomain(newDomains[i]).map(buildSubDomain));\n\n      this._domains.remove(backward ? domains.pop() : domains.shift());\n    }\n\n    domains = this.getDomainKeys();\n\n    if (backward) {\n      newDomains = newDomains.reverse();\n    }\n\n    this.paint(direction);\n    this.getDatas(this.options.data, newDomains[0], this.getSubDomain(newDomains[newDomains.length - 1]).pop(), function () {\n      parent.fill(parent.lastInsertedSvg);\n    });\n    return {\n      start: newDomains[backward ? 0 : 1],\n      end: domains[domains.length - 1]\n    };\n  },\n\n  /**\n   * Return whether a date is inside the scope determined by maxDate\n   *\n   * @param int datetimestamp The timestamp in ms to test\n   * @return bool True if the specified date correspond to the calendar upper bound\n   */\n  maxDomainIsReached: function (datetimestamp) {\n    'use strict';\n\n    return this.options.maxDate !== null && this.options.maxDate.getTime() < datetimestamp;\n  },\n\n  /**\n   * Return whether a date is inside the scope determined by minDate\n   *\n   * @param int datetimestamp The timestamp in ms to test\n   * @return bool True if the specified date correspond to the calendar lower bound\n   */\n  minDomainIsReached: function (datetimestamp) {\n    'use strict';\n\n    return this.options.minDate !== null && this.options.minDate.getTime() >= datetimestamp;\n  },\n\n  /**\n   * Return the list of the calendar's domain timestamp\n   *\n   * @return Array a sorted array of timestamp\n   */\n  getDomainKeys: function () {\n    'use strict';\n\n    return this._domains.keys().map(function (d) {\n      return parseInt(d, 10);\n    }).sort(function (a, b) {\n      return a - b;\n    });\n  },\n  // =========================================================================//\n  // POSITIONNING                                //\n  // =========================================================================//\n  positionSubDomainX: function (d) {\n    'use strict';\n\n    var index = this._domainType[this.options.subDomain].position.x(new Date(d));\n\n    return index * this.options.cellSize + index * this.options.cellPadding;\n  },\n  positionSubDomainY: function (d) {\n    'use strict';\n\n    var index = this._domainType[this.options.subDomain].position.y(new Date(d));\n\n    return index * this.options.cellSize + index * this.options.cellPadding;\n  },\n  getSubDomainColumnNumber: function (d) {\n    'use strict';\n\n    if (this.options.rowLimit > 0) {\n      var i = this._domainType[this.options.subDomain].maxItemNumber;\n\n      if (typeof i === 'function') {\n        i = i(d);\n      }\n\n      return Math.ceil(i / this.options.rowLimit);\n    }\n\n    var j = this._domainType[this.options.subDomain].defaultColumnNumber;\n\n    if (typeof j === 'function') {\n      j = j(d);\n    }\n\n    return this.options.colLimit || j;\n  },\n  getSubDomainRowNumber: function (d) {\n    'use strict';\n\n    if (this.options.colLimit > 0) {\n      var i = this._domainType[this.options.subDomain].maxItemNumber;\n\n      if (typeof i === 'function') {\n        i = i(d);\n      }\n\n      return Math.ceil(i / this.options.colLimit);\n    }\n\n    var j = this._domainType[this.options.subDomain].defaultRowNumber;\n\n    if (typeof j === 'function') {\n      j = j(d);\n    }\n\n    return this.options.rowLimit || j;\n  },\n\n  /**\n   * Return a classname if the specified date should be highlighted\n   *\n   * @param  timestamp date Date of the current subDomain\n   * @return String the highlight class\n   */\n  getHighlightClassName: function (d) {\n    'use strict';\n\n    d = new Date(d);\n\n    if (this.options.highlight.length > 0) {\n      for (var i in this.options.highlight) {\n        if (this.dateIsEqual(this.options.highlight[i], d)) {\n          return this.isNow(this.options.highlight[i]) ? ' highlight-now' : ' highlight';\n        }\n      }\n    }\n\n    return '';\n  },\n\n  /**\n   * Return whether the specified date is now,\n   * according to the type of subdomain\n   *\n   * @param  Date d The date to compare\n   * @return bool True if the date correspond to a subdomain cell\n   */\n  isNow: function (d) {\n    'use strict';\n\n    return this.dateIsEqual(d, new Date());\n  },\n\n  /**\n   * Return whether 2 dates are equals\n   * This function is subdomain-aware,\n   * and dates comparison are dependent of the subdomain\n   *\n   * @param  Date dateA First date to compare\n   * @param  Date dateB Secon date to compare\n   * @return bool true if the 2 dates are equals\n   */\n\n  /* jshint maxcomplexity: false */\n  dateIsEqual: function (dateA, dateB) {\n    'use strict';\n\n    if (!(dateA instanceof Date)) {\n      dateA = new Date(dateA);\n    }\n\n    if (!(dateB instanceof Date)) {\n      dateB = new Date(dateB);\n    }\n\n    switch (this.options.subDomain) {\n      case 'x_min':\n      case 'min':\n        return dateA.getFullYear() === dateB.getFullYear() && dateA.getMonth() === dateB.getMonth() && dateA.getDate() === dateB.getDate() && dateA.getHours() === dateB.getHours() && dateA.getMinutes() === dateB.getMinutes();\n\n      case 'x_hour':\n      case 'hour':\n        return dateA.getFullYear() === dateB.getFullYear() && dateA.getMonth() === dateB.getMonth() && dateA.getDate() === dateB.getDate() && dateA.getHours() === dateB.getHours();\n\n      case 'x_day':\n      case 'day':\n        return dateA.getFullYear() === dateB.getFullYear() && dateA.getMonth() === dateB.getMonth() && dateA.getDate() === dateB.getDate();\n\n      case 'x_week':\n      case 'week':\n        return dateA.getFullYear() === dateB.getFullYear() && this.getWeekNumber(dateA) === this.getWeekNumber(dateB);\n\n      case 'x_month':\n      case 'month':\n        return dateA.getFullYear() === dateB.getFullYear() && dateA.getMonth() === dateB.getMonth();\n\n      default:\n        return false;\n    }\n  },\n\n  /**\n   * Returns wether or not dateA is less than or equal to dateB. This function is subdomain aware.\n   * Performs automatic conversion of values.\n   * @param dateA may be a number or a Date\n   * @param dateB may be a number or a Date\n   * @returns {boolean}\n   */\n  dateIsLessThan: function (dateA, dateB) {\n    'use strict';\n\n    if (!(dateA instanceof Date)) {\n      dateA = new Date(dateA);\n    }\n\n    if (!(dateB instanceof Date)) {\n      dateB = new Date(dateB);\n    }\n\n    function normalizedMillis(date, subdomain) {\n      switch (subdomain) {\n        case 'x_min':\n        case 'min':\n          return new Date(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes()).getTime();\n\n        case 'x_hour':\n        case 'hour':\n          return new Date(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours()).getTime();\n\n        case 'x_day':\n        case 'day':\n          return new Date(date.getFullYear(), date.getMonth(), date.getDate()).getTime();\n\n        case 'x_week':\n        case 'week':\n        case 'x_month':\n        case 'month':\n          return new Date(date.getFullYear(), date.getMonth()).getTime();\n\n        default:\n          return date.getTime();\n      }\n    }\n\n    return normalizedMillis(dateA, this.options.subDomain) < normalizedMillis(dateB, this.options.subDomain);\n  },\n  // =========================================================================//\n  // DATE COMPUTATION                              //\n  // =========================================================================//\n\n  /**\n   * Return the day of the year for the date\n   * @param  Date\n   * @return  int Day of the year [1,366]\n   */\n  getDayOfYear: d3.time.format('%j'),\n\n  /**\n   * Return the week number of the year\n   * Monday as the first day of the week\n   * @return int  Week number [0-53]\n   */\n  getWeekNumber: function (d) {\n    'use strict';\n\n    var f = this.options.weekStartOnMonday === true ? d3.time.format('%W') : d3.time.format('%U');\n    return f(d);\n  },\n\n  /**\n   * Return the week number, relative to its month\n   *\n   * @param  int|Date d Date or timestamp in milliseconds\n   * @return int Week number, relative to the month [0-5]\n   */\n  getMonthWeekNumber: function (d) {\n    'use strict';\n\n    if (typeof d === 'number') {\n      d = new Date(d);\n    }\n\n    var monthFirstWeekNumber = this.getWeekNumber(new Date(d.getFullYear(), d.getMonth()));\n    return this.getWeekNumber(d) - monthFirstWeekNumber - 1;\n  },\n\n  /**\n   * Return the number of weeks in the dates' year\n   *\n   * @param  int|Date d Date or timestamp in milliseconds\n   * @return int Number of weeks in the date's year\n   */\n  getWeekNumberInYear: function (d) {\n    'use strict';\n\n    if (typeof d === 'number') {\n      d = new Date(d);\n    }\n  },\n\n  /**\n   * Return the number of days in the date's month\n   *\n   * @param  int|Date d Date or timestamp in milliseconds\n   * @return int Number of days in the date's month\n   */\n  getDayCountInMonth: function (d) {\n    'use strict';\n\n    return this.getEndOfMonth(d).getDate();\n  },\n\n  /**\n   * Return the number of days in the date's year\n   *\n   * @param  int|Date d Date or timestamp in milliseconds\n   * @return int Number of days in the date's year\n   */\n  getDayCountInYear: function (d) {\n    'use strict';\n\n    if (typeof d === 'number') {\n      d = new Date(d);\n    }\n\n    return new Date(d.getFullYear(), 1, 29).getMonth() === 1 ? 366 : 365;\n  },\n\n  /**\n   * Get the weekday from a date\n   *\n   * Return the week day number (0-6) of a date,\n   * depending on whether the week start on monday or sunday\n   *\n   * @param  Date d\n   * @return int The week day number (0-6)\n   */\n  getWeekDay: function (d) {\n    'use strict';\n\n    if (this.options.weekStartOnMonday === false) {\n      return d.getDay();\n    }\n\n    return d.getDay() === 0 ? 6 : d.getDay() - 1;\n  },\n\n  /**\n   * Get the last day of the month\n   * @param  Date|int  d  Date or timestamp in milliseconds\n   * @return Date      Last day of the month\n   */\n  getEndOfMonth: function (d) {\n    'use strict';\n\n    if (typeof d === 'number') {\n      d = new Date(d);\n    }\n\n    return new Date(d.getFullYear(), d.getMonth() + 1, 0);\n  },\n\n  /**\n   *\n   * @param  Date date\n   * @param  int count\n   * @param  string step\n   * @return Date\n   */\n  jumpDate: function (date, count, step) {\n    'use strict';\n\n    var d = new Date(date);\n\n    switch (step) {\n      case 'hour':\n        d.setHours(d.getHours() + count);\n        break;\n\n      case 'day':\n        d.setHours(d.getHours() + count * 24);\n        break;\n\n      case 'week':\n        d.setHours(d.getHours() + count * 24 * 7);\n        break;\n\n      case 'month':\n        d.setMonth(d.getMonth() + count);\n        break;\n\n      case 'year':\n        d.setFullYear(d.getFullYear() + count);\n    }\n\n    return new Date(d);\n  },\n  // =========================================================================//\n  // DOMAIN COMPUTATION                            //\n  // =========================================================================//\n\n  /**\n   * Return all the minutes between 2 dates\n   *\n   * @param  Date  d  date  A date\n   * @param  int|date  range  Number of minutes in the range, or a stop date\n   * @return array  An array of minutes\n   */\n  getMinuteDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(d.getFullYear(), d.getMonth(), d.getDate(), d.getHours());\n    var stop = null;\n\n    if (range instanceof Date) {\n      stop = new Date(range.getFullYear(), range.getMonth(), range.getDate(), range.getHours());\n    } else {\n      stop = new Date(+start + range * 1000 * 60);\n    }\n\n    return d3.time.minutes(Math.min(start, stop), Math.max(start, stop));\n  },\n\n  /**\n   * Return all the hours between 2 dates\n   *\n   * @param  Date  d  A date\n   * @param  int|date  range  Number of hours in the range, or a stop date\n   * @return array  An array of hours\n   */\n  getHourDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(d.getFullYear(), d.getMonth(), d.getDate(), d.getHours());\n    var stop = null;\n\n    if (range instanceof Date) {\n      stop = new Date(range.getFullYear(), range.getMonth(), range.getDate(), range.getHours());\n    } else {\n      stop = new Date(start);\n      stop.setHours(stop.getHours() + range);\n    }\n\n    var domains = d3.time.hours(Math.min(start, stop), Math.max(start, stop)); // Passing from DST to standard time\n    // If there are 25 hours, let's compress the duplicate hours\n\n    var i = 0;\n    var total = domains.length;\n\n    for (i = 0; i < total; i += 1) {\n      if (i > 0 && domains[i].getHours() === domains[i - 1].getHours()) {\n        this.DSTDomain.push(domains[i].getTime());\n        domains.splice(i, 1);\n        break;\n      }\n    } // d3.time.hours is returning more hours than needed when changing\n    // from DST to standard time, because there is really 2 hours between\n    // 1am and 2am!\n\n\n    if (typeof range === 'number' && domains.length > Math.abs(range)) {\n      domains.splice(domains.length - 1, 1);\n    }\n\n    return domains;\n  },\n\n  /**\n   * Return all the days between 2 dates\n   *\n   * @param  Date    d    A date\n   * @param  int|date  range  Number of days in the range, or a stop date\n   * @return array  An array of weeks\n   */\n  getDayDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(d.getFullYear(), d.getMonth(), d.getDate());\n    var stop = null;\n\n    if (range instanceof Date) {\n      stop = new Date(range.getFullYear(), range.getMonth(), range.getDate());\n    } else {\n      stop = new Date(start);\n      stop = new Date(stop.setDate(stop.getDate() + parseInt(range, 10)));\n    }\n\n    return d3.time.days(Math.min(start, stop), Math.max(start, stop));\n  },\n\n  /**\n   * Return all the weeks between 2 dates\n   *\n   * @param  Date  d  A date\n   * @param  int|date  range  Number of minutes in the range, or a stop date\n   * @return array  An array of weeks\n   */\n  getWeekDomain: function (d, range) {\n    'use strict';\n\n    var weekStart;\n\n    if (this.options.weekStartOnMonday === false) {\n      weekStart = new Date(d.getFullYear(), d.getMonth(), d.getDate() - d.getDay());\n    } else {\n      if (d.getDay() === 1) {\n        weekStart = new Date(d.getFullYear(), d.getMonth(), d.getDate());\n      } else if (d.getDay() === 0) {\n        weekStart = new Date(d.getFullYear(), d.getMonth(), d.getDate());\n        weekStart.setDate(weekStart.getDate() - 6);\n      } else {\n        weekStart = new Date(d.getFullYear(), d.getMonth(), d.getDate() - d.getDay() + 1);\n      }\n    }\n\n    var endDate = new Date(weekStart);\n    var stop = range;\n\n    if (typeof range !== 'object') {\n      stop = new Date(endDate.setDate(endDate.getDate() + range * 7));\n    }\n\n    return this.options.weekStartOnMonday === true ? d3.time.mondays(Math.min(weekStart, stop), Math.max(weekStart, stop)) : d3.time.sundays(Math.min(weekStart, stop), Math.max(weekStart, stop));\n  },\n\n  /**\n   * Return all the months between 2 dates\n   *\n   * @param  Date    d    A date\n   * @param  int|date  range  Number of months in the range, or a stop date\n   * @return array  An array of months\n   */\n  getMonthDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(d.getFullYear(), d.getMonth());\n    var stop = null;\n\n    if (range instanceof Date) {\n      stop = new Date(range.getFullYear(), range.getMonth());\n    } else {\n      stop = new Date(start);\n      stop = stop.setMonth(stop.getMonth() + range);\n    }\n\n    return d3.time.months(Math.min(start, stop), Math.max(start, stop));\n  },\n\n  /**\n   * Return all the years between 2 dates\n   *\n   * @param  Date  d  date  A date\n   * @param  int|date  range  Number of minutes in the range, or a stop date\n   * @return array  An array of hours\n   */\n  getYearDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(d.getFullYear(), 0);\n    var stop = null;\n\n    if (range instanceof Date) {\n      stop = new Date(range.getFullYear(), 0);\n    } else {\n      stop = new Date(d.getFullYear() + range, 0);\n    }\n\n    return d3.time.years(Math.min(start, stop), Math.max(start, stop));\n  },\n\n  /**\n   * Get an array of domain start dates\n   *\n   * @param  int|Date date A random date included in the wanted domain\n   * @param  int|Date range Number of dates to get, or a stop date\n   * @return Array of dates\n   */\n  getDomain: function (date, range) {\n    'use strict';\n\n    if (typeof date === 'number') {\n      date = new Date(date);\n    }\n\n    if (arguments.length < 2) {\n      range = this.options.range;\n    }\n\n    switch (this.options.domain) {\n      case 'hour':\n        var domains = this.getHourDomain(date, range); // Case where an hour is missing, when passing from standard time to DST\n        // Missing hour is perfectly acceptabl in subDomain, but not in domains\n\n        if (typeof range === 'number' && domains.length < range) {\n          if (range > 0) {\n            domains.push(this.getHourDomain(domains[domains.length - 1], 2)[1]);\n          } else {\n            domains.shift(this.getHourDomain(domains[0], -2)[0]);\n          }\n        }\n\n        return domains;\n\n      case 'day':\n        return this.getDayDomain(date, range);\n\n      case 'week':\n        return this.getWeekDomain(date, range);\n\n      case 'month':\n        return this.getMonthDomain(date, range);\n\n      case 'year':\n        return this.getYearDomain(date, range);\n    }\n  },\n\n  /* jshint maxcomplexity: false */\n  getSubDomain: function (date) {\n    'use strict';\n\n    if (typeof date === 'number') {\n      date = new Date(date);\n    }\n\n    var parent = this;\n    /**\n     * @return int\n     */\n\n    var computeDaySubDomainSize = function (date, domain) {\n      switch (domain) {\n        case 'year':\n          return parent.getDayCountInYear(date);\n\n        case 'month':\n          return parent.getDayCountInMonth(date);\n\n        case 'week':\n          return 7;\n      }\n    };\n    /**\n     * @return int\n     */\n\n\n    var computeMinSubDomainSize = function (date, domain) {\n      switch (domain) {\n        case 'hour':\n          return 60;\n\n        case 'day':\n          return 60 * 24;\n\n        case 'week':\n          return 60 * 24 * 7;\n      }\n    };\n    /**\n     * @return int\n     */\n\n\n    var computeHourSubDomainSize = function (date, domain) {\n      switch (domain) {\n        case 'day':\n          return 24;\n\n        case 'week':\n          return 168;\n\n        case 'month':\n          return parent.getDayCountInMonth(date) * 24;\n      }\n    };\n    /**\n     * @return int\n     */\n\n\n    var computeWeekSubDomainSize = function (date, domain) {\n      if (domain === 'month') {\n        var endOfMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0);\n        var endWeekNb = parent.getWeekNumber(endOfMonth);\n        var startWeekNb = parent.getWeekNumber(new Date(date.getFullYear(), date.getMonth()));\n\n        if (startWeekNb > endWeekNb) {\n          startWeekNb = 0;\n          endWeekNb += 1;\n        }\n\n        return endWeekNb - startWeekNb + 1;\n      } else if (domain === 'year') {\n        return parent.getWeekNumber(new Date(date.getFullYear(), 11, 31));\n      }\n    };\n\n    switch (this.options.subDomain) {\n      case 'x_min':\n      case 'min':\n        return this.getMinuteDomain(date, computeMinSubDomainSize(date, this.options.domain));\n\n      case 'x_hour':\n      case 'hour':\n        return this.getHourDomain(date, computeHourSubDomainSize(date, this.options.domain));\n\n      case 'x_day':\n      case 'day':\n        return this.getDayDomain(date, computeDaySubDomainSize(date, this.options.domain));\n\n      case 'x_week':\n      case 'week':\n        return this.getWeekDomain(date, computeWeekSubDomainSize(date, this.options.domain));\n\n      case 'x_month':\n      case 'month':\n        return this.getMonthDomain(date, 12);\n    }\n  },\n\n  /**\n   * Get the n-th next domain after the calendar newest (rightmost) domain\n   * @param  int n\n   * @return Date The start date of the wanted domain\n   */\n  getNextDomain: function (n) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      n = 1;\n    }\n\n    return this.getDomain(this.jumpDate(this.getDomainKeys().pop(), n, this.options.domain), 1)[0];\n  },\n\n  /**\n   * Get the n-th domain before the calendar oldest (leftmost) domain\n   * @param  int n\n   * @return Date The start date of the wanted domain\n   */\n  getPreviousDomain: function (n) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      n = 1;\n    }\n\n    return this.getDomain(this.jumpDate(this.getDomainKeys().shift(), -n, this.options.domain), 1)[0];\n  },\n  // =========================================================================//\n  // DATAS                                  //\n  // =========================================================================//\n\n  /**\n   * Fetch and interpret data from the datasource\n   *\n   * @param string|object source\n   * @param Date startDate\n   * @param Date endDate\n   * @param function callback\n   * @param function|boolean afterLoad function used to convert the data into a json object. Use true to use the afterLoad callback\n   * @param updateMode\n   *\n   * @return mixed\n   * - True if there are no data to load\n   * - False if data are loaded asynchronously\n   */\n  getDatas: function (source, startDate, endDate, callback, afterLoad, updateMode) {\n    'use strict';\n\n    var self = this;\n\n    if (arguments.length < 5) {\n      afterLoad = true;\n    }\n\n    if (arguments.length < 6) {\n      updateMode = this.APPEND_ON_UPDATE;\n    }\n\n    var _callback = function (error, data) {\n      if (afterLoad !== false) {\n        if (typeof afterLoad === 'function') {\n          data = afterLoad(data);\n        } else if (typeof self.options.afterLoadData === 'function') {\n          data = self.options.afterLoadData(data);\n        } else {\n          console.log('Provided callback for afterLoadData is not a function.');\n        }\n      } else if (self.options.dataType === 'csv' || self.options.dataType === 'tsv') {\n        data = this.interpretCSV(data);\n      }\n\n      self.parseDatas(data, updateMode, startDate, endDate);\n\n      if (typeof callback === 'function') {\n        callback();\n      }\n    };\n\n    switch (typeof source) {\n      case 'string':\n        if (source === '') {\n          _callback(null, {});\n\n          return true;\n        } else {\n          var url = this.parseURI(source, startDate, endDate);\n          var requestType = 'GET';\n\n          if (self.options.dataPostPayload !== null) {\n            requestType = 'POST';\n          }\n\n          var payload = null;\n\n          if (self.options.dataPostPayload !== null) {\n            payload = this.parseURI(self.options.dataPostPayload, startDate, endDate);\n          }\n\n          var xhr = null;\n\n          switch (this.options.dataType) {\n            case 'json':\n              xhr = d3.json(url);\n              break;\n\n            case 'csv':\n              xhr = d3.csv(url);\n              break;\n\n            case 'tsv':\n              xhr = d3.tsv(url);\n              break;\n\n            case 'txt':\n              xhr = d3.text(url, 'text/plain');\n              break;\n          } // jshint maxdepth:5\n\n\n          if (self.options.dataRequestHeaders !== null) {\n            for (var header in self.options.dataRequestHeaders) {\n              if (self.options.dataRequestHeaders.hasOwnProperty(header)) {\n                xhr.header(header, self.options.dataRequestHeaders[header]);\n              }\n            }\n          }\n\n          xhr.send(requestType, payload, _callback);\n        }\n\n        return false;\n\n      case 'object':\n        if (source === Object(source)) {\n          _callback(null, source);\n\n          return false;\n        }\n\n      /* falls through */\n\n      default:\n        _callback(null, {});\n\n        return true;\n    }\n  },\n\n  /**\n   * Populate the calendar internal data\n   *\n   * @param object data\n   * @param constant updateMode\n   * @param Date startDate\n   * @param Date endDate\n   *\n   * @return void\n   */\n  parseDatas: function (data, updateMode, startDate, endDate) {\n    'use strict';\n\n    if (updateMode === this.RESET_ALL_ON_UPDATE) {\n      this._domains.forEach(function (key, value) {\n        value.forEach(function (element, index, array) {\n          array[index].v = null;\n        });\n      });\n    }\n\n    var temp = {};\n\n    var extractTime = function (d) {\n      return d.t;\n    };\n    /*jshint forin:false */\n\n\n    for (var d in data) {\n      var date = new Date(d * 1000);\n      var domainUnit = this.getDomain(date)[0].getTime(); // The current data belongs to a domain that was compressed\n      // Compress the data for the two duplicate hours into the same hour\n\n      if (this.DSTDomain.indexOf(domainUnit) >= 0) {\n        // Re-assign all data to the first or the second duplicate hours\n        // depending on which is visible\n        if (this._domains.has(domainUnit - 3600 * 1000)) {\n          domainUnit -= 3600 * 1000;\n        }\n      } // Skip if data is not relevant to current domain\n\n\n      if (isNaN(d) || !data.hasOwnProperty(d) || !this._domains.has(domainUnit) || !(domainUnit >= +startDate && domainUnit < +endDate)) {\n        continue;\n      }\n\n      var subDomainsData = this._domains.get(domainUnit);\n\n      if (!temp.hasOwnProperty(domainUnit)) {\n        temp[domainUnit] = subDomainsData.map(extractTime);\n      }\n\n      var index = temp[domainUnit].indexOf(this._domainType[this.options.subDomain].extractUnit(date));\n\n      if (updateMode === this.RESET_SINGLE_ON_UPDATE) {\n        subDomainsData[index].v = data[d];\n      } else {\n        if (!isNaN(subDomainsData[index].v)) {\n          subDomainsData[index].v += data[d];\n        } else {\n          subDomainsData[index].v = data[d];\n        }\n      }\n    }\n  },\n  parseURI: function (str, startDate, endDate) {\n    'use strict'; // Use a timestamp in seconds\n\n    str = str.replace(/\\{\\{t:start\\}\\}/g, startDate.getTime() / 1000);\n    str = str.replace(/\\{\\{t:end\\}\\}/g, endDate.getTime() / 1000); // Use a string date, following the ISO-8601\n\n    str = str.replace(/\\{\\{d:start\\}\\}/g, startDate.toISOString());\n    str = str.replace(/\\{\\{d:end\\}\\}/g, endDate.toISOString());\n    return str;\n  },\n  interpretCSV: function (data) {\n    'use strict';\n\n    var d = {};\n    var keys = Object.keys(data[0]);\n    var i, total;\n\n    for (i = 0, total = data.length; i < total; i += 1) {\n      d[data[i][keys[0]]] = +data[i][keys[1]];\n    }\n\n    return d;\n  },\n\n  /**\n   * Handle the calendar layout and dimension\n   *\n   * Expand and shrink the container depending on its children dimension\n   * Also rearrange the children position depending on their dimension,\n   * and the legend position\n   *\n   * @return void\n   */\n  resize: function () {\n    'use strict';\n\n    var parent = this;\n    var options = parent.options;\n    var legendWidth = options.displayLegend ? parent.Legend.getDim('width') + options.legendMargin[1] + options.legendMargin[3] : 0;\n    var legendHeight = options.displayLegend ? parent.Legend.getDim('height') + options.legendMargin[0] + options.legendMargin[2] : 0;\n    var graphWidth = parent.graphDim.width - options.domainGutter - options.cellPadding;\n    var graphHeight = parent.graphDim.height - options.domainGutter - options.cellPadding;\n    this.root.transition().duration(options.animationDuration).attr('width', function () {\n      if (options.legendVerticalPosition === 'middle' || options.legendVerticalPosition === 'center') {\n        return graphWidth + legendWidth;\n      }\n\n      return Math.max(graphWidth, legendWidth);\n    }).attr('height', function () {\n      if (options.legendVerticalPosition === 'middle' || options.legendVerticalPosition === 'center') {\n        return Math.max(graphHeight, legendHeight);\n      }\n\n      return graphHeight + legendHeight;\n    });\n    this.root.select('.graph').transition().duration(options.animationDuration).attr('y', function () {\n      if (options.legendVerticalPosition === 'top') {\n        return legendHeight;\n      }\n\n      return 0;\n    }).attr('x', function () {\n      if ((options.legendVerticalPosition === 'middle' || options.legendVerticalPosition === 'center') && options.legendHorizontalPosition === 'left') {\n        return legendWidth;\n      }\n\n      return 0;\n    });\n  },\n  // =========================================================================//\n  // PUBLIC API                                //\n  // =========================================================================//\n\n  /**\n   * Shift the calendar forward\n   */\n  next: function (n) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      n = 1;\n    }\n\n    return this.loadNextDomain(n);\n  },\n\n  /**\n   * Shift the calendar backward\n   */\n  previous: function (n) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      n = 1;\n    }\n\n    return this.loadPreviousDomain(n);\n  },\n\n  /**\n   * Jump directly to a specific date\n   *\n   * JumpTo will scroll the calendar until the wanted domain with the specified\n   * date is visible. Unless you set reset to true, the wanted domain\n   * will not necessarily be the first (leftmost) domain of the calendar.\n   *\n   * @param Date date Jump to the domain containing that date\n   * @param bool reset Whether the wanted domain should be the first domain of the calendar\n   * @param bool True of the calendar was scrolled\n   */\n  jumpTo: function (date, reset) {\n    'use strict';\n\n    if (arguments.length < 2) {\n      reset = false;\n    }\n\n    var domains = this.getDomainKeys();\n    var firstDomain = domains[0];\n    var lastDomain = domains[domains.length - 1];\n\n    if (date < firstDomain) {\n      return this.loadPreviousDomain(this.getDomain(firstDomain, date).length);\n    } else {\n      if (reset) {\n        return this.loadNextDomain(this.getDomain(firstDomain, date).length);\n      }\n\n      if (date > lastDomain) {\n        return this.loadNextDomain(this.getDomain(lastDomain, date).length);\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * Navigate back to the start date\n   *\n   * @since  3.3.8\n   * @return void\n   */\n  rewind: function () {\n    'use strict';\n\n    this.jumpTo(this.options.start, true);\n  },\n\n  /**\n   * Update the calendar with new data\n   *\n   * @param  object|string    dataSource    The calendar's datasource, same type as this.options.data\n   * @param  boolean|function    afterLoad    Whether to execute afterLoad() on the data. Pass directly a function\n   * if you don't want to use the afterLoad() callback\n   */\n  update: function (dataSource, afterLoad, updateMode) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      dataSource = this.options.data;\n    }\n\n    if (arguments.length < 2) {\n      afterLoad = true;\n    }\n\n    if (arguments.length < 3) {\n      updateMode = this.RESET_ALL_ON_UPDATE;\n    }\n\n    var domains = this.getDomainKeys();\n    var self = this;\n    this.getDatas(dataSource, new Date(domains[0]), this.getSubDomain(domains[domains.length - 1]).pop(), function () {\n      self.fill();\n      self.afterUpdate();\n    }, afterLoad, updateMode);\n  },\n\n  /**\n   * Set the legend\n   *\n   * @param array legend an array of integer, representing the different threshold value\n   * @param array colorRange an array of 2 hex colors, for the minimum and maximum colors\n   */\n  setLegend: function () {\n    'use strict';\n\n    var oldLegend = this.options.legend.slice(0);\n\n    if (arguments.length >= 1 && Array.isArray(arguments[0])) {\n      this.options.legend = arguments[0];\n    }\n\n    if (arguments.length >= 2) {\n      if (Array.isArray(arguments[1]) && arguments[1].length >= 2) {\n        this.options.legendColors = [arguments[1][0], arguments[1][1]];\n      } else {\n        this.options.legendColors = arguments[1];\n      }\n    }\n\n    if (arguments.length > 0 && !arrayEquals(oldLegend, this.options.legend) || arguments.length >= 2) {\n      this.Legend.buildColors();\n      this.fill();\n    }\n\n    this.Legend.redraw(this.graphDim.width - this.options.domainGutter - this.options.cellPadding);\n  },\n\n  /**\n   * Remove the legend\n   *\n   * @return bool False if there is no legend to remove\n   */\n  removeLegend: function () {\n    'use strict';\n\n    if (!this.options.displayLegend) {\n      return false;\n    }\n\n    this.options.displayLegend = false;\n    this.Legend.remove();\n    return true;\n  },\n\n  /**\n   * Display the legend\n   *\n   * @return bool False if the legend was already displayed\n   */\n  showLegend: function () {\n    'use strict';\n\n    if (this.options.displayLegend) {\n      return false;\n    }\n\n    this.options.displayLegend = true;\n    this.Legend.redraw(this.graphDim.width - this.options.domainGutter - this.options.cellPadding);\n    return true;\n  },\n\n  /**\n   * Highlight dates\n   *\n   * Add a highlight class to a set of dates\n   *\n   * @since  3.3.5\n   * @param  array Array of dates to highlight\n   * @return bool True if dates were highlighted\n   */\n  highlight: function (args) {\n    'use strict';\n\n    if ((this.options.highlight = this.expandDateSetting(args)).length > 0) {\n      this.fill();\n      return true;\n    }\n\n    return false;\n  },\n\n  /**\n   * Destroy the calendar\n   *\n   * Usage: cal = cal.destroy();\n   *\n   * @since  3.3.6\n   * @param function A callback function to trigger after destroying the calendar\n   * @return null\n   */\n  destroy: function (callback) {\n    'use strict';\n\n    this.root.transition().duration(this.options.animationDuration).attr('width', 0).attr('height', 0).remove().each('end', function () {\n      if (typeof callback === 'function') {\n        callback();\n      } else if (typeof callback !== 'undefined') {\n        console.log('Provided callback for destroy() is not a function.');\n      }\n    });\n    return null;\n  },\n  getSVG: function () {\n    'use strict';\n\n    var styles = {\n      '.cal-heatmap-container': {},\n      '.graph': {},\n      '.graph-rect': {},\n      'rect.highlight': {},\n      'rect.now': {},\n      'rect.highlight-now': {},\n      'text.highlight': {},\n      'text.now': {},\n      'text.highlight-now': {},\n      '.domain-background': {},\n      '.graph-label': {},\n      '.subdomain-text': {},\n      '.q0': {},\n      '.qi': {}\n    };\n\n    for (var j = 1, total = this.options.legend.length + 1; j <= total; j += 1) {\n      styles['.q' + j] = {};\n    }\n\n    var root = this.root;\n    var whitelistStyles = [// SVG specific properties\n    'stroke', 'stroke-width', 'stroke-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-miterlimit', 'fill', 'fill-opacity', 'fill-rule', 'marker', 'marker-start', 'marker-mid', 'marker-end', 'alignement-baseline', 'baseline-shift', 'dominant-baseline', 'glyph-orientation-horizontal', 'glyph-orientation-vertical', 'kerning', 'text-anchor', 'shape-rendering', // Text Specific properties\n    'text-transform', 'font-family', 'font', 'font-size', 'font-weight'];\n\n    var filterStyles = function (attribute, property, value) {\n      if (whitelistStyles.indexOf(property) !== -1) {\n        styles[attribute][property] = value;\n      }\n    };\n\n    var getElement = function (e) {\n      return root.select(e)[0][0];\n    };\n    /* jshint forin:false */\n\n\n    for (var element in styles) {\n      if (!styles.hasOwnProperty(element)) {\n        continue;\n      }\n\n      var dom = getElement(element);\n\n      if (dom === null) {\n        continue;\n      } // The DOM Level 2 CSS way\n\n      /* jshint maxdepth: false */\n\n\n      if ('getComputedStyle' in window) {\n        var cs = getComputedStyle(dom, null);\n\n        if (cs.length !== 0) {\n          for (var i = 0; i < cs.length; i += 1) {\n            filterStyles(element, cs.item(i), cs.getPropertyValue(cs.item(i)));\n          } // Opera workaround. Opera doesn\"t support `item`/`length`\n          // on CSSStyleDeclaration.\n\n        } else {\n          for (var k in cs) {\n            if (cs.hasOwnProperty(k)) {\n              filterStyles(element, k, cs[k]);\n            }\n          }\n        } // The IE way\n\n      } else if ('currentStyle' in dom) {\n        var css = dom.currentStyle;\n\n        for (var p in css) {\n          filterStyles(element, p, css[p]);\n        }\n      }\n    }\n\n    var string = '<svg xmlns=\"http://www.w3.org/2000/svg\" ' + 'xmlns:xlink=\"http://www.w3.org/1999/xlink\"><style type=\"text/css\"><![CDATA[ ';\n\n    for (var style in styles) {\n      string += style + ' {\\n';\n\n      for (var l in styles[style]) {\n        string += '\\t' + l + ':' + styles[style][l] + ';\\n';\n      }\n\n      string += '}\\n';\n    }\n\n    string += ']]></style>';\n    string += new XMLSerializer().serializeToString(this.root[0][0]);\n    string += '</svg>';\n    return string;\n  }\n}; // =========================================================================//\n// DOMAIN POSITION COMPUTATION                        //\n// =========================================================================//\n\n/**\n * Compute the position of a domain, relative to the calendar\n */\n\nvar DomainPosition = function () {\n  'use strict';\n\n  this.positions = d3.map();\n};\n\nDomainPosition.prototype.getPosition = function (d) {\n  'use strict';\n\n  return this.positions.get(d);\n};\n\nDomainPosition.prototype.getPositionFromIndex = function (i) {\n  'use strict';\n\n  var domains = this.getKeys();\n  return this.positions.get(domains[i]);\n};\n\nDomainPosition.prototype.getLast = function () {\n  'use strict';\n\n  var domains = this.getKeys();\n  return this.positions.get(domains[domains.length - 1]);\n};\n\nDomainPosition.prototype.setPosition = function (d, dim) {\n  'use strict';\n\n  this.positions.set(d, dim);\n};\n\nDomainPosition.prototype.shiftRightBy = function (exitingDomainDim) {\n  'use strict';\n\n  this.positions.forEach(function (key, value) {\n    this.set(key, value - exitingDomainDim);\n  });\n  var domains = this.getKeys();\n  this.positions.remove(domains[0]);\n};\n\nDomainPosition.prototype.shiftLeftBy = function (enteringDomainDim) {\n  'use strict';\n\n  this.positions.forEach(function (key, value) {\n    this.set(key, value + enteringDomainDim);\n  });\n  var domains = this.getKeys();\n  this.positions.remove(domains[domains.length - 1]);\n};\n\nDomainPosition.prototype.getKeys = function () {\n  'use strict';\n\n  return this.positions.keys().sort(function (a, b) {\n    return parseInt(a, 10) - parseInt(b, 10);\n  });\n}; // =========================================================================//\n// LEGEND                                  //\n// =========================================================================//\n\n\nvar Legend = function (calendar) {\n  'use strict';\n\n  this.calendar = calendar;\n  this.computeDim();\n\n  if (calendar.options.legendColors !== null) {\n    this.buildColors();\n  }\n};\n\nLegend.prototype.computeDim = function () {\n  'use strict';\n\n  var options = this.calendar.options; // Shorter accessor for variable name mangling when minifying\n\n  this.dim = {\n    width: options.legendCellSize * (options.legend.length + 1) + options.legendCellPadding * options.legend.length,\n    height: options.legendCellSize\n  };\n};\n\nLegend.prototype.remove = function () {\n  'use strict';\n\n  this.calendar.root.select('.graph-legend').remove();\n  this.calendar.resize();\n};\n\nLegend.prototype.redraw = function (width) {\n  'use strict';\n\n  if (!this.calendar.options.displayLegend) {\n    return false;\n  }\n\n  var parent = this;\n  var calendar = this.calendar;\n  var legend = calendar.root;\n  var legendItem;\n  var options = calendar.options; // Shorter accessor for variable name mangling when minifying\n\n  this.computeDim();\n\n  var _legend = options.legend.slice(0);\n\n  _legend.push(_legend[_legend.length - 1] + 1);\n\n  var legendElement = calendar.root.select('.graph-legend');\n\n  if (legendElement[0][0] !== null) {\n    legend = legendElement;\n    legendItem = legend.select('g').selectAll('rect').data(_legend);\n  } else {\n    // Creating the new legend DOM if it doesn't already exist\n    legend = options.legendVerticalPosition === 'top' ? legend.insert('svg', '.graph') : legend.append('svg');\n    legend.attr('x', getLegendXPosition()).attr('y', getLegendYPosition());\n    legendItem = legend.attr('class', 'graph-legend').attr('height', parent.getDim('height')).attr('width', parent.getDim('width')).append('g').selectAll().data(_legend);\n  }\n\n  legendItem.enter().append('rect').call(legendCellLayout).attr('class', function (d) {\n    return calendar.Legend.getClass(d, calendar.legendScale === null);\n  }).attr('fill-opacity', 0).call(function (selection) {\n    if (calendar.legendScale !== null && options.legendColors !== null && options.legendColors.hasOwnProperty('base')) {\n      selection.attr('fill', options.legendColors.base);\n    }\n  }).append('title');\n  legendItem.exit().transition().duration(options.animationDuration).attr('fill-opacity', 0).remove();\n  legendItem.transition().delay(function (d, i) {\n    return options.animationDuration * i / 10;\n  }).call(legendCellLayout).attr('fill-opacity', 1).call(function (element) {\n    element.attr('fill', function (d, i) {\n      if (calendar.legendScale === null) {\n        return '';\n      }\n\n      if (i === 0) {\n        return calendar.legendScale(d - 1);\n      }\n\n      return calendar.legendScale(options.legend[i - 1]);\n    });\n    element.attr('class', function (d) {\n      return calendar.Legend.getClass(d, calendar.legendScale === null);\n    });\n  });\n\n  function legendCellLayout(selection) {\n    selection.attr('width', options.legendCellSize).attr('height', options.legendCellSize).attr('rx', options.legendCellRadius).attr('ry', options.legendCellRadius).attr('x', function (d, i) {\n      return i * (options.legendCellSize + options.legendCellPadding);\n    });\n  }\n\n  legendItem.select('title').text(function (d, i) {\n    if (i === 0) {\n      return calendar.formatStringWithObject(options.legendTitleFormat.lower, {\n        min: options.legend[i],\n        name: options.itemName[1]\n      });\n    } else if (i === _legend.length - 1) {\n      return calendar.formatStringWithObject(options.legendTitleFormat.upper, {\n        max: options.legend[i - 1],\n        name: options.itemName[1]\n      });\n    } else {\n      return calendar.formatStringWithObject(options.legendTitleFormat.inner, {\n        down: options.legend[i - 1],\n        up: options.legend[i],\n        name: options.itemName[1]\n      });\n    }\n  });\n  legendItem.on('mouseover', function (d) {\n    calendar.legendTip.show(d, this);\n  }).on('mouseout', function () {\n    calendar.legendTip.hide();\n  });\n  legend.transition().duration(options.animationDuration).attr('x', getLegendXPosition()).attr('y', getLegendYPosition()).attr('width', parent.getDim('width')).attr('height', parent.getDim('height'));\n  legend.select('g').transition().duration(options.animationDuration).attr('transform', function () {\n    if (options.legendOrientation === 'vertical') {\n      return 'rotate(90 ' + options.legendCellSize / 2 + ' ' + options.legendCellSize / 2 + ')';\n    }\n\n    return '';\n  });\n\n  function getLegendXPosition() {\n    switch (options.legendHorizontalPosition) {\n      case 'right':\n        if (options.legendVerticalPosition === 'center' || options.legendVerticalPosition === 'middle') {\n          return width + options.legendMargin[3];\n        }\n\n        return width - parent.getDim('width') - options.legendMargin[1];\n\n      case 'middle':\n      case 'center':\n        return Math.round(width / 2 - parent.getDim('width') / 2);\n\n      default:\n        return options.legendMargin[3];\n    }\n  }\n\n  function getLegendYPosition() {\n    if (options.legendVerticalPosition === 'bottom') {\n      return calendar.graphDim.height + options.legendMargin[0] - options.domainGutter - options.cellPadding;\n    }\n\n    return options.legendMargin[0];\n  }\n\n  calendar.resize();\n};\n/**\n * Return the dimension of the legend\n *\n * Takes into account rotation\n *\n * @param  string axis Width or height\n * @return int height or width in pixels\n */\n\n\nLegend.prototype.getDim = function (axis) {\n  'use strict';\n\n  var isHorizontal = this.calendar.options.legendOrientation === 'horizontal';\n\n  switch (axis) {\n    case 'width':\n      return this.dim[isHorizontal ? 'width' : 'height'];\n\n    case 'height':\n      return this.dim[isHorizontal ? 'height' : 'width'];\n  }\n};\n\nLegend.prototype.buildColors = function () {\n  'use strict';\n\n  var options = this.calendar.options; // Shorter accessor for variable name mangling when minifying\n\n  if (options.legendColors === null) {\n    this.calendar.legendScale = null;\n    return false;\n  }\n\n  var _colorRange = [];\n\n  if (Array.isArray(options.legendColors)) {\n    _colorRange = options.legendColors;\n  } else if (options.legendColors.hasOwnProperty('min') && options.legendColors.hasOwnProperty('max')) {\n    _colorRange = [options.legendColors.min, options.legendColors.max];\n  } else {\n    options.legendColors = null;\n    return false;\n  }\n\n  var _legend = options.legend.slice(0);\n\n  if (_legend[0] > 0) {\n    _legend.unshift(0);\n  } else if (_legend[0] <= 0) {\n    // Let's guess the leftmost value, it we have to add one\n    _legend.unshift(_legend[0] - (_legend[_legend.length - 1] - _legend[0]) / _legend.length);\n  }\n\n  var colorScale;\n\n  if (options.legendColors.hasOwnProperty('colorScale')) {\n    colorScale = options.legendColors.colorScale;\n  } else {\n    colorScale = d3.scale.linear().range(_colorRange).interpolate(d3.interpolateHcl).domain([d3.min(_legend), d3.max(_legend)]);\n  }\n\n  var legendColors = _legend.map(function (element) {\n    return colorScale(element);\n  });\n\n  this.calendar.legendScale = d3.scale.threshold().domain(options.legend).range(legendColors);\n  return true;\n};\n/**\n * Return the classname on the legend for the specified value\n *\n * @param integer n Value associated to a date\n * @param bool withCssClass Whether to display the css class used to style the cell.\n *                          Disabling will allow styling directly via html fill attribute\n *\n * @return string Classname according to the legend\n */\n\n\nLegend.prototype.getClass = function (n, withCssClass) {\n  'use strict';\n\n  if (n === null || isNaN(n)) {\n    return '';\n  }\n\n  var index = [this.calendar.options.legend.length + 1];\n\n  for (var i = 0, total = this.calendar.options.legend.length - 1; i <= total; i += 1) {\n    if (this.calendar.options.legend[0] > 0 && n < 0) {\n      index = ['1', 'i'];\n      break;\n    }\n\n    if (n <= this.calendar.options.legend[i]) {\n      index = [i + 1];\n      break;\n    }\n  }\n\n  if (n === 0) {\n    index.push(0);\n  }\n\n  index.unshift('');\n  return (index.join(' r') + (withCssClass ? index.join(' q') : '')).trim();\n};\n/**\n * #source http://stackoverflow.com/a/383245/805649\n */\n\n\nfunction mergeRecursive(obj1, obj2) {\n  'use strict';\n  /*jshint forin:false */\n\n  for (var p in obj2) {\n    try {\n      // Property in destination object set; update its value.\n      if (obj2[p].constructor === Object) {\n        obj1[p] = mergeRecursive(obj1[p], obj2[p]);\n      } else {\n        obj1[p] = obj2[p];\n      }\n    } catch (e) {\n      // Property in destination object not set; create it and set its value.\n      obj1[p] = obj2[p];\n    }\n  }\n\n  return obj1;\n}\n/**\n * Check if 2 arrays are equals\n *\n * @link http://stackoverflow.com/a/14853974/805649\n * @param  array array the array to compare to\n * @return bool true of the 2 arrays are equals\n */\n\n\nfunction arrayEquals(arrayA, arrayB) {\n  'use strict'; // if the other array is a falsy value, return\n\n  if (!arrayB || !arrayA) {\n    return false;\n  } // compare lengths - can save a lot of time\n\n\n  if (arrayA.length !== arrayB.length) {\n    return false;\n  }\n\n  for (var i = 0; i < arrayA.length; i += 1) {\n    // Check if we have nested arrays\n    if (arrayA[i] instanceof Array && arrayB[i] instanceof Array) {\n      // recurse into the nested arrays\n      if (!arrayEquals(arrayA[i], arrayB[i])) {\n        return false;\n      }\n    } else if (arrayA[i] !== arrayB[i]) {\n      // Warning - two different object instances will never be equal: {x:20} != {x:20}\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (CalHeatMap);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9jYWwtaGVhdG1hcC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9Ac3VwZXJzZXQtdWkvbGVnYWN5LXBsdWdpbi1jaGFydC1jYWxlbmRhci9lc20vdmVuZG9yL2NhbC1oZWF0bWFwLmpzPzRlNzAiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gW0xJQ0VOU0UgVEJEXVxuXG4vKiBDb3BpZWQgYW5kIGFsdGVyZWQgZnJvbSBodHRwOi8vY2FsLWhlYXRtYXAuY29tLyAsIGFsdGVyYXRpb25zIGFyb3VuZDpcbiAqIC0gdHVuaW5nIHRvb2x0aXBzXG4gKiAtIHN1cHBvcnRpbmcgbXVsdGktY29sb3JzIHNjYWxlc1xuICogLSBsZWdlbmQgZm9ybWF0XG4gKiAtIFVUQyBoYW5kbGluZ1xuICovXG5cbi8qIGVzbGludC1kaXNhYmxlICovXG5pbXBvcnQgZDN0aXAgZnJvbSAnZDMtdGlwJztcbmltcG9ydCAnLi9kM3RpcC5jc3MnO1xudmFyIGQzID0gdHlwZW9mIHJlcXVpcmUgPT09ICdmdW5jdGlvbicgPyByZXF1aXJlKCdkMycpIDogd2luZG93LmQzO1xudmFyIGQzID0gdHlwZW9mIHJlcXVpcmUgPT09ICdmdW5jdGlvbicgPyByZXF1aXJlKCdkMycpIDogd2luZG93LmQzO1xuXG52YXIgQ2FsSGVhdE1hcCA9IGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBzZWxmID0gdGhpcztcbiAgc2VsZi50aXAgPSBkM3RpcCgpLmF0dHIoJ2NsYXNzJywgJ2QzLXRpcCcpLmRpcmVjdGlvbignbicpLm9mZnNldChbLTUsIDBdKS5odG1sKGQgPT4gYFxuICAgICAgJHtzZWxmLm9wdGlvbnMudGltZUZvcm1hdHRlcihkLnQpfTogPHN0cm9uZz4ke3NlbGYub3B0aW9ucy52YWx1ZUZvcm1hdHRlcihkLnYpfTwvc3Ryb25nPlxuICAgIGApO1xuICBzZWxmLmxlZ2VuZFRpcCA9IGQzdGlwKCkuYXR0cignY2xhc3MnLCAnZDMtdGlwJykuZGlyZWN0aW9uKCduJykub2Zmc2V0KFstNSwgMF0pLmh0bWwoZCA9PiBzZWxmLm9wdGlvbnMudmFsdWVGb3JtYXR0ZXIoZCkpO1xuICB0aGlzLmFsbG93ZWREYXRhVHlwZSA9IFsnanNvbicsICdjc3YnLCAndHN2JywgJ3R4dCddOyAvLyBEZWZhdWx0IHNldHRpbmdzXG5cbiAgdGhpcy5vcHRpb25zID0ge1xuICAgIC8vIHNlbGVjdG9yIHN0cmluZyBvZiB0aGUgY29udGFpbmVyIHRvIGFwcGVuZCB0aGUgZ3JhcGggdG9cbiAgICAvLyBBY2NlcHQgYW55IHN0cmluZyB2YWx1ZSBhY2NlcHRlZCBieSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yIG9yIENTUzNcbiAgICAvLyBvciBhbiBFbGVtZW50IG9iamVjdFxuICAgIGl0ZW1TZWxlY3RvcjogJyNjYWwtaGVhdG1hcCcsXG4gICAgLy8gV2hldGhlciB0byBwYWludCB0aGUgY2FsZW5kYXIgb24gaW5pdCgpXG4gICAgLy8gVXNlZCBieSB0ZXN0c3VpdGUgdG8gcmVkdWNlIHRlc3RpbmcgdGltZVxuICAgIHBhaW50T25Mb2FkOiB0cnVlLFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIERPTUFJTlxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIE51bWJlciBvZiBkb21haW4gdG8gZGlzcGxheSBvbiB0aGUgZ3JhcGhcbiAgICByYW5nZTogMTIsXG4gICAgLy8gU2l6ZSBvZiBlYWNoIGNlbGwsIGluIHBpeGVsXG4gICAgY2VsbFNpemU6IDEwLFxuICAgIC8vIFBhZGRpbmcgYmV0d2VlbiBlYWNoIGNlbGwsIGluIHBpeGVsXG4gICAgY2VsbFBhZGRpbmc6IDIsXG4gICAgLy8gRm9yIHJvdW5kZWQgc3ViZG9tYWluIHJlY3RhbmdsZXMsIGluIHBpeGVsc1xuICAgIGNlbGxSYWRpdXM6IDAsXG4gICAgZG9tYWluR3V0dGVyOiAyLFxuICAgIGRvbWFpbk1hcmdpbjogWzAsIDAsIDAsIDBdLFxuICAgIHZhbHVlRm9ybWF0dGVyOiBkID0+IGQsXG4gICAgdGltZUZvcm1hdHRlcjogZCA9PiBkLFxuICAgIGRvbWFpbjogJ2hvdXInLFxuICAgIHN1YkRvbWFpbjogJ21pbicsXG4gICAgLy8gTnVtYmVyIG9mIGNvbHVtbnMgdG8gc3BsaXQgdGhlIHN1YkRvbWFpbnMgdG9cbiAgICAvLyBJZiBub3QgbnVsbCwgd2lsbCB0YWtlcyBwcmVjZWRlbmNlIG92ZXIgcm93TGltaXRcbiAgICBjb2xMaW1pdDogbnVsbCxcbiAgICAvLyBOdW1iZXIgb2Ygcm93cyB0byBzcGxpdCB0aGUgc3ViRG9tYWlucyB0b1xuICAgIC8vIFdpbGwgYmUgaWdub3JlZCBpZiBjb2xMaW1pdCBpcyBub3QgbnVsbFxuICAgIHJvd0xpbWl0OiBudWxsLFxuICAgIC8vIEZpcnN0IGRheSBvZiB0aGUgd2VlayBpcyBNb25kYXlcbiAgICAvLyAwIHRvIHN0YXJ0IHRoZSB3ZWVrIG9uIFN1bmRheVxuICAgIHdlZWtTdGFydE9uTW9uZGF5OiB0cnVlLFxuICAgIC8vIFN0YXJ0IGRhdGUgb2YgdGhlIGdyYXBoXG4gICAgLy8gQGRlZmF1bHQgbm93XG4gICAgc3RhcnQ6IG5ldyBEYXRlKCksXG4gICAgbWluRGF0ZTogbnVsbCxcbiAgICBtYXhEYXRlOiBudWxsLFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIERBVEFcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAvLyBEYXRhIHNvdXJjZVxuICAgIC8vIFVSTCwgd2hlcmUgdG8gZmV0Y2ggdGhlIG9yaWdpbmFsIGRhdGFzXG4gICAgZGF0YTogJycsXG4gICAgLy8gRGF0YSB0eXBlXG4gICAgLy8gRGVmYXVsdDoganNvblxuICAgIGRhdGFUeXBlOiB0aGlzLmFsbG93ZWREYXRhVHlwZVswXSxcbiAgICAvLyBQYXlsb2FkIHNlbnQgd2hlbiB1c2luZyBQT1NUIGh0dHAgbWV0aG9kXG4gICAgLy8gTGVhdmUgdG8gbnVsbCAoZGVmYXVsdCkgZm9yIEdFVCByZXF1ZXN0XG4gICAgLy8gRXhwZWN0IGEgc3RyaW5nLCBmb3JtYXR0ZWQgbGlrZSBcImE9YjtjPWRcIlxuICAgIGRhdGFQb3N0UGF5bG9hZDogbnVsbCxcbiAgICAvLyBBZGRpdGlvbmFsIGhlYWRlcnMgc2VudCB3aGVuIHJlcXVlc3RpbmcgZGF0YVxuICAgIC8vIEV4cGVjdCBhbiBvYmplY3QgZm9ybWF0dGVkIGxpa2U6XG4gICAgLy8geyAnWC1DU1JGLVRPS0VOJzogJ3Rva2VuJyB9XG4gICAgZGF0YVJlcXVlc3RIZWFkZXJzOiBudWxsLFxuICAgIC8vIFdoZXRoZXIgdG8gY29uc2lkZXIgbWlzc2luZyBkYXRlOnZhbHVlIGZyb20gdGhlIGRhdGFzb3VyY2VcbiAgICAvLyBhcyBlcXVhbCB0byAwLCBvciBqdXN0IGxlYXZlIHRoZW0gYXMgbWlzc2luZ1xuICAgIGNvbnNpZGVyTWlzc2luZ0RhdGFBc1plcm86IGZhbHNlLFxuICAgIC8vIExvYWQgcmVtb3RlIGRhdGEgb24gY2FsZW5kYXIgY3JlYXRpb25cbiAgICAvLyBXaGVuIGZhbHNlLCB0aGUgY2FsZW5kYXIgd2lsbCBiZSBsZWZ0IGVtcHR5XG4gICAgbG9hZE9uSW5pdDogdHJ1ZSxcbiAgICAvLyBDYWxlbmRhciBvcmllbnRhdGlvblxuICAgIC8vIGZhbHNlOiBkaXNwbGF5IGRvbWFpbnMgc2lkZSBieSBzaWRlXG4gICAgLy8gdHJ1ZSA6IGRpc3BsYXkgZG9tYWlucyBvbmUgdW5kZXIgdGhlIG90aGVyXG4gICAgdmVydGljYWxPcmllbnRhdGlvbjogZmFsc2UsXG4gICAgLy8gRG9tYWluIGR5bmFtaWMgd2lkdGgvaGVpZ2h0XG4gICAgLy8gVGhlIHdpZHRoIG9uIGEgZG9tYWluIGRlcGVuZHMgb24gdGhlIG51bWJlciBvZlxuICAgIGRvbWFpbkR5bmFtaWNEaW1lbnNpb246IHRydWUsXG4gICAgLy8gRG9tYWluIExhYmVsIHByb3BlcnRpZXNcbiAgICBsYWJlbDoge1xuICAgICAgLy8gdmFsaWQ6IHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdFxuICAgICAgcG9zaXRpb246ICdib3R0b20nLFxuICAgICAgLy8gVmFsaWQ6IGxlZnQsIGNlbnRlciwgcmlnaHRcbiAgICAgIC8vIEFsc28gdmFsaWQgYXJlIHRoZSBkaXJlY3Qgc3ZnIHZhbHVlczogc3RhcnQsIG1pZGRsZSwgZW5kXG4gICAgICBhbGlnbjogJ2NlbnRlcicsXG4gICAgICAvLyBCeSBkZWZhdWx0LCB0aGVyZSBpcyBubyBtYXJnaW4vcGFkZGluZyBhcm91bmQgdGhlIGxhYmVsXG4gICAgICBvZmZzZXQ6IHtcbiAgICAgICAgeDogMCxcbiAgICAgICAgeTogMFxuICAgICAgfSxcbiAgICAgIHJvdGF0ZTogbnVsbCxcbiAgICAgIC8vIFVzZWQgb25seSBvbiB2ZXJ0aWNhbCBvcmllbnRhdGlvblxuICAgICAgd2lkdGg6IDEwMCxcbiAgICAgIC8vIFVzZWQgb25seSBvbiBob3Jpem9udGFsIG9yaWVudGF0aW9uXG4gICAgICBoZWlnaHQ6IG51bGxcbiAgICB9LFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIExFR0VORFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIFRocmVzaG9sZCBmb3IgdGhlIGxlZ2VuZFxuICAgIGxlZ2VuZDogWzEwLCAyMCwgMzAsIDQwXSxcbiAgICAvLyBXaGV0aGVyIHRvIGRpc3BsYXkgdGhlIGxlZ2VuZFxuICAgIGRpc3BsYXlMZWdlbmQ6IHRydWUsXG4gICAgbGVnZW5kQ2VsbFNpemU6IDEwLFxuICAgIGxlZ2VuZENlbGxQYWRkaW5nOiAyLFxuICAgIGxlZ2VuZE1hcmdpbjogWzAsIDAsIDAsIDBdLFxuICAgIC8vIExlZ2VuZCB2ZXJ0aWNhbCBwb3NpdGlvblxuICAgIC8vIHRvcDogcGxhY2UgbGVnZW5kIGFib3ZlIGNhbGVuZGFyXG4gICAgLy8gYm90dG9tOiBwbGFjZSBsZWdlbmQgYmVsb3cgdGhlIGNhbGVuZGFyXG4gICAgbGVnZW5kVmVydGljYWxQb3NpdGlvbjogJ2JvdHRvbScsXG4gICAgLy8gTGVnZW5kIGhvcml6b250YWwgcG9zaXRpb25cbiAgICAvLyBhY2NlcHRlZCB2YWx1ZXM6IGxlZnQsIGNlbnRlciwgcmlnaHRcbiAgICBsZWdlbmRIb3Jpem9udGFsUG9zaXRpb246ICdsZWZ0JyxcbiAgICAvLyBMZWdlbmQgcm90YXRpb25cbiAgICAvLyBhY2NlcHRlZCB2YWx1ZXM6IGhvcml6b250YWwsIHZlcnRpY2FsXG4gICAgbGVnZW5kT3JpZW50YXRpb246ICdob3Jpem9udGFsJyxcbiAgICAvLyBPYmplY3RzIGhvbGRpbmcgYWxsIHRoZSBoZWF0bWFwIGRpZmZlcmVudCBjb2xvcnNcbiAgICAvLyBudWxsIHRvIGRpc2FibGUsIGFuZCB1c2UgdGhlIGRlZmF1bHQgY3NzIHN0eWxlc1xuICAgIC8vXG4gICAgLy8gRXhhbXBsZXM6XG4gICAgLy8gbGVnZW5kQ29sb3JzOiB7XG4gICAgLy8gICAgbWluOiBcImdyZWVuXCIsXG4gICAgLy8gICAgbWF4OiBcInJlZFwiLFxuICAgIC8vICAgIGVtcHR5OiBcIiNmZmZmZmZcIixcbiAgICAvLyAgICBiYXNlOiBcImdyZXlcIixcbiAgICAvLyAgICBvdmVyZmxvdzogXCJyZWRcIixcbiAgICAvLyAgICBjb2xvclNjYWxlcjogbnVsbCxcbiAgICAvLyB9XG4gICAgbGVnZW5kQ29sb3JzOiBudWxsLFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIEhJR0hMSUdIVFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIExpc3Qgb2YgZGF0ZXMgdG8gaGlnaGxpZ2h0XG4gICAgLy8gVmFsaWQgdmFsdWVzOlxuICAgIC8vIC0gW106IGRvbid0IGhpZ2hsaWdodCBhbnl0aGluZ1xuICAgIC8vIC0gXCJub3dcIjogaGlnaGxpZ2h0IHRoZSBjdXJyZW50IGRhdGVcbiAgICAvLyAtIGFuIGFycmF5IG9mIERhdGUgb2JqZWN0czogaGlnaGxpZ2h0IHRoZSBzcGVjaWZpZWQgZGF0ZXNcbiAgICBoaWdobGlnaHQ6IFtdLFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIFRFWFQgRk9STUFUVElORyAvIGkxOG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAvLyBOYW1lIG9mIHRoZSBpdGVtcyB0byByZXByZXNlbnQgaW4gdGhlIGNhbGVuZGFyXG4gICAgaXRlbU5hbWU6IFsnaXRlbScsICdpdGVtcyddLFxuICAgIC8vIEZvcm1hdHRpbmcgb2YgdGhlIGRvbWFpbiBsYWJlbFxuICAgIC8vIEBkZWZhdWx0OiBudWxsLCB3aWxsIHVzZSB0aGUgZm9ybWF0dGluZyBhY2NvcmRpbmcgdG8gZG9tYWluIHR5cGVcbiAgICAvLyBBY2NlcHQgYSBzdHJpbmcgdXNlZCBhcyBzcGVjaWZpZXIgYnkgZDMudGltZS5mb3JtYXQoKVxuICAgIC8vIG9yIGEgZnVuY3Rpb25cbiAgICAvL1xuICAgIC8vIFJlZmVyIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9tYm9zdG9jay9kMy93aWtpL1RpbWUtRm9ybWF0dGluZ1xuICAgIC8vIGZvciBhY2NlcHRlZCBkYXRlIGZvcm1hdHRpbmcgdXNlZCBieSBkMy50aW1lLmZvcm1hdCgpXG4gICAgZG9tYWluTGFiZWxGb3JtYXQ6IG51bGwsXG4gICAgLy8gRm9ybWF0dGluZyBvZiB0aGUgdGl0bGUgZGlzcGxheWVkIHdoZW4gaG92ZXJpbmcgYSBzdWJEb21haW4gY2VsbFxuICAgIHN1YkRvbWFpblRpdGxlRm9ybWF0OiB7XG4gICAgICBlbXB0eTogJ3tkYXRlfScsXG4gICAgICBmaWxsZWQ6ICd7Y291bnR9IHtuYW1lfSB7Y29ubmVjdG9yfSB7ZGF0ZX0nXG4gICAgfSxcbiAgICAvLyBGb3JtYXR0aW5nIG9mIHRoZSB7ZGF0ZX0gdXNlZCBpbiBzdWJEb21haW5UaXRsZUZvcm1hdFxuICAgIC8vIEBkZWZhdWx0OiBudWxsLCB3aWxsIHVzZSB0aGUgZm9ybWF0dGluZyBhY2NvcmRpbmcgdG8gc3ViRG9tYWluIHR5cGVcbiAgICAvLyBBY2NlcHQgYSBzdHJpbmcgdXNlZCBhcyBzcGVjaWZpZXIgYnkgZDMudGltZS5mb3JtYXQoKVxuICAgIC8vIG9yIGEgZnVuY3Rpb25cbiAgICAvL1xuICAgIC8vIFJlZmVyIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9tYm9zdG9jay9kMy93aWtpL1RpbWUtRm9ybWF0dGluZ1xuICAgIC8vIGZvciBhY2NlcHRlZCBkYXRlIGZvcm1hdHRpbmcgdXNlZCBieSBkMy50aW1lLmZvcm1hdCgpXG4gICAgc3ViRG9tYWluRGF0ZUZvcm1hdDogbnVsbCxcbiAgICAvLyBGb3JtYXR0aW5nIG9mIHRoZSB0ZXh0IGluc2lkZSBlYWNoIHN1YkRvbWFpbiBjZWxsXG4gICAgLy8gQGRlZmF1bHQ6IG51bGwsIG5vIHRleHRcbiAgICAvLyBBY2NlcHQgYSBzdHJpbmcgdXNlZCBhcyBzcGVjaWZpZXIgYnkgZDMudGltZS5mb3JtYXQoKVxuICAgIC8vIG9yIGEgZnVuY3Rpb25cbiAgICAvL1xuICAgIC8vIFJlZmVyIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9tYm9zdG9jay9kMy93aWtpL1RpbWUtRm9ybWF0dGluZ1xuICAgIC8vIGZvciBhY2NlcHRlZCBkYXRlIGZvcm1hdHRpbmcgdXNlZCBieSBkMy50aW1lLmZvcm1hdCgpXG4gICAgc3ViRG9tYWluVGV4dEZvcm1hdDogbnVsbCxcbiAgICAvLyBGb3JtYXR0aW5nIG9mIHRoZSB0aXRsZSBkaXNwbGF5ZWQgd2hlbiBob3ZlcmluZyBhIGxlZ2VuZCBjZWxsXG4gICAgbGVnZW5kVGl0bGVGb3JtYXQ6IHtcbiAgICAgIGxvd2VyOiAnbGVzcyB0aGFuIHttaW59IHtuYW1lfScsXG4gICAgICBpbm5lcjogJ2JldHdlZW4ge2Rvd259IGFuZCB7dXB9IHtuYW1lfScsXG4gICAgICB1cHBlcjogJ21vcmUgdGhhbiB7bWF4fSB7bmFtZX0nXG4gICAgfSxcbiAgICAvLyBBbmltYXRpb24gZHVyYXRpb24sIGluIG1zXG4gICAgYW5pbWF0aW9uRHVyYXRpb246IDUwMCxcbiAgICBuZXh0U2VsZWN0b3I6IGZhbHNlLFxuICAgIHByZXZpb3VzU2VsZWN0b3I6IGZhbHNlLFxuICAgIGl0ZW1OYW1lc3BhY2U6ICdjYWwtaGVhdG1hcCcsXG4gICAgdG9vbHRpcDogZmFsc2UsXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy8gRVZFTlRTIENBTExCQUNLXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy8gQ2FsbGJhY2sgd2hlbiBjbGlja2luZyBvbiBhIHRpbWUgYmxvY2tcbiAgICBvbkNsaWNrOiBudWxsLFxuICAgIC8vIENhbGxiYWNrIGFmdGVyIHBhaW50aW5nIHRoZSBlbXB0eSBjYWxlbmRhclxuICAgIC8vIENhbiBiZSB1c2VkIHRvIHRyaWdnZXIgYW4gQVBJIGNhbGwsIG9uY2UgdGhlIGNhbGVuZGFyIGlzIHJlYWR5IHRvIGJlIGZpbGxlZFxuICAgIGFmdGVyTG9hZDogbnVsbCxcbiAgICAvLyBDYWxsYmFjayBhZnRlciBsb2FkaW5nIHRoZSBuZXh0IGRvbWFpbiBpbiB0aGUgY2FsZW5kYXJcbiAgICBhZnRlckxvYWROZXh0RG9tYWluOiBudWxsLFxuICAgIC8vIENhbGxiYWNrIGFmdGVyIGxvYWRpbmcgdGhlIHByZXZpb3VzIGRvbWFpbiBpbiB0aGUgY2FsZW5kYXJcbiAgICBhZnRlckxvYWRQcmV2aW91c0RvbWFpbjogbnVsbCxcbiAgICAvLyBDYWxsYmFjayBhZnRlciBmaW5pc2hpbmcgYWxsIGFjdGlvbnMgb24gdGhlIGNhbGVuZGFyXG4gICAgb25Db21wbGV0ZTogbnVsbCxcbiAgICAvLyBDYWxsYmFjayBhZnRlciBmZXRjaGluZyB0aGUgZGF0YXMsIGJ1dCBiZWZvcmUgYXBwbHlpbmcgdGhlbSB0byB0aGUgY2FsZW5kYXJcbiAgICAvLyBVc2VkIG1haW5seSB0byBjb252ZXJ0IHRoZSBkYXRhcyBpZiB0aGV5J3JlIG5vdCBmb3JtYXR0ZWQgbGlrZSBleHBlY3RlZFxuICAgIC8vIFRha2VzIHRoZSBmZXRjaGVkIFwiZGF0YVwiIG9iamVjdCBhcyBhcmd1bWVudCwgbXVzdCByZXR1cm4gYSBqc29uIG9iamVjdFxuICAgIC8vIGZvcm1hdHRlZCBsaWtlIHt0aW1lc3RhbXA6Y291bnQsIHRpbWVzdGFtcDI6Y291bnQyfSxcbiAgICBhZnRlckxvYWREYXRhOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcbiAgICAvLyBDYWxsYmFjayB0cmlnZ2VyZWQgYWZ0ZXIgY2FsbGluZyBhbmQgY29tcGxldGluZyB1cGRhdGUoKS5cbiAgICBhZnRlclVwZGF0ZTogbnVsbCxcbiAgICAvLyBDYWxsYmFjayB0cmlnZ2VyZWQgYWZ0ZXIgY2FsbGluZyBuZXh0KCkuXG4gICAgLy8gVGhlIGBzdGF0dXNgIGFyZ3VtZW50IGlzIGVxdWFsIHRvIHRydWUgaWYgdGhlcmUgaXMgbm9cbiAgICAvLyBtb3JlIG5leHQgZG9tYWluIHRvIGxvYWRcbiAgICAvL1xuICAgIC8vIFRoaXMgY2FsbGJhY2sgaXMgYWxzbyBleGVjdXRlZCBvbmNlLCBhZnRlciBjYWxsaW5nIHByZXZpb3VzKCksXG4gICAgLy8gb25seSB3aGVuIHRoZSBtYXggZG9tYWluIGlzIHJlYWNoZWRcbiAgICBvbk1heERvbWFpblJlYWNoZWQ6IG51bGwsXG4gICAgLy8gQ2FsbGJhY2sgdHJpZ2dlcmVkIGFmdGVyIGNhbGxpbmcgcHJldmlvdXMoKS5cbiAgICAvLyBUaGUgYHN0YXR1c2AgYXJndW1lbnQgaXMgZXF1YWwgdG8gdHJ1ZSBpZiB0aGVyZSBpcyBub1xuICAgIC8vIG1vcmUgcHJldmlvdXMgZG9tYWluIHRvIGxvYWRcbiAgICAvL1xuICAgIC8vIFRoaXMgY2FsbGJhY2sgaXMgYWxzbyBleGVjdXRlZCBvbmNlLCBhZnRlciBjYWxsaW5nIG5leHQoKSxcbiAgICAvLyBvbmx5IHdoZW4gdGhlIG1pbiBkb21haW4gaXMgcmVhY2hlZFxuICAgIG9uTWluRG9tYWluUmVhY2hlZDogbnVsbFxuICB9O1xuICB0aGlzLl9kb21haW5UeXBlID0ge1xuICAgIG1pbjoge1xuICAgICAgbmFtZTogJ21pbnV0ZScsXG4gICAgICBsZXZlbDogMTAsXG4gICAgICBtYXhJdGVtTnVtYmVyOiA2MCxcbiAgICAgIGRlZmF1bHRSb3dOdW1iZXI6IDEwLFxuICAgICAgZGVmYXVsdENvbHVtbk51bWJlcjogNixcbiAgICAgIHJvdzogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0U3ViRG9tYWluUm93TnVtYmVyKGQpO1xuICAgICAgfSxcbiAgICAgIGNvbHVtbjogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0U3ViRG9tYWluQ29sdW1uTnVtYmVyKGQpO1xuICAgICAgfSxcbiAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgIHg6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoZC5nZXRNaW51dGVzKCkgLyBzZWxmLl9kb21haW5UeXBlLm1pbi5yb3coZCkpO1xuICAgICAgICB9LFxuICAgICAgICB5OiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgIHJldHVybiBkLmdldE1pbnV0ZXMoKSAlIHNlbGYuX2RvbWFpblR5cGUubWluLnJvdyhkKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGZvcm1hdDoge1xuICAgICAgICBkYXRlOiAnJUg6JU0sICVBICVCICUtZSwgJVknLFxuICAgICAgICBsZWdlbmQ6ICcnLFxuICAgICAgICBjb25uZWN0b3I6ICdhdCdcbiAgICAgIH0sXG4gICAgICBleHRyYWN0VW5pdDogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpLCBkLmdldERhdGUoKSwgZC5nZXRIb3VycygpLCBkLmdldE1pbnV0ZXMoKSkuZ2V0VGltZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgaG91cjoge1xuICAgICAgbmFtZTogJ2hvdXInLFxuICAgICAgbGV2ZWw6IDIwLFxuICAgICAgbWF4SXRlbU51bWJlcjogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgc3dpdGNoIChzZWxmLm9wdGlvbnMuZG9tYWluKSB7XG4gICAgICAgICAgY2FzZSAnZGF5JzpcbiAgICAgICAgICAgIHJldHVybiAyNDtcblxuICAgICAgICAgIGNhc2UgJ3dlZWsnOlxuICAgICAgICAgICAgcmV0dXJuIDI0ICogNztcblxuICAgICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICAgIHJldHVybiAyNCAqIChzZWxmLm9wdGlvbnMuZG9tYWluRHluYW1pY0RpbWVuc2lvbiA/IHNlbGYuZ2V0RGF5Q291bnRJbk1vbnRoKGQpIDogMzEpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVmYXVsdFJvd051bWJlcjogNixcbiAgICAgIGRlZmF1bHRDb2x1bW5OdW1iZXI6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHN3aXRjaCAoc2VsZi5vcHRpb25zLmRvbWFpbikge1xuICAgICAgICAgIGNhc2UgJ2RheSc6XG4gICAgICAgICAgICByZXR1cm4gNDtcblxuICAgICAgICAgIGNhc2UgJ3dlZWsnOlxuICAgICAgICAgICAgcmV0dXJuIDI4O1xuXG4gICAgICAgICAgY2FzZSAnbW9udGgnOlxuICAgICAgICAgICAgcmV0dXJuIHNlbGYub3B0aW9ucy5kb21haW5EeW5hbWljRGltZW5zaW9uID8gc2VsZi5nZXREYXlDb3VudEluTW9udGgoZCkgOiAzMTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJvdzogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0U3ViRG9tYWluUm93TnVtYmVyKGQpO1xuICAgICAgfSxcbiAgICAgIGNvbHVtbjogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0U3ViRG9tYWluQ29sdW1uTnVtYmVyKGQpO1xuICAgICAgfSxcbiAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgIHg6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5kb21haW4gPT09ICdtb250aCcpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMuY29sTGltaXQgPiAwIHx8IHNlbGYub3B0aW9ucy5yb3dMaW1pdCA+IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKGQuZ2V0SG91cnMoKSArIChkLmdldERhdGUoKSAtIDEpICogMjQpIC8gc2VsZi5fZG9tYWluVHlwZS5ob3VyLnJvdyhkKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKGQuZ2V0SG91cnMoKSAvIHNlbGYuX2RvbWFpblR5cGUuaG91ci5yb3coZCkpICsgKGQuZ2V0RGF0ZSgpIC0gMSkgKiA0O1xuICAgICAgICAgIH0gZWxzZSBpZiAoc2VsZi5vcHRpb25zLmRvbWFpbiA9PT0gJ3dlZWsnKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmNvbExpbWl0ID4gMCB8fCBzZWxmLm9wdGlvbnMucm93TGltaXQgPiAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKChkLmdldEhvdXJzKCkgKyBzZWxmLmdldFdlZWtEYXkoZCkgKiAyNCkgLyBzZWxmLl9kb21haW5UeXBlLmhvdXIucm93KGQpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoZC5nZXRIb3VycygpIC8gc2VsZi5fZG9tYWluVHlwZS5ob3VyLnJvdyhkKSkgKyBzZWxmLmdldFdlZWtEYXkoZCkgKiA0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKGQuZ2V0SG91cnMoKSAvIHNlbGYuX2RvbWFpblR5cGUuaG91ci5yb3coZCkpO1xuICAgICAgICB9LFxuICAgICAgICB5OiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgIHZhciBwID0gZC5nZXRIb3VycygpO1xuXG4gICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5jb2xMaW1pdCA+IDAgfHwgc2VsZi5vcHRpb25zLnJvd0xpbWl0ID4gMCkge1xuICAgICAgICAgICAgc3dpdGNoIChzZWxmLm9wdGlvbnMuZG9tYWluKSB7XG4gICAgICAgICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICAgICAgICBwICs9IChkLmdldERhdGUoKSAtIDEpICogMjQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgICAgICAgICAgcCArPSBzZWxmLmdldFdlZWtEYXkoZCkgKiAyNDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihwICUgc2VsZi5fZG9tYWluVHlwZS5ob3VyLnJvdyhkKSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBmb3JtYXQ6IHtcbiAgICAgICAgZGF0ZTogJyVIaCwgJUEgJUIgJS1lLCAlWScsXG4gICAgICAgIGxlZ2VuZDogJyVIOjAwJyxcbiAgICAgICAgY29ubmVjdG9yOiAnYXQnXG4gICAgICB9LFxuICAgICAgZXh0cmFjdFVuaXQ6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSwgZC5nZXREYXRlKCksIGQuZ2V0SG91cnMoKSkuZ2V0VGltZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZGF5OiB7XG4gICAgICBuYW1lOiAnZGF5JyxcbiAgICAgIGxldmVsOiAzMCxcbiAgICAgIG1heEl0ZW1OdW1iZXI6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHN3aXRjaCAoc2VsZi5vcHRpb25zLmRvbWFpbikge1xuICAgICAgICAgIGNhc2UgJ3dlZWsnOlxuICAgICAgICAgICAgcmV0dXJuIDc7XG5cbiAgICAgICAgICBjYXNlICdtb250aCc6XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5vcHRpb25zLmRvbWFpbkR5bmFtaWNEaW1lbnNpb24gPyBzZWxmLmdldERheUNvdW50SW5Nb250aChkKSA6IDMxO1xuXG4gICAgICAgICAgY2FzZSAneWVhcic6XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5vcHRpb25zLmRvbWFpbkR5bmFtaWNEaW1lbnNpb24gPyBzZWxmLmdldERheUNvdW50SW5ZZWFyKGQpIDogMzY2O1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVmYXVsdENvbHVtbk51bWJlcjogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgZCA9IG5ldyBEYXRlKGQpO1xuXG4gICAgICAgIHN3aXRjaCAoc2VsZi5vcHRpb25zLmRvbWFpbikge1xuICAgICAgICAgIGNhc2UgJ3dlZWsnOlxuICAgICAgICAgICAgcmV0dXJuIDE7XG5cbiAgICAgICAgICBjYXNlICdtb250aCc6XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5vcHRpb25zLmRvbWFpbkR5bmFtaWNEaW1lbnNpb24gJiYgIXNlbGYub3B0aW9ucy52ZXJ0aWNhbE9yaWVudGF0aW9uID8gc2VsZi5nZXRXZWVrTnVtYmVyKG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpICsgMSwgMCkpIC0gc2VsZi5nZXRXZWVrTnVtYmVyKGQpICsgMSA6IDY7XG5cbiAgICAgICAgICBjYXNlICd5ZWFyJzpcbiAgICAgICAgICAgIHJldHVybiBzZWxmLm9wdGlvbnMuZG9tYWluRHluYW1pY0RpbWVuc2lvbiA/IHNlbGYuZ2V0V2Vla051bWJlcihuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIDExLCAzMSkpIC0gc2VsZi5nZXRXZWVrTnVtYmVyKG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgMCkpICsgMSA6IDU0O1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVmYXVsdFJvd051bWJlcjogNyxcbiAgICAgIHJvdzogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0U3ViRG9tYWluUm93TnVtYmVyKGQpO1xuICAgICAgfSxcbiAgICAgIGNvbHVtbjogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0U3ViRG9tYWluQ29sdW1uTnVtYmVyKGQpO1xuICAgICAgfSxcbiAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgIHg6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgc3dpdGNoIChzZWxmLm9wdGlvbnMuZG9tYWluKSB7XG4gICAgICAgICAgICBjYXNlICd3ZWVrJzpcbiAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3Ioc2VsZi5nZXRXZWVrRGF5KGQpIC8gc2VsZi5fZG9tYWluVHlwZS5kYXkucm93KGQpKTtcblxuICAgICAgICAgICAgY2FzZSAnbW9udGgnOlxuICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmNvbExpbWl0ID4gMCB8fCBzZWxmLm9wdGlvbnMucm93TGltaXQgPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKGQuZ2V0RGF0ZSgpIC0gMSkgLyBzZWxmLl9kb21haW5UeXBlLmRheS5yb3coZCkpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0V2Vla051bWJlcihkKSAtIHNlbGYuZ2V0V2Vla051bWJlcihuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSkpO1xuXG4gICAgICAgICAgICBjYXNlICd5ZWFyJzpcbiAgICAgICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5jb2xMaW1pdCA+IDAgfHwgc2VsZi5vcHRpb25zLnJvd0xpbWl0ID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKChzZWxmLmdldERheU9mWWVhcihkKSAtIDEpIC8gc2VsZi5fZG9tYWluVHlwZS5kYXkucm93KGQpKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldFdlZWtOdW1iZXIoZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB5OiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgIHZhciBwID0gc2VsZi5nZXRXZWVrRGF5KGQpO1xuXG4gICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5jb2xMaW1pdCA+IDAgfHwgc2VsZi5vcHRpb25zLnJvd0xpbWl0ID4gMCkge1xuICAgICAgICAgICAgc3dpdGNoIChzZWxmLm9wdGlvbnMuZG9tYWluKSB7XG4gICAgICAgICAgICAgIGNhc2UgJ3llYXInOlxuICAgICAgICAgICAgICAgIHAgPSBzZWxmLmdldERheU9mWWVhcihkKSAtIDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgICAgICAgICAgcCA9IHNlbGYuZ2V0V2Vla0RheShkKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlICdtb250aCc6XG4gICAgICAgICAgICAgICAgcCA9IGQuZ2V0RGF0ZSgpIC0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihwICUgc2VsZi5fZG9tYWluVHlwZS5kYXkucm93KGQpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGZvcm1hdDoge1xuICAgICAgICBkYXRlOiAnJUEgJUIgJS1lLCAlWScsXG4gICAgICAgIGxlZ2VuZDogJyVlICViJyxcbiAgICAgICAgY29ubmVjdG9yOiAnb24nXG4gICAgICB9LFxuICAgICAgZXh0cmFjdFVuaXQ6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSwgZC5nZXREYXRlKCkpLmdldFRpbWUoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHdlZWs6IHtcbiAgICAgIG5hbWU6ICd3ZWVrJyxcbiAgICAgIGxldmVsOiA0MCxcbiAgICAgIG1heEl0ZW1OdW1iZXI6IDU0LFxuICAgICAgZGVmYXVsdENvbHVtbk51bWJlcjogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgZCA9IG5ldyBEYXRlKGQpO1xuXG4gICAgICAgIHN3aXRjaCAoc2VsZi5vcHRpb25zLmRvbWFpbikge1xuICAgICAgICAgIGNhc2UgJ3llYXInOlxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2RvbWFpblR5cGUud2Vlay5tYXhJdGVtTnVtYmVyO1xuXG4gICAgICAgICAgY2FzZSAnbW9udGgnOlxuICAgICAgICAgICAgcmV0dXJuIHNlbGYub3B0aW9ucy5kb21haW5EeW5hbWljRGltZW5zaW9uID8gc2VsZi5nZXRXZWVrTnVtYmVyKG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpICsgMSwgMCkpIC0gc2VsZi5nZXRXZWVrTnVtYmVyKGQpIDogNTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlZmF1bHRSb3dOdW1iZXI6IDEsXG4gICAgICByb3c6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmdldFN1YkRvbWFpblJvd051bWJlcihkKTtcbiAgICAgIH0sXG4gICAgICBjb2x1bW46IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmdldFN1YkRvbWFpbkNvbHVtbk51bWJlcihkKTtcbiAgICAgIH0sXG4gICAgICBwb3NpdGlvbjoge1xuICAgICAgICB4OiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgIHN3aXRjaCAoc2VsZi5vcHRpb25zLmRvbWFpbikge1xuICAgICAgICAgICAgY2FzZSAneWVhcic6XG4gICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKHNlbGYuZ2V0V2Vla051bWJlcihkKSAvIHNlbGYuX2RvbWFpblR5cGUud2Vlay5yb3coZCkpO1xuXG4gICAgICAgICAgICBjYXNlICdtb250aCc6XG4gICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKHNlbGYuZ2V0TW9udGhXZWVrTnVtYmVyKGQpIC8gc2VsZi5fZG9tYWluVHlwZS53ZWVrLnJvdyhkKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB5OiBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgIHJldHVybiBzZWxmLmdldFdlZWtOdW1iZXIoZCkgJSBzZWxmLl9kb21haW5UeXBlLndlZWsucm93KGQpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZm9ybWF0OiB7XG4gICAgICAgIGRhdGU6ICclQiBXZWVrICMlVycsXG4gICAgICAgIGxlZ2VuZDogJyVCIFdlZWsgIyVXJyxcbiAgICAgICAgY29ubmVjdG9yOiAnaW4nXG4gICAgICB9LFxuICAgICAgZXh0cmFjdFVuaXQ6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHZhciBkdCA9IG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpLCBkLmdldERhdGUoKSk7IC8vIEFjY29yZGluZyB0byBJU08tODYwMSwgd2VlayBudW1iZXIgY29tcHV0YXRpb24gYXJlIGJhc2VkIG9uIHdlZWsgc3RhcnRpbmcgb24gTW9uZGF5XG5cbiAgICAgICAgdmFyIHdlZWtEYXkgPSBkdC5nZXREYXkoKSAtIChzZWxmLm9wdGlvbnMud2Vla1N0YXJ0T25Nb25kYXkgPyAxIDogMCk7XG5cbiAgICAgICAgaWYgKHdlZWtEYXkgPCAwKSB7XG4gICAgICAgICAgd2Vla0RheSA9IDY7XG4gICAgICAgIH1cblxuICAgICAgICBkdC5zZXREYXRlKGR0LmdldERhdGUoKSAtIHdlZWtEYXkpO1xuICAgICAgICByZXR1cm4gZHQuZ2V0VGltZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgbW9udGg6IHtcbiAgICAgIG5hbWU6ICdtb250aCcsXG4gICAgICBsZXZlbDogNTAsXG4gICAgICBtYXhJdGVtTnVtYmVyOiAxMixcbiAgICAgIGRlZmF1bHRDb2x1bW5OdW1iZXI6IDEyLFxuICAgICAgZGVmYXVsdFJvd051bWJlcjogMSxcbiAgICAgIHJvdzogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5nZXRTdWJEb21haW5Sb3dOdW1iZXIoKTtcbiAgICAgIH0sXG4gICAgICBjb2x1bW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0U3ViRG9tYWluQ29sdW1uTnVtYmVyKCk7XG4gICAgICB9LFxuICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgeDogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihkLmdldE1vbnRoKCkgLyBzZWxmLl9kb21haW5UeXBlLm1vbnRoLnJvdyhkKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHk6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgcmV0dXJuIGQuZ2V0TW9udGgoKSAlIHNlbGYuX2RvbWFpblR5cGUubW9udGgucm93KGQpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZm9ybWF0OiB7XG4gICAgICAgIGRhdGU6ICclQiAlWScsXG4gICAgICAgIGxlZ2VuZDogJyVCJyxcbiAgICAgICAgY29ubmVjdG9yOiAnaW4nXG4gICAgICB9LFxuICAgICAgZXh0cmFjdFVuaXQ6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSkuZ2V0VGltZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgeWVhcjoge1xuICAgICAgbmFtZTogJ3llYXInLFxuICAgICAgbGV2ZWw6IDYwLFxuICAgICAgcm93OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzZWxmLm9wdGlvbnMucm93TGltaXQgfHwgMTtcbiAgICAgIH0sXG4gICAgICBjb2x1bW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYub3B0aW9ucy5jb2xMaW1pdCB8fCAxO1xuICAgICAgfSxcbiAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgIHg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfSxcbiAgICAgICAgeTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZm9ybWF0OiB7XG4gICAgICAgIGRhdGU6ICclWScsXG4gICAgICAgIGxlZ2VuZDogJyVZJyxcbiAgICAgICAgY29ubmVjdG9yOiAnaW4nXG4gICAgICB9LFxuICAgICAgZXh0cmFjdFVuaXQ6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCkpLmdldFRpbWUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgZm9yICh2YXIgdHlwZSBpbiB0aGlzLl9kb21haW5UeXBlKSB7XG4gICAgaWYgKHRoaXMuX2RvbWFpblR5cGUuaGFzT3duUHJvcGVydHkodHlwZSkpIHtcbiAgICAgIHZhciBkID0gdGhpcy5fZG9tYWluVHlwZVt0eXBlXTtcbiAgICAgIHRoaXMuX2RvbWFpblR5cGVbJ3hfJyArIHR5cGVdID0ge1xuICAgICAgICBuYW1lOiAneF8nICsgdHlwZSxcbiAgICAgICAgbGV2ZWw6IGQudHlwZSxcbiAgICAgICAgbWF4SXRlbU51bWJlcjogZC5tYXhJdGVtTnVtYmVyLFxuICAgICAgICBkZWZhdWx0Um93TnVtYmVyOiBkLmRlZmF1bHRSb3dOdW1iZXIsXG4gICAgICAgIGRlZmF1bHRDb2x1bW5OdW1iZXI6IGQuZGVmYXVsdENvbHVtbk51bWJlcixcbiAgICAgICAgcm93OiBkLmNvbHVtbixcbiAgICAgICAgY29sdW1uOiBkLnJvdyxcbiAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICB4OiBkLnBvc2l0aW9uLnksXG4gICAgICAgICAgeTogZC5wb3NpdGlvbi54XG4gICAgICAgIH0sXG4gICAgICAgIGZvcm1hdDogZC5mb3JtYXQsXG4gICAgICAgIGV4dHJhY3RVbml0OiBkLmV4dHJhY3RVbml0XG4gICAgICB9O1xuICAgIH1cbiAgfSAvLyBSZWNvcmQgdGhlIGFkZHJlc3Mgb2YgdGhlIGxhc3QgaW5zZXJ0ZWQgZG9tYWluIHdoZW4gYnJvd3NpbmdcblxuXG4gIHRoaXMubGFzdEluc2VydGVkU3ZnID0gbnVsbDtcbiAgdGhpcy5fY29tcGxldGVkID0gZmFsc2U7IC8vIFJlY29yZCBhbGwgdGhlIHZhbGlkIGRvbWFpbnNcbiAgLy8gRWFjaCBkb21haW4gdmFsdWUgaXMgYSB0aW1lc3RhbXAgaW4gbWlsbGlzZWNvbmRzXG5cbiAgdGhpcy5fZG9tYWlucyA9IGQzLm1hcCgpO1xuICB0aGlzLmdyYXBoRGltID0ge1xuICAgIHdpZHRoOiAwLFxuICAgIGhlaWdodDogMFxuICB9O1xuICB0aGlzLmxlZ2VuZERpbSA9IHtcbiAgICB3aWR0aDogMCxcbiAgICBoZWlnaHQ6IDBcbiAgfTtcbiAgdGhpcy5OQVZJR0FURV9MRUZUID0gMTtcbiAgdGhpcy5OQVZJR0FURV9SSUdIVCA9IDI7IC8vIFZhcmlvdXMgdXBkYXRlIG1vZGUgd2hlbiB1c2luZyB0aGUgdXBkYXRlKCkgQVBJXG5cbiAgdGhpcy5SRVNFVF9BTExfT05fVVBEQVRFID0gMDtcbiAgdGhpcy5SRVNFVF9TSU5HTEVfT05fVVBEQVRFID0gMTtcbiAgdGhpcy5BUFBFTkRfT05fVVBEQVRFID0gMjtcbiAgdGhpcy5ERUZBVUxUX0xFR0VORF9NQVJHSU4gPSAxMDtcbiAgdGhpcy5yb290ID0gbnVsbDtcbiAgdGhpcy50b29sdGlwID0gbnVsbDtcbiAgdGhpcy5fbWF4RG9tYWluUmVhY2hlZCA9IGZhbHNlO1xuICB0aGlzLl9taW5Eb21haW5SZWFjaGVkID0gZmFsc2U7XG4gIHRoaXMuZG9tYWluUG9zaXRpb24gPSBuZXcgRG9tYWluUG9zaXRpb24oKTtcbiAgdGhpcy5MZWdlbmQgPSBudWxsO1xuICB0aGlzLmxlZ2VuZFNjYWxlID0gbnVsbDsgLy8gTGlzdCBvZiBkb21haW5zIHRoYXQgYXJlIHNraXBwZWQgYmVjYXVzZSBvZiBEU1RcbiAgLy8gQWxsIHRpbWVzIGJlbG9uZ2luZyB0byB0aGVzZSBkb21haW5zIHNob3VsZCBiZSByZS1hc3NpZ25lZCB0byB0aGUgcHJldmlvdXMgZG9tYWluXG5cbiAgdGhpcy5EU1REb21haW4gPSBbXTtcbiAgLyoqXG4gICAqIERpc3BsYXkgdGhlIGdyYXBoIGZvciB0aGUgZmlyc3QgdGltZVxuICAgKiBAcmV0dXJuIGJvb2wgVHJ1ZSBpZiB0aGUgY2FsZW5kYXIgaXMgY3JlYXRlZFxuICAgKi9cblxuICB0aGlzLl9pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHNlbGYuZ2V0RG9tYWluKHNlbGYub3B0aW9ucy5zdGFydCkubWFwKGZ1bmN0aW9uIChkKSB7XG4gICAgICByZXR1cm4gZC5nZXRUaW1lKCk7XG4gICAgfSkubWFwKGZ1bmN0aW9uIChkKSB7XG4gICAgICBzZWxmLl9kb21haW5zLnNldChkLCBzZWxmLmdldFN1YkRvbWFpbihkKS5tYXAoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0OiBzZWxmLl9kb21haW5UeXBlW3NlbGYub3B0aW9ucy5zdWJEb21haW5dLmV4dHJhY3RVbml0KGQpLFxuICAgICAgICAgIHY6IG51bGxcbiAgICAgICAgfTtcbiAgICAgIH0pKTtcbiAgICB9KTtcbiAgICBzZWxmLnJvb3QgPSBkMy5zZWxlY3Qoc2VsZi5vcHRpb25zLml0ZW1TZWxlY3RvcikuYXBwZW5kKCdzdmcnKS5hdHRyKCdjbGFzcycsICdjYWwtaGVhdG1hcC1jb250YWluZXInKTtcbiAgICBzZWxmLnJvb3QuYXR0cigneCcsIDApLmF0dHIoJ3knLCAwKS5hcHBlbmQoJ3N2ZycpLmF0dHIoJ2NsYXNzJywgJ2dyYXBoJyk7XG4gICAgc2VsZi5MZWdlbmQgPSBuZXcgTGVnZW5kKHNlbGYpO1xuXG4gICAgaWYgKHNlbGYub3B0aW9ucy5wYWludE9uTG9hZCkge1xuICAgICAgX2luaXRDYWxlbmRhcigpO1xuICAgIH1cblxuICAgIHNlbGYucm9vdC5jYWxsKHNlbGYudGlwKTtcbiAgICBzZWxmLnJvb3QuY2FsbChzZWxmLmxlZ2VuZFRpcCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgZnVuY3Rpb24gX2luaXRDYWxlbmRhcigpIHtcbiAgICBzZWxmLnZlcnRpY2FsRG9tYWluTGFiZWwgPSBzZWxmLm9wdGlvbnMubGFiZWwucG9zaXRpb24gPT09ICd0b3AnIHx8IHNlbGYub3B0aW9ucy5sYWJlbC5wb3NpdGlvbiA9PT0gJ2JvdHRvbSc7XG4gICAgc2VsZi5kb21haW5WZXJ0aWNhbExhYmVsSGVpZ2h0ID0gc2VsZi5vcHRpb25zLmxhYmVsLmhlaWdodCA9PT0gbnVsbCA/IE1hdGgubWF4KDI1LCBzZWxmLm9wdGlvbnMuY2VsbFNpemUgKiAyKSA6IHNlbGYub3B0aW9ucy5sYWJlbC5oZWlnaHQ7XG4gICAgc2VsZi5kb21haW5Ib3Jpem9udGFsTGFiZWxXaWR0aCA9IDA7XG5cbiAgICBpZiAoc2VsZi5vcHRpb25zLmRvbWFpbkxhYmVsRm9ybWF0ID09PSAnJyAmJiBzZWxmLm9wdGlvbnMubGFiZWwuaGVpZ2h0ID09PSBudWxsKSB7XG4gICAgICBzZWxmLmRvbWFpblZlcnRpY2FsTGFiZWxIZWlnaHQgPSAwO1xuICAgIH1cblxuICAgIGlmICghc2VsZi52ZXJ0aWNhbERvbWFpbkxhYmVsKSB7XG4gICAgICBzZWxmLmRvbWFpblZlcnRpY2FsTGFiZWxIZWlnaHQgPSAwO1xuICAgICAgc2VsZi5kb21haW5Ib3Jpem9udGFsTGFiZWxXaWR0aCA9IHNlbGYub3B0aW9ucy5sYWJlbC53aWR0aDtcbiAgICB9XG5cbiAgICBzZWxmLnBhaW50KCk7IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuICAgIC8vIEFUVEFDSElORyBET01BSU4gTkFWSUdBVElPTiBFVkVOVCAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cblxuICAgIGlmIChzZWxmLm9wdGlvbnMubmV4dFNlbGVjdG9yICE9PSBmYWxzZSkge1xuICAgICAgZDMuc2VsZWN0KHNlbGYub3B0aW9ucy5uZXh0U2VsZWN0b3IpLm9uKCdjbGljay4nICsgc2VsZi5vcHRpb25zLml0ZW1OYW1lc3BhY2UsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZDMuZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNlbGYubG9hZE5leHREb21haW4oMSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoc2VsZi5vcHRpb25zLnByZXZpb3VzU2VsZWN0b3IgIT09IGZhbHNlKSB7XG4gICAgICBkMy5zZWxlY3Qoc2VsZi5vcHRpb25zLnByZXZpb3VzU2VsZWN0b3IpLm9uKCdjbGljay4nICsgc2VsZi5vcHRpb25zLml0ZW1OYW1lc3BhY2UsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZDMuZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHNlbGYubG9hZFByZXZpb3VzRG9tYWluKDEpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2VsZi5MZWdlbmQucmVkcmF3KHNlbGYuZ3JhcGhEaW0ud2lkdGggLSBzZWxmLm9wdGlvbnMuZG9tYWluR3V0dGVyIC0gc2VsZi5vcHRpb25zLmNlbGxQYWRkaW5nKTtcbiAgICBzZWxmLmFmdGVyTG9hZCgpO1xuICAgIHZhciBkb21haW5zID0gc2VsZi5nZXREb21haW5LZXlzKCk7IC8vIEZpbGwgdGhlIGdyYXBoIHdpdGggc29tZSBkYXRhc1xuXG4gICAgaWYgKHNlbGYub3B0aW9ucy5sb2FkT25Jbml0KSB7XG4gICAgICBzZWxmLmdldERhdGFzKHNlbGYub3B0aW9ucy5kYXRhLCBuZXcgRGF0ZShkb21haW5zWzBdKSwgc2VsZi5nZXRTdWJEb21haW4oZG9tYWluc1tkb21haW5zLmxlbmd0aCAtIDFdKS5wb3AoKSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLmZpbGwoKTtcbiAgICAgICAgc2VsZi5vbkNvbXBsZXRlKCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5vbkNvbXBsZXRlKCk7XG4gICAgfVxuXG4gICAgc2VsZi5jaGVja0lmTWluRG9tYWluSXNSZWFjaGVkKGRvbWFpbnNbMF0pO1xuICAgIHNlbGYuY2hlY2tJZk1heERvbWFpbklzUmVhY2hlZChzZWxmLmdldE5leHREb21haW4oKS5nZXRUaW1lKCkpO1xuICB9IC8vIFJldHVybiB0aGUgd2lkdGggb2YgdGhlIGRvbWFpbiBibG9jaywgd2l0aG91dCB0aGUgZG9tYWluIGd1dHRlclxuICAvLyBAcGFyYW0gaW50IGQgRG9tYWluIHN0YXJ0IHRpbWVzdGFtcFxuXG5cbiAgZnVuY3Rpb24gdyhkLCBvdXRlcikge1xuICAgIHZhciB3aWR0aCA9IHNlbGYub3B0aW9ucy5jZWxsU2l6ZSAqIHNlbGYuX2RvbWFpblR5cGVbc2VsZi5vcHRpb25zLnN1YkRvbWFpbl0uY29sdW1uKGQpICsgc2VsZi5vcHRpb25zLmNlbGxQYWRkaW5nICogc2VsZi5fZG9tYWluVHlwZVtzZWxmLm9wdGlvbnMuc3ViRG9tYWluXS5jb2x1bW4oZCk7XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiAmJiBvdXRlciA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHdpZHRoICs9IHNlbGYuZG9tYWluSG9yaXpvbnRhbExhYmVsV2lkdGggKyBzZWxmLm9wdGlvbnMuZG9tYWluR3V0dGVyICsgc2VsZi5vcHRpb25zLmRvbWFpbk1hcmdpblsxXSArIHNlbGYub3B0aW9ucy5kb21haW5NYXJnaW5bM107XG4gICAgfVxuXG4gICAgcmV0dXJuIHdpZHRoO1xuICB9IC8vIFJldHVybiB0aGUgaGVpZ2h0IG9mIHRoZSBkb21haW4gYmxvY2ssIHdpdGhvdXQgdGhlIGRvbWFpbiBndXR0ZXJcblxuXG4gIGZ1bmN0aW9uIGgoZCwgb3V0ZXIpIHtcbiAgICB2YXIgaGVpZ2h0ID0gc2VsZi5vcHRpb25zLmNlbGxTaXplICogc2VsZi5fZG9tYWluVHlwZVtzZWxmLm9wdGlvbnMuc3ViRG9tYWluXS5yb3coZCkgKyBzZWxmLm9wdGlvbnMuY2VsbFBhZGRpbmcgKiBzZWxmLl9kb21haW5UeXBlW3NlbGYub3B0aW9ucy5zdWJEb21haW5dLnJvdyhkKTtcblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyICYmIG91dGVyID09PSB0cnVlKSB7XG4gICAgICBoZWlnaHQgKz0gc2VsZi5vcHRpb25zLmRvbWFpbkd1dHRlciArIHNlbGYuZG9tYWluVmVydGljYWxMYWJlbEhlaWdodCArIHNlbGYub3B0aW9ucy5kb21haW5NYXJnaW5bMF0gKyBzZWxmLm9wdGlvbnMuZG9tYWluTWFyZ2luWzJdO1xuICAgIH1cblxuICAgIHJldHVybiBoZWlnaHQ7XG4gIH1cbiAgLyoqXG4gICAqXG4gICAqXG4gICAqIEBwYXJhbSBpbnQgbmF2aWdhdGlvbkRpclxuICAgKi9cblxuXG4gIHRoaXMucGFpbnQgPSBmdW5jdGlvbiAobmF2aWdhdGlvbkRpcikge1xuICAgIHZhciBvcHRpb25zID0gc2VsZi5vcHRpb25zO1xuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIG5hdmlnYXRpb25EaXIgPSBmYWxzZTtcbiAgICB9IC8vIFBhaW50aW5nIGFsbCB0aGUgZG9tYWluc1xuXG5cbiAgICB2YXIgZG9tYWluU3ZnID0gc2VsZi5yb290LnNlbGVjdCgnLmdyYXBoJykuc2VsZWN0QWxsKCcuZ3JhcGgtZG9tYWluJykuZGF0YShmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZGF0YSA9IHNlbGYuZ2V0RG9tYWluS2V5cygpO1xuICAgICAgcmV0dXJuIG5hdmlnYXRpb25EaXIgPT09IHNlbGYuTkFWSUdBVEVfTEVGVCA/IGRhdGEucmV2ZXJzZSgpIDogZGF0YTtcbiAgICB9LCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIGQ7XG4gICAgfSk7XG4gICAgdmFyIGVudGVyaW5nRG9tYWluRGltID0gMDtcbiAgICB2YXIgZXhpdGluZ0RvbWFpbkRpbSA9IDA7IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuICAgIC8vIFBBSU5USU5HIERPTUFJTiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cbiAgICB2YXIgc3ZnID0gZG9tYWluU3ZnLmVudGVyKCkuYXBwZW5kKCdzdmcnKS5hdHRyKCd3aWR0aCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICByZXR1cm4gdyhkLCB0cnVlKTtcbiAgICB9KS5hdHRyKCdoZWlnaHQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIGgoZCwgdHJ1ZSk7XG4gICAgfSkuYXR0cigneCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICBpZiAob3B0aW9ucy52ZXJ0aWNhbE9yaWVudGF0aW9uKSB7XG4gICAgICAgIHNlbGYuZ3JhcGhEaW0ud2lkdGggPSBNYXRoLm1heChzZWxmLmdyYXBoRGltLndpZHRoLCB3KGQsIHRydWUpKTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZ2V0RG9tYWluUG9zaXRpb24oZCwgc2VsZi5ncmFwaERpbSwgJ3dpZHRoJywgdyhkLCB0cnVlKSk7XG4gICAgICB9XG4gICAgfSkuYXR0cigneScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICBpZiAob3B0aW9ucy52ZXJ0aWNhbE9yaWVudGF0aW9uKSB7XG4gICAgICAgIHJldHVybiBnZXREb21haW5Qb3NpdGlvbihkLCBzZWxmLmdyYXBoRGltLCAnaGVpZ2h0JywgaChkLCB0cnVlKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLmdyYXBoRGltLmhlaWdodCA9IE1hdGgubWF4KHNlbGYuZ3JhcGhEaW0uaGVpZ2h0LCBoKGQsIHRydWUpKTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgfSkuYXR0cignY2xhc3MnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgdmFyIGNsYXNzbmFtZSA9ICdncmFwaC1kb21haW4nO1xuICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkKTtcblxuICAgICAgc3dpdGNoIChvcHRpb25zLmRvbWFpbikge1xuICAgICAgICBjYXNlICdob3VyJzpcbiAgICAgICAgICBjbGFzc25hbWUgKz0gJyBoXycgKyBkYXRlLmdldEhvdXJzKCk7XG5cbiAgICAgICAgLyogZmFsbHMgdGhyb3VnaCAqL1xuXG4gICAgICAgIGNhc2UgJ2RheSc6XG4gICAgICAgICAgY2xhc3NuYW1lICs9ICcgZF8nICsgZGF0ZS5nZXREYXRlKCkgKyAnIGR5XycgKyBkYXRlLmdldERheSgpO1xuXG4gICAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi9cblxuICAgICAgICBjYXNlICd3ZWVrJzpcbiAgICAgICAgICBjbGFzc25hbWUgKz0gJyB3XycgKyBzZWxmLmdldFdlZWtOdW1iZXIoZGF0ZSk7XG5cbiAgICAgICAgLyogZmFsbHMgdGhyb3VnaCAqL1xuXG4gICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICBjbGFzc25hbWUgKz0gJyBtXycgKyAoZGF0ZS5nZXRNb250aCgpICsgMSk7XG5cbiAgICAgICAgLyogZmFsbHMgdGhyb3VnaCAqL1xuXG4gICAgICAgIGNhc2UgJ3llYXInOlxuICAgICAgICAgIGNsYXNzbmFtZSArPSAnIHlfJyArIGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNsYXNzbmFtZTtcbiAgICB9KTtcbiAgICBzZWxmLmxhc3RJbnNlcnRlZFN2ZyA9IHN2ZztcblxuICAgIGZ1bmN0aW9uIGdldERvbWFpblBvc2l0aW9uKGRvbWFpbkluZGV4LCBncmFwaERpbSwgYXhpcywgZG9tYWluRGltKSB7XG4gICAgICB2YXIgdG1wID0gMDtcblxuICAgICAgc3dpdGNoIChuYXZpZ2F0aW9uRGlyKSB7XG4gICAgICAgIGNhc2UgZmFsc2U6XG4gICAgICAgICAgdG1wID0gZ3JhcGhEaW1bYXhpc107XG4gICAgICAgICAgZ3JhcGhEaW1bYXhpc10gKz0gZG9tYWluRGltO1xuICAgICAgICAgIHNlbGYuZG9tYWluUG9zaXRpb24uc2V0UG9zaXRpb24oZG9tYWluSW5kZXgsIHRtcCk7XG4gICAgICAgICAgcmV0dXJuIHRtcDtcblxuICAgICAgICBjYXNlIHNlbGYuTkFWSUdBVEVfUklHSFQ6XG4gICAgICAgICAgc2VsZi5kb21haW5Qb3NpdGlvbi5zZXRQb3NpdGlvbihkb21haW5JbmRleCwgZ3JhcGhEaW1bYXhpc10pO1xuICAgICAgICAgIGVudGVyaW5nRG9tYWluRGltID0gZG9tYWluRGltO1xuICAgICAgICAgIGV4aXRpbmdEb21haW5EaW0gPSBzZWxmLmRvbWFpblBvc2l0aW9uLmdldFBvc2l0aW9uRnJvbUluZGV4KDEpO1xuICAgICAgICAgIHNlbGYuZG9tYWluUG9zaXRpb24uc2hpZnRSaWdodEJ5KGV4aXRpbmdEb21haW5EaW0pO1xuICAgICAgICAgIHJldHVybiBncmFwaERpbVtheGlzXTtcblxuICAgICAgICBjYXNlIHNlbGYuTkFWSUdBVEVfTEVGVDpcbiAgICAgICAgICB0bXAgPSAtZG9tYWluRGltO1xuICAgICAgICAgIGVudGVyaW5nRG9tYWluRGltID0gLXRtcDtcbiAgICAgICAgICBleGl0aW5nRG9tYWluRGltID0gZ3JhcGhEaW1bYXhpc10gLSBzZWxmLmRvbWFpblBvc2l0aW9uLmdldExhc3QoKTtcbiAgICAgICAgICBzZWxmLmRvbWFpblBvc2l0aW9uLnNldFBvc2l0aW9uKGRvbWFpbkluZGV4LCB0bXApO1xuICAgICAgICAgIHNlbGYuZG9tYWluUG9zaXRpb24uc2hpZnRMZWZ0QnkoZW50ZXJpbmdEb21haW5EaW0pO1xuICAgICAgICAgIHJldHVybiB0bXA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgc3ZnLmFwcGVuZCgncmVjdCcpLmF0dHIoJ3dpZHRoJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgIHJldHVybiB3KGQsIHRydWUpIC0gb3B0aW9ucy5kb21haW5HdXR0ZXIgLSBvcHRpb25zLmNlbGxQYWRkaW5nO1xuICAgIH0pLmF0dHIoJ2hlaWdodCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICByZXR1cm4gaChkLCB0cnVlKSAtIG9wdGlvbnMuZG9tYWluR3V0dGVyIC0gb3B0aW9ucy5jZWxsUGFkZGluZztcbiAgICB9KS5hdHRyKCdjbGFzcycsICdkb21haW4tYmFja2dyb3VuZCcpOyAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cbiAgICAvLyBQQUlOVElORyBTVUJET01BSU5TICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cbiAgICB2YXIgc3ViRG9tYWluU3ZnR3JvdXAgPSBzdmcuYXBwZW5kKCdzdmcnKS5hdHRyKCd4JywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKG9wdGlvbnMubGFiZWwucG9zaXRpb24gPT09ICdsZWZ0Jykge1xuICAgICAgICByZXR1cm4gc2VsZi5kb21haW5Ib3Jpem9udGFsTGFiZWxXaWR0aCArIG9wdGlvbnMuZG9tYWluTWFyZ2luWzNdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZG9tYWluTWFyZ2luWzNdO1xuICAgICAgfVxuICAgIH0pLmF0dHIoJ3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAob3B0aW9ucy5sYWJlbC5wb3NpdGlvbiA9PT0gJ3RvcCcpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZG9tYWluVmVydGljYWxMYWJlbEhlaWdodCArIG9wdGlvbnMuZG9tYWluTWFyZ2luWzBdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZG9tYWluTWFyZ2luWzBdO1xuICAgICAgfVxuICAgIH0pLmF0dHIoJ2NsYXNzJywgJ2dyYXBoLXN1YmRvbWFpbi1ncm91cCcpO1xuICAgIHZhciByZWN0ID0gc3ViRG9tYWluU3ZnR3JvdXAuc2VsZWN0QWxsKCdnJykuZGF0YShmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIHNlbGYuX2RvbWFpbnMuZ2V0KGQpO1xuICAgIH0pLmVudGVyKCkuYXBwZW5kKCdnJyk7XG4gICAgcmVjdC5hcHBlbmQoJ3JlY3QnKS5hdHRyKCdjbGFzcycsIGZ1bmN0aW9uIChkKSB7XG4gICAgICByZXR1cm4gJ2dyYXBoLXJlY3QnICsgc2VsZi5nZXRIaWdobGlnaHRDbGFzc05hbWUoZC50KSArIChvcHRpb25zLm9uQ2xpY2sgIT09IG51bGwgPyAnIGhvdmVyX2N1cnNvcicgOiAnJyk7XG4gICAgfSkuYXR0cignd2lkdGgnLCBvcHRpb25zLmNlbGxTaXplKS5hdHRyKCdoZWlnaHQnLCBvcHRpb25zLmNlbGxTaXplKS5hdHRyKCd4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgIHJldHVybiBzZWxmLnBvc2l0aW9uU3ViRG9tYWluWChkLnQpO1xuICAgIH0pLmF0dHIoJ3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIHNlbGYucG9zaXRpb25TdWJEb21haW5ZKGQudCk7XG4gICAgfSkub24oJ2NsaWNrJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgIGlmIChvcHRpb25zLm9uQ2xpY2sgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYub25DbGljayhuZXcgRGF0ZShkLnQpLCBkLnYpO1xuICAgICAgfVxuICAgIH0pLmNhbGwoZnVuY3Rpb24gKHNlbGVjdGlvbikge1xuICAgICAgaWYgKG9wdGlvbnMuY2VsbFJhZGl1cyA+IDApIHtcbiAgICAgICAgc2VsZWN0aW9uLmF0dHIoJ3J4Jywgb3B0aW9ucy5jZWxsUmFkaXVzKS5hdHRyKCdyeScsIG9wdGlvbnMuY2VsbFJhZGl1cyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChzZWxmLmxlZ2VuZFNjYWxlICE9PSBudWxsICYmIG9wdGlvbnMubGVnZW5kQ29sb3JzICE9PSBudWxsICYmIG9wdGlvbnMubGVnZW5kQ29sb3JzLmhhc093blByb3BlcnR5KCdiYXNlJykpIHtcbiAgICAgICAgc2VsZWN0aW9uLmF0dHIoJ2ZpbGwnLCBvcHRpb25zLmxlZ2VuZENvbG9ycy5iYXNlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMudG9vbHRpcCkge1xuICAgICAgICBzZWxlY3Rpb24ub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgc2VsZi50aXAuc2hvdyhkLCB0aGlzKTtcbiAgICAgICAgfSkub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHNlbGYudGlwLmhpZGUoZCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pOyAvLyBBcHBlbmRpbmcgYSB0aXRsZSB0byBlYWNoIHN1YmRvbWFpblxuXG4gICAgaWYgKCFvcHRpb25zLnRvb2x0aXApIHtcbiAgICAgIHJlY3QuYXBwZW5kKCd0aXRsZScpLnRleHQoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZm9ybWF0RGF0ZShuZXcgRGF0ZShkLnQpLCBvcHRpb25zLnN1YkRvbWFpbkRhdGVGb3JtYXQpO1xuICAgICAgfSk7XG4gICAgfSAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cbiAgICAvLyBQQUlOVElORyBMQUJFTCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cblxuICAgIGlmIChvcHRpb25zLmRvbWFpbkxhYmVsRm9ybWF0ICE9PSAnJykge1xuICAgICAgc3ZnLmFwcGVuZCgndGV4dCcpLmF0dHIoJ2NsYXNzJywgJ2dyYXBoLWxhYmVsJykuYXR0cigneScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHZhciB5ID0gb3B0aW9ucy5kb21haW5NYXJnaW5bMF07XG5cbiAgICAgICAgc3dpdGNoIChvcHRpb25zLmxhYmVsLnBvc2l0aW9uKSB7XG4gICAgICAgICAgY2FzZSAndG9wJzpcbiAgICAgICAgICAgIHkgKz0gc2VsZi5kb21haW5WZXJ0aWNhbExhYmVsSGVpZ2h0IC8gMjtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnYm90dG9tJzpcbiAgICAgICAgICAgIHkgKz0gaChkKSArIHNlbGYuZG9tYWluVmVydGljYWxMYWJlbEhlaWdodCAvIDI7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geSArIG9wdGlvbnMubGFiZWwub2Zmc2V0LnkgKiAob3B0aW9ucy5sYWJlbC5yb3RhdGUgPT09ICdyaWdodCcgJiYgb3B0aW9ucy5sYWJlbC5wb3NpdGlvbiA9PT0gJ3JpZ2h0JyB8fCBvcHRpb25zLmxhYmVsLnJvdGF0ZSA9PT0gJ2xlZnQnICYmIG9wdGlvbnMubGFiZWwucG9zaXRpb24gPT09ICdsZWZ0JyA/IC0xIDogMSk7XG4gICAgICB9KS5hdHRyKCd4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgdmFyIHggPSBvcHRpb25zLmRvbWFpbk1hcmdpblszXTtcblxuICAgICAgICBzd2l0Y2ggKG9wdGlvbnMubGFiZWwucG9zaXRpb24pIHtcbiAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICB4ICs9IHcoZCk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ2JvdHRvbSc6XG4gICAgICAgICAgY2FzZSAndG9wJzpcbiAgICAgICAgICAgIHggKz0gdyhkKSAvIDI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0aW9ucy5sYWJlbC5hbGlnbiA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgIHJldHVybiB4ICsgc2VsZi5kb21haW5Ib3Jpem9udGFsTGFiZWxXaWR0aCAtIG9wdGlvbnMubGFiZWwub2Zmc2V0LnggKiAob3B0aW9ucy5sYWJlbC5yb3RhdGUgPT09ICdyaWdodCcgPyAtMSA6IDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHggKyBvcHRpb25zLmxhYmVsLm9mZnNldC54O1xuICAgICAgfSkuYXR0cigndGV4dC1hbmNob3InLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN3aXRjaCAob3B0aW9ucy5sYWJlbC5hbGlnbikge1xuICAgICAgICAgIGNhc2UgJ3N0YXJ0JzpcbiAgICAgICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgICAgIHJldHVybiAnc3RhcnQnO1xuXG4gICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICByZXR1cm4gJ2VuZCc7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuICdtaWRkbGUnO1xuICAgICAgICB9XG4gICAgICB9KS5hdHRyKCdkb21pbmFudC1iYXNlbGluZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYudmVydGljYWxEb21haW5MYWJlbCA/ICdtaWRkbGUnIDogJ3RvcCc7XG4gICAgICB9KS50ZXh0KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmZvcm1hdERhdGUobmV3IERhdGUoZCksIG9wdGlvbnMuZG9tYWluTGFiZWxGb3JtYXQpO1xuICAgICAgfSkuY2FsbChkb21haW5Sb3RhdGUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRvbWFpblJvdGF0ZShzZWxlY3Rpb24pIHtcbiAgICAgIHN3aXRjaCAob3B0aW9ucy5sYWJlbC5yb3RhdGUpIHtcbiAgICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICAgIHNlbGVjdGlvbi5hdHRyKCd0cmFuc2Zvcm0nLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgdmFyIHMgPSAncm90YXRlKDkwKSwgJztcblxuICAgICAgICAgICAgc3dpdGNoIChvcHRpb25zLmxhYmVsLnBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcbiAgICAgICAgICAgICAgICBzICs9ICd0cmFuc2xhdGUoLScgKyB3KGQpICsgJyAsIC0nICsgdyhkKSArICcpJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgICAgICAgICBzICs9ICd0cmFuc2xhdGUoMCwgLScgKyBzZWxmLmRvbWFpbkhvcml6b250YWxMYWJlbFdpZHRoICsgJyknO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgICBzZWxlY3Rpb24uYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgIHZhciBzID0gJ3JvdGF0ZSgyNzApLCAnO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKG9wdGlvbnMubGFiZWwucG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICAgICAgICAgIHMgKz0gJ3RyYW5zbGF0ZSgtJyArICh3KGQpICsgc2VsZi5kb21haW5Ib3Jpem9udGFsTGFiZWxXaWR0aCkgKyAnICwgJyArIHcoZCkgKyAnKSc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAnbGVmdCc6XG4gICAgICAgICAgICAgICAgcyArPSAndHJhbnNsYXRlKC0nICsgc2VsZi5kb21haW5Ib3Jpem9udGFsTGFiZWxXaWR0aCArICcgLCAnICsgc2VsZi5kb21haW5Ib3Jpem9udGFsTGFiZWxXaWR0aCArICcpJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cbiAgICAvLyBQQUlOVElORyBET01BSU4gU1VCRE9NQUlOIENPTlRFTlQgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cblxuICAgIGlmIChvcHRpb25zLnN1YkRvbWFpblRleHRGb3JtYXQgIT09IG51bGwpIHtcbiAgICAgIHJlY3QuYXBwZW5kKCd0ZXh0JykuYXR0cignY2xhc3MnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICByZXR1cm4gJ3N1YmRvbWFpbi10ZXh0JyArIHNlbGYuZ2V0SGlnaGxpZ2h0Q2xhc3NOYW1lKGQudCk7XG4gICAgICB9KS5hdHRyKCd4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYucG9zaXRpb25TdWJEb21haW5YKGQudCkgKyBvcHRpb25zLmNlbGxTaXplIC8gMjtcbiAgICAgIH0pLmF0dHIoJ3knLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICByZXR1cm4gc2VsZi5wb3NpdGlvblN1YkRvbWFpblkoZC50KSArIG9wdGlvbnMuY2VsbFNpemUgLyAyO1xuICAgICAgfSkuYXR0cigndGV4dC1hbmNob3InLCAnbWlkZGxlJykuYXR0cignZG9taW5hbnQtYmFzZWxpbmUnLCAnY2VudHJhbCcpLnRleHQoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZm9ybWF0RGF0ZShuZXcgRGF0ZShkLnQpLCBvcHRpb25zLnN1YkRvbWFpblRleHRGb3JtYXQpO1xuICAgICAgfSk7XG4gICAgfSAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cbiAgICAvLyBBTklNQVRJT04gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cblxuICAgIGlmIChuYXZpZ2F0aW9uRGlyICE9PSBmYWxzZSkge1xuICAgICAgZG9tYWluU3ZnLnRyYW5zaXRpb24oKS5kdXJhdGlvbihvcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uKS5hdHRyKCd4JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVydGljYWxPcmllbnRhdGlvbiA/IDAgOiBzZWxmLmRvbWFpblBvc2l0aW9uLmdldFBvc2l0aW9uKGQpO1xuICAgICAgfSkuYXR0cigneScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcnRpY2FsT3JpZW50YXRpb24gPyBzZWxmLmRvbWFpblBvc2l0aW9uLmdldFBvc2l0aW9uKGQpIDogMDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciB0ZW1wV2lkdGggPSBzZWxmLmdyYXBoRGltLndpZHRoO1xuICAgIHZhciB0ZW1wSGVpZ2h0ID0gc2VsZi5ncmFwaERpbS5oZWlnaHQ7XG5cbiAgICBpZiAob3B0aW9ucy52ZXJ0aWNhbE9yaWVudGF0aW9uKSB7XG4gICAgICBzZWxmLmdyYXBoRGltLmhlaWdodCArPSBlbnRlcmluZ0RvbWFpbkRpbSAtIGV4aXRpbmdEb21haW5EaW07XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGYuZ3JhcGhEaW0ud2lkdGggKz0gZW50ZXJpbmdEb21haW5EaW0gLSBleGl0aW5nRG9tYWluRGltO1xuICAgIH0gLy8gQXQgdGhlIHRpbWUgb2YgZXhpdCwgZG9tYWluc1dpZHRoIGFuZCBkb21haW5zSGVpZ2h0IGFscmVhZHkgYXV0b21hdGljYWxseSBzaGlmdGVkXG5cblxuICAgIGRvbWFpblN2Zy5leGl0KCkudHJhbnNpdGlvbigpLmR1cmF0aW9uKG9wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb24pLmF0dHIoJ3gnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgaWYgKG9wdGlvbnMudmVydGljYWxPcmllbnRhdGlvbikge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN3aXRjaCAobmF2aWdhdGlvbkRpcikge1xuICAgICAgICAgIGNhc2Ugc2VsZi5OQVZJR0FURV9MRUZUOlxuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKHNlbGYuZ3JhcGhEaW0ud2lkdGgsIHRlbXBXaWR0aCk7XG5cbiAgICAgICAgICBjYXNlIHNlbGYuTkFWSUdBVEVfUklHSFQ6XG4gICAgICAgICAgICByZXR1cm4gLXcoZCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KS5hdHRyKCd5JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgIGlmIChvcHRpb25zLnZlcnRpY2FsT3JpZW50YXRpb24pIHtcbiAgICAgICAgc3dpdGNoIChuYXZpZ2F0aW9uRGlyKSB7XG4gICAgICAgICAgY2FzZSBzZWxmLk5BVklHQVRFX0xFRlQ6XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oc2VsZi5ncmFwaERpbS5oZWlnaHQsIHRlbXBIZWlnaHQpO1xuXG4gICAgICAgICAgY2FzZSBzZWxmLk5BVklHQVRFX1JJR0hUOlxuICAgICAgICAgICAgcmV0dXJuIC1oKGQsIHRydWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cbiAgICB9KS5yZW1vdmUoKTsgLy8gUmVzaXplIHRoZSByb290IGNvbnRhaW5lclxuXG4gICAgc2VsZi5yZXNpemUoKTtcbiAgfTtcbn07XG5cbkNhbEhlYXRNYXAucHJvdG90eXBlID0ge1xuICAvKipcbiAgICogVmFsaWRhdGUgYW5kIG1lcmdlIHVzZXIgc2V0dGluZ3Mgd2l0aCBkZWZhdWx0IHNldHRpbmdzXG4gICAqXG4gICAqIEBwYXJhbSAge29iamVjdH0gc2V0dGluZ3MgVXNlciBzZXR0aW5nc1xuICAgKiBAcmV0dXJuIHtib29sfSBGYWxzZSBpZiBzZXR0aW5ncyBjb250YWlucyBlcnJvclxuICAgKi9cblxuICAvKiBqc2hpbnQgbWF4c3RhdGVtZW50czpmYWxzZSAqL1xuICBpbml0OiBmdW5jdGlvbiAoc2V0dGluZ3MpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgcGFyZW50ID0gdGhpcztcbiAgICB2YXIgb3B0aW9ucyA9IHBhcmVudC5vcHRpb25zID0gbWVyZ2VSZWN1cnNpdmUocGFyZW50Lm9wdGlvbnMsIHNldHRpbmdzKTsgLy8gRmF0YWwgZXJyb3JzXG4gICAgLy8gU3RvcCBzY3JpcHQgZXhlY3V0aW9uIG9uIGVycm9yXG5cbiAgICB2YWxpZGF0ZURvbWFpblR5cGUoKTtcbiAgICB2YWxpZGF0ZVNlbGVjdG9yKG9wdGlvbnMuaXRlbVNlbGVjdG9yLCBmYWxzZSwgJ2l0ZW1TZWxlY3RvcicpO1xuXG4gICAgaWYgKHBhcmVudC5hbGxvd2VkRGF0YVR5cGUuaW5kZXhPZihvcHRpb25zLmRhdGFUeXBlKSA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBkYXRhIHR5cGUgJ1wiICsgb3B0aW9ucy5kYXRhVHlwZSArIFwiJyBpcyBub3QgdmFsaWQgZGF0YSB0eXBlXCIpO1xuICAgIH1cblxuICAgIGlmIChkMy5zZWxlY3Qob3B0aW9ucy5pdGVtU2VsZWN0b3IpWzBdWzBdID09PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgbm9kZSAnXCIgKyBvcHRpb25zLml0ZW1TZWxlY3RvciArIFwiJyBzcGVjaWZpZWQgaW4gaXRlbVNlbGVjdG9yIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgdmFsaWRhdGVTZWxlY3RvcihvcHRpb25zLm5leHRTZWxlY3RvciwgdHJ1ZSwgJ25leHRTZWxlY3RvcicpO1xuICAgICAgdmFsaWRhdGVTZWxlY3RvcihvcHRpb25zLnByZXZpb3VzU2VsZWN0b3IsIHRydWUsICdwcmV2aW91c1NlbGVjdG9yJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yLm1lc3NhZ2UpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gLy8gSWYgb3RoZXIgc2V0dGluZ3MgY29udGFpbnMgZXJyb3IsIHdpbGwgZmFsbGJhY2sgdG8gZGVmYXVsdFxuXG5cbiAgICBpZiAoIXNldHRpbmdzLmhhc093blByb3BlcnR5KCdzdWJEb21haW4nKSkge1xuICAgICAgdGhpcy5vcHRpb25zLnN1YkRvbWFpbiA9IGdldE9wdGltYWxTdWJEb21haW4oc2V0dGluZ3MuZG9tYWluKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMuaXRlbU5hbWVzcGFjZSAhPT0gJ3N0cmluZycgfHwgb3B0aW9ucy5pdGVtTmFtZXNwYWNlID09PSAnJykge1xuICAgICAgY29uc29sZS5sb2coJ2l0ZW1OYW1lc3BhY2UgY2FuIG5vdCBiZSBlbXB0eSwgZmFsbGluZyBiYWNrIHRvIGNhbC1oZWF0bWFwJyk7XG4gICAgICBvcHRpb25zLml0ZW1OYW1lc3BhY2UgPSAnY2FsLWhlYXRtYXAnO1xuICAgIH0gLy8gRG9uJ3QgdG91Y2ggdGhlc2Ugc2V0dGluZ3NcblxuXG4gICAgdmFyIHMgPSBbJ2RhdGEnLCAnb25Db21wbGV0ZScsICdvbkNsaWNrJywgJ2FmdGVyTG9hZCcsICdhZnRlckxvYWREYXRhJywgJ2FmdGVyTG9hZFByZXZpb3VzRG9tYWluJywgJ2FmdGVyTG9hZE5leHREb21haW4nLCAnYWZ0ZXJVcGRhdGUnXTtcblxuICAgIGZvciAodmFyIGsgaW4gcykge1xuICAgICAgaWYgKHNldHRpbmdzLmhhc093blByb3BlcnR5KHNba10pKSB7XG4gICAgICAgIG9wdGlvbnNbc1trXV0gPSBzZXR0aW5nc1tzW2tdXTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBvcHRpb25zLnN1YkRvbWFpbkRhdGVGb3JtYXQgPSB0eXBlb2Ygb3B0aW9ucy5zdWJEb21haW5EYXRlRm9ybWF0ID09PSAnc3RyaW5nJyB8fCB0eXBlb2Ygb3B0aW9ucy5zdWJEb21haW5EYXRlRm9ybWF0ID09PSAnZnVuY3Rpb24nID8gb3B0aW9ucy5zdWJEb21haW5EYXRlRm9ybWF0IDogdGhpcy5fZG9tYWluVHlwZVtvcHRpb25zLnN1YkRvbWFpbl0uZm9ybWF0LmRhdGU7XG4gICAgb3B0aW9ucy5kb21haW5MYWJlbEZvcm1hdCA9IHR5cGVvZiBvcHRpb25zLmRvbWFpbkxhYmVsRm9ybWF0ID09PSAnc3RyaW5nJyB8fCB0eXBlb2Ygb3B0aW9ucy5kb21haW5MYWJlbEZvcm1hdCA9PT0gJ2Z1bmN0aW9uJyA/IG9wdGlvbnMuZG9tYWluTGFiZWxGb3JtYXQgOiB0aGlzLl9kb21haW5UeXBlW29wdGlvbnMuZG9tYWluXS5mb3JtYXQubGVnZW5kO1xuICAgIG9wdGlvbnMuc3ViRG9tYWluVGV4dEZvcm1hdCA9IHR5cGVvZiBvcHRpb25zLnN1YkRvbWFpblRleHRGb3JtYXQgPT09ICdzdHJpbmcnICYmIG9wdGlvbnMuc3ViRG9tYWluVGV4dEZvcm1hdCAhPT0gJycgfHwgdHlwZW9mIG9wdGlvbnMuc3ViRG9tYWluVGV4dEZvcm1hdCA9PT0gJ2Z1bmN0aW9uJyA/IG9wdGlvbnMuc3ViRG9tYWluVGV4dEZvcm1hdCA6IG51bGw7XG4gICAgb3B0aW9ucy5kb21haW5NYXJnaW4gPSBleHBhbmRNYXJnaW5TZXR0aW5nKG9wdGlvbnMuZG9tYWluTWFyZ2luKTtcbiAgICBvcHRpb25zLmxlZ2VuZE1hcmdpbiA9IGV4cGFuZE1hcmdpblNldHRpbmcob3B0aW9ucy5sZWdlbmRNYXJnaW4pO1xuICAgIG9wdGlvbnMuaGlnaGxpZ2h0ID0gcGFyZW50LmV4cGFuZERhdGVTZXR0aW5nKG9wdGlvbnMuaGlnaGxpZ2h0KTtcbiAgICBvcHRpb25zLml0ZW1OYW1lID0gZXhwYW5kSXRlbU5hbWUob3B0aW9ucy5pdGVtTmFtZSk7XG4gICAgb3B0aW9ucy5jb2xMaW1pdCA9IHBhcnNlQ29sTGltaXQob3B0aW9ucy5jb2xMaW1pdCk7XG4gICAgb3B0aW9ucy5yb3dMaW1pdCA9IHBhcnNlUm93TGltaXQob3B0aW9ucy5yb3dMaW1pdCk7XG5cbiAgICBpZiAoIXNldHRpbmdzLmhhc093blByb3BlcnR5KCdsZWdlbmRNYXJnaW4nKSkge1xuICAgICAgYXV0b0FkZExlZ2VuZE1hcmdpbigpO1xuICAgIH1cblxuICAgIGF1dG9BbGlnbkxhYmVsKCk7XG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgdGhhdCBhIHF1ZXJ5U3RyaW5nIGlzIHZhbGlkXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtFbGVtZW50fHN0cmluZ3xib29sfSBzZWxlY3RvciAgIFRoZSBxdWVyeVN0cmluZyB0byB0ZXN0XG4gICAgICogQHBhcmFtICB7Ym9vbH0gIGNhbkJlRmFsc2UgIFdoZXRoZXIgZmFsc2UgaXMgYW4gYWNjZXB0ZWQgYW5kIHZhbGlkIHZhbHVlXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBuYW1lICAgIE5hbWUgb2YgdGhlIHRlc3RlZCBzZWxlY3RvclxuICAgICAqIEB0aHJvd3Mge0Vycm9yfSAgICAgICAgSWYgdGhlIHNlbGVjdG9yIGlzIG5vdCB2YWxpZFxuICAgICAqIEByZXR1cm4ge2Jvb2x9ICAgICAgICBUcnVlIGlmIHRoZSBzZWxlY3RvciBpcyBhIHZhbGlkIHF1ZXJ5U3RyaW5nXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiB2YWxpZGF0ZVNlbGVjdG9yKHNlbGVjdG9yLCBjYW5CZUZhbHNlLCBuYW1lKSB7XG4gICAgICBpZiAoKGNhbkJlRmFsc2UgJiYgc2VsZWN0b3IgPT09IGZhbHNlIHx8IHNlbGVjdG9yIGluc3RhbmNlb2YgRWxlbWVudCB8fCB0eXBlb2Ygc2VsZWN0b3IgPT09ICdzdHJpbmcnKSAmJiBzZWxlY3RvciAhPT0gJycpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHRocm93IG5ldyBFcnJvcignVGhlICcgKyBuYW1lICsgJyBpcyBub3QgdmFsaWQnKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBvcHRpbWFsIHN1YkRvbWFpbiBmb3IgdGhlIHNwZWNpZmllZCBkb21haW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gZG9tYWluIGEgZG9tYWluIG5hbWVcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9ICAgICAgICB0aGUgc3ViRG9tYWluIG5hbWVcbiAgICAgKi9cblxuXG4gICAgZnVuY3Rpb24gZ2V0T3B0aW1hbFN1YkRvbWFpbihkb21haW4pIHtcbiAgICAgIHN3aXRjaCAoZG9tYWluKSB7XG4gICAgICAgIGNhc2UgJ3llYXInOlxuICAgICAgICAgIHJldHVybiAnbW9udGgnO1xuXG4gICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICByZXR1cm4gJ2RheSc7XG5cbiAgICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgICAgcmV0dXJuICdkYXknO1xuXG4gICAgICAgIGNhc2UgJ2RheSc6XG4gICAgICAgICAgcmV0dXJuICdob3VyJztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiAnbWluJztcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5zdXJlIHRoYXQgdGhlIGRvbWFpbiBhbmQgc3ViZG9tYWluIGFyZSB2YWxpZFxuICAgICAqXG4gICAgICogQHRocm93IHtFcnJvcn0gd2hlbiBkb21haW4gb3Igc3ViZG9tYWluIGFyZSBub3QgdmFsaWRcbiAgICAgKiBAcmV0dXJuIHtib29sfSBUcnVlIGlmIGRvbWFpbiBhbmQgc3ViZG9tYWluIGFyZSB2YWxpZCBhbmQgY29tcGF0aWJsZVxuICAgICAqL1xuXG5cbiAgICBmdW5jdGlvbiB2YWxpZGF0ZURvbWFpblR5cGUoKSB7XG4gICAgICBpZiAoIXBhcmVudC5fZG9tYWluVHlwZS5oYXNPd25Qcm9wZXJ0eShvcHRpb25zLmRvbWFpbikgfHwgb3B0aW9ucy5kb21haW4gPT09ICdtaW4nIHx8IG9wdGlvbnMuZG9tYWluLnN1YnN0cmluZygwLCAyKSA9PT0gJ3hfJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgZG9tYWluICdcIiArIG9wdGlvbnMuZG9tYWluICsgXCInIGlzIG5vdCB2YWxpZFwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFwYXJlbnQuX2RvbWFpblR5cGUuaGFzT3duUHJvcGVydHkob3B0aW9ucy5zdWJEb21haW4pIHx8IG9wdGlvbnMuc3ViRG9tYWluID09PSAneWVhcicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN1YkRvbWFpbiAnXCIgKyBvcHRpb25zLnN1YkRvbWFpbiArIFwiJyBpcyBub3QgdmFsaWRcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJlbnQuX2RvbWFpblR5cGVbb3B0aW9ucy5kb21haW5dLmxldmVsIDw9IHBhcmVudC5fZG9tYWluVHlwZVtvcHRpb25zLnN1YkRvbWFpbl0ubGV2ZWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ1wiICsgb3B0aW9ucy5zdWJEb21haW4gKyBcIicgaXMgbm90IGEgdmFsaWQgc3ViRG9tYWluIHRvICdcIiArIG9wdGlvbnMuZG9tYWluICsgXCInXCIpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmluZS10dW5lIHRoZSBsYWJlbCBhbGlnbmVtZW50IGRlcGVuZGluZyBvbiBpdHMgcG9zaXRpb25cbiAgICAgKlxuICAgICAqIEByZXR1cm4gdm9pZFxuICAgICAqL1xuXG5cbiAgICBmdW5jdGlvbiBhdXRvQWxpZ25MYWJlbCgpIHtcbiAgICAgIC8vIEF1dG8tYWxpZ24gbGFiZWwsIGRlcGVuZGluZyBvbiBpdCdzIHBvc2l0aW9uXG4gICAgICBpZiAoIXNldHRpbmdzLmhhc093blByb3BlcnR5KCdsYWJlbCcpIHx8IHNldHRpbmdzLmhhc093blByb3BlcnR5KCdsYWJlbCcpICYmICFzZXR0aW5ncy5sYWJlbC5oYXNPd25Qcm9wZXJ0eSgnYWxpZ24nKSkge1xuICAgICAgICBzd2l0Y2ggKG9wdGlvbnMubGFiZWwucG9zaXRpb24pIHtcbiAgICAgICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgICAgIG9wdGlvbnMubGFiZWwuYWxpZ24gPSAncmlnaHQnO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICBvcHRpb25zLmxhYmVsLmFsaWduID0gJ2xlZnQnO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgb3B0aW9ucy5sYWJlbC5hbGlnbiA9ICdjZW50ZXInO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMubGFiZWwucm90YXRlID09PSAnbGVmdCcpIHtcbiAgICAgICAgICBvcHRpb25zLmxhYmVsLmFsaWduID0gJ3JpZ2h0JztcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmxhYmVsLnJvdGF0ZSA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgIG9wdGlvbnMubGFiZWwuYWxpZ24gPSAnbGVmdCc7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCFzZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eSgnbGFiZWwnKSB8fCBzZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eSgnbGFiZWwnKSAmJiAhc2V0dGluZ3MubGFiZWwuaGFzT3duUHJvcGVydHkoJ29mZnNldCcpKSB7XG4gICAgICAgIGlmIChvcHRpb25zLmxhYmVsLnBvc2l0aW9uID09PSAnbGVmdCcgfHwgb3B0aW9ucy5sYWJlbC5wb3NpdGlvbiA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgIG9wdGlvbnMubGFiZWwub2Zmc2V0ID0ge1xuICAgICAgICAgICAgeDogMTAsXG4gICAgICAgICAgICB5OiAxNVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSWYgbm90IHNwZWNpZmllZCwgYWRkIHNvbWUgbWFyZ2luIGFyb3VuZCB0aGUgbGVnZW5kIGRlcGVuZGluZyBvbiBpdHMgcG9zaXRpb25cbiAgICAgKlxuICAgICAqIEByZXR1cm4gdm9pZFxuICAgICAqL1xuXG5cbiAgICBmdW5jdGlvbiBhdXRvQWRkTGVnZW5kTWFyZ2luKCkge1xuICAgICAgc3dpdGNoIChvcHRpb25zLmxlZ2VuZFZlcnRpY2FsUG9zaXRpb24pIHtcbiAgICAgICAgY2FzZSAndG9wJzpcbiAgICAgICAgICBvcHRpb25zLmxlZ2VuZE1hcmdpblsyXSA9IHBhcmVudC5ERUZBVUxUX0xFR0VORF9NQVJHSU47XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnYm90dG9tJzpcbiAgICAgICAgICBvcHRpb25zLmxlZ2VuZE1hcmdpblswXSA9IHBhcmVudC5ERUZBVUxUX0xFR0VORF9NQVJHSU47XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnbWlkZGxlJzpcbiAgICAgICAgY2FzZSAnY2VudGVyJzpcbiAgICAgICAgICBvcHRpb25zLmxlZ2VuZE1hcmdpbltvcHRpb25zLmxlZ2VuZEhvcml6b250YWxQb3NpdGlvbiA9PT0gJ3JpZ2h0JyA/IDMgOiAxXSA9IHBhcmVudC5ERUZBVUxUX0xFR0VORF9NQVJHSU47XG4gICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4cGFuZCBhIG51bWJlciBvZiBhbiBhcnJheSBvZiBudW1iZXJzIHRvIGFuIHVzYWJsZSA0IHZhbHVlcyBhcnJheVxuICAgICAqXG4gICAgICogQHBhcmFtICB7aW50ZWdlcnxhcnJheX0gdmFsdWVcbiAgICAgKiBAcmV0dXJuIHthcnJheX0gICAgICAgIGFycmF5XG4gICAgICovXG5cblxuICAgIGZ1bmN0aW9uIGV4cGFuZE1hcmdpblNldHRpbmcodmFsdWUpIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHZhbHVlID0gW3ZhbHVlXTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnTWFyZ2luIG9ubHkgdGFrZXMgYW4gaW50ZWdlciBvciBhbiBhcnJheSBvZiBpbnRlZ2VycycpO1xuICAgICAgICB2YWx1ZSA9IFswXTtcbiAgICAgIH1cblxuICAgICAgc3dpdGNoICh2YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIHJldHVybiBbdmFsdWVbMF0sIHZhbHVlWzBdLCB2YWx1ZVswXSwgdmFsdWVbMF1dO1xuXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICByZXR1cm4gW3ZhbHVlWzBdLCB2YWx1ZVsxXSwgdmFsdWVbMF0sIHZhbHVlWzFdXTtcblxuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgcmV0dXJuIFt2YWx1ZVswXSwgdmFsdWVbMV0sIHZhbHVlWzJdLCB2YWx1ZVsxXV07XG5cbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiB2YWx1ZS5zbGljZSgwLCA0KTtcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydCBhIHN0cmluZyB0byBhbiBhcnJheSBsaWtlIFtzaW5ndWxhci1mb3JtLCBwbHVyYWwtZm9ybV1cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge3N0cmluZ3xhcnJheX0gdmFsdWUgRGF0ZSB0byBjb252ZXJ0XG4gICAgICogQHJldHVybiB7YXJyYXl9ICAgICAgIEFuIGFycmF5IGxpa2UgW3Npbmd1bGFyLWZvcm0sIHBsdXJhbC1mb3JtXVxuICAgICAqL1xuXG5cbiAgICBmdW5jdGlvbiBleHBhbmRJdGVtTmFtZSh2YWx1ZSkge1xuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIFt2YWx1ZSwgdmFsdWUgKyAodmFsdWUgIT09ICcnID8gJ3MnIDogJycpXTtcbiAgICAgIH1cblxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICByZXR1cm4gW3ZhbHVlWzBdLCB2YWx1ZVswXSArICdzJ107XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUubGVuZ3RoID4gMikge1xuICAgICAgICAgIHJldHVybiB2YWx1ZS5zbGljZSgwLCAyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFsnaXRlbScsICdpdGVtcyddO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlQ29sTGltaXQodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZSA+IDAgPyB2YWx1ZSA6IG51bGw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VSb3dMaW1pdCh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID4gMCAmJiBvcHRpb25zLmNvbExpbWl0ID4gMCkge1xuICAgICAgICBjb25zb2xlLmxvZygnY29sTGltaXQgYW5kIHJvd0xpbWl0IGFyZSBtdXR1YWxseSBleGNsdXNpdmUsIHJvd0xpbWl0IHdpbGwgYmUgaWdub3JlZCcpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZhbHVlID4gMCA/IHZhbHVlIDogbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5faW5pdCgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IGEga2V5d29yZCBvciBhbiBhcnJheSBvZiBrZXl3b3JkL2RhdGUgdG8gYW4gYXJyYXkgb2YgZGF0ZSBvYmplY3RzXG4gICAqXG4gICAqIEBwYXJhbSAge3N0cmluZ3xhcnJheXxEYXRlfSB2YWx1ZSBEYXRhIHRvIGNvbnZlcnRcbiAgICogQHJldHVybiB7YXJyYXl9ICAgICAgIEFuIGFycmF5IG9mIERhdGVzXG4gICAqL1xuICBleHBhbmREYXRlU2V0dGluZzogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgdmFsdWUgPSBbdmFsdWVdO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZS5tYXAoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIGlmIChkYXRhID09PSAnbm93Jykge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChkKSB7XG4gICAgICByZXR1cm4gZCAhPT0gZmFsc2U7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEZpbGwgdGhlIGNhbGVuZGFyIGJ5IGNvbG9yaW5nIHRoZSBjZWxsc1xuICAgKlxuICAgKiBAcGFyYW0gYXJyYXkgc3ZnIEFuIGFycmF5IG9mIGh0bWwgbm9kZSB0byBhcHBseSB0aGUgdHJhbnNmb3JtYXRpb24gdG8gKG9wdGlvbmFsKVxuICAgKiAgICAgICAgICAgICAgICAgIEl0J3MgdXNlZCB0byBsaW1pdCB0aGUgcGFpbnRpbmcgdG8gb25seSBhIHN1YnNldCBvZiB0aGUgY2FsZW5kYXJcbiAgICogQHJldHVybiB2b2lkXG4gICAqL1xuICBmaWxsOiBmdW5jdGlvbiAoc3ZnKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHBhcmVudCA9IHRoaXM7XG4gICAgdmFyIG9wdGlvbnMgPSBwYXJlbnQub3B0aW9ucztcblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBzdmcgPSBwYXJlbnQucm9vdC5zZWxlY3RBbGwoJy5ncmFwaC1kb21haW4nKTtcbiAgICB9XG5cbiAgICB2YXIgcmVjdCA9IHN2Zy5zZWxlY3RBbGwoJ3N2ZycpLnNlbGVjdEFsbCgnZycpLmRhdGEoZnVuY3Rpb24gKGQpIHtcbiAgICAgIHJldHVybiBwYXJlbnQuX2RvbWFpbnMuZ2V0KGQpO1xuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIENvbG9yaXplIHRoZSBjZWxsIHZpYSBhIHN0eWxlIGF0dHJpYnV0ZSBpZiBlbmFibGVkXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBhZGRTdHlsZShlbGVtZW50KSB7XG4gICAgICBpZiAocGFyZW50LmxlZ2VuZFNjYWxlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgZWxlbWVudC5hdHRyKCdmaWxsJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgaWYgKGQudiA9PT0gbnVsbCAmJiBvcHRpb25zLmhhc093blByb3BlcnR5KCdjb25zaWRlck1pc3NpbmdEYXRhQXNaZXJvJykgJiYgIW9wdGlvbnMuY29uc2lkZXJNaXNzaW5nRGF0YUFzWmVybykge1xuICAgICAgICAgIGlmIChvcHRpb25zLmxlZ2VuZENvbG9ycy5oYXNPd25Qcm9wZXJ0eSgnYmFzZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gb3B0aW9ucy5sZWdlbmRDb2xvcnMuYmFzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0aW9ucy5sZWdlbmRDb2xvcnMgIT09IG51bGwgJiYgb3B0aW9ucy5sZWdlbmRDb2xvcnMuaGFzT3duUHJvcGVydHkoJ2VtcHR5JykgJiYgKGQudiA9PT0gMCB8fCBkLnYgPT09IG51bGwgJiYgb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgnY29uc2lkZXJNaXNzaW5nRGF0YUFzWmVybycpICYmIG9wdGlvbnMuY29uc2lkZXJNaXNzaW5nRGF0YUFzWmVybykpIHtcbiAgICAgICAgICByZXR1cm4gb3B0aW9ucy5sZWdlbmRDb2xvcnMuZW1wdHk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZC52IDwgMCAmJiBvcHRpb25zLmxlZ2VuZFswXSA+IDAgJiYgb3B0aW9ucy5sZWdlbmRDb2xvcnMgIT09IG51bGwgJiYgb3B0aW9ucy5sZWdlbmRDb2xvcnMuaGFzT3duUHJvcGVydHkoJ292ZXJmbG93JykpIHtcbiAgICAgICAgICByZXR1cm4gb3B0aW9ucy5sZWdlbmRDb2xvcnMub3ZlcmZsb3c7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcGFyZW50LmxlZ2VuZFNjYWxlKE1hdGgubWluKGQudiwgb3B0aW9ucy5sZWdlbmRbb3B0aW9ucy5sZWdlbmQubGVuZ3RoIC0gMV0pKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJlY3QudHJhbnNpdGlvbigpLmR1cmF0aW9uKG9wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb24pLnNlbGVjdCgncmVjdCcpLmF0dHIoJ2NsYXNzJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgIHZhciBodG1sQ2xhc3MgPSBwYXJlbnQuZ2V0SGlnaGxpZ2h0Q2xhc3NOYW1lKGQudCkudHJpbSgpLnNwbGl0KCcgJyk7XG4gICAgICB2YXIgcGFzdERhdGUgPSBwYXJlbnQuZGF0ZUlzTGVzc1RoYW4oZC50LCBuZXcgRGF0ZSgpKTtcbiAgICAgIHZhciBzYW1lRGF0ZSA9IHBhcmVudC5kYXRlSXNFcXVhbChkLnQsIG5ldyBEYXRlKCkpO1xuXG4gICAgICBpZiAocGFyZW50LmxlZ2VuZFNjYWxlID09PSBudWxsIHx8IGQudiA9PT0gbnVsbCAmJiBvcHRpb25zLmhhc093blByb3BlcnR5KCdjb25zaWRlck1pc3NpbmdEYXRhQXNaZXJvJykgJiYgIW9wdGlvbnMuY29uc2lkZXJNaXNzaW5nRGF0YUFzWmVybyAmJiAhb3B0aW9ucy5sZWdlbmRDb2xvcnMuaGFzT3duUHJvcGVydHkoJ2Jhc2UnKSkge1xuICAgICAgICBodG1sQ2xhc3MucHVzaCgnZ3JhcGgtcmVjdCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2FtZURhdGUpIHtcbiAgICAgICAgaHRtbENsYXNzLnB1c2goJ25vdycpO1xuICAgICAgfSBlbHNlIGlmICghcGFzdERhdGUpIHtcbiAgICAgICAgaHRtbENsYXNzLnB1c2goJ2Z1dHVyZScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZC52ICE9PSBudWxsKSB7XG4gICAgICAgIGh0bWxDbGFzcy5wdXNoKHBhcmVudC5MZWdlbmQuZ2V0Q2xhc3MoZC52LCBwYXJlbnQubGVnZW5kU2NhbGUgPT09IG51bGwpKTtcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5jb25zaWRlck1pc3NpbmdEYXRhQXNaZXJvICYmIHBhc3REYXRlKSB7XG4gICAgICAgIGh0bWxDbGFzcy5wdXNoKHBhcmVudC5MZWdlbmQuZ2V0Q2xhc3MoMCwgcGFyZW50LmxlZ2VuZFNjYWxlID09PSBudWxsKSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLm9uQ2xpY2sgIT09IG51bGwpIHtcbiAgICAgICAgaHRtbENsYXNzLnB1c2goJ2hvdmVyX2N1cnNvcicpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaHRtbENsYXNzLmpvaW4oJyAnKTtcbiAgICB9KS5jYWxsKGFkZFN0eWxlKTtcbiAgICByZWN0LnRyYW5zaXRpb24oKS5kdXJhdGlvbihvcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uKS5zZWxlY3QoJ3RpdGxlJykudGV4dChmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIHBhcmVudC5nZXRTdWJEb21haW5UaXRsZShkKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGZvcm1hdFN1YkRvbWFpblRleHQoZWxlbWVudCkge1xuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnN1YkRvbWFpblRleHRGb3JtYXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZWxlbWVudC50ZXh0KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgcmV0dXJuIG9wdGlvbnMuc3ViRG9tYWluVGV4dEZvcm1hdChkLnQsIGQudik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2UgdGhlIHN1YkRvbWFpblRleHQgY2xhc3MgaWYgbmVjZXNzYXJ5XG4gICAgICogQWxzbyBjaGFuZ2UgdGhlIHRleHQsIGUuZyB3aGVuIHRleHQgaXMgcmVwcmVzZW50aW5nIHRoZSB2YWx1ZVxuICAgICAqIGluc3RlYWQgb2YgdGhlIGRhdGVcbiAgICAgKi9cblxuXG4gICAgcmVjdC50cmFuc2l0aW9uKCkuZHVyYXRpb24ob3B0aW9ucy5hbmltYXRpb25EdXJhdGlvbikuc2VsZWN0KCd0ZXh0JykuYXR0cignY2xhc3MnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuICdzdWJkb21haW4tdGV4dCcgKyBwYXJlbnQuZ2V0SGlnaGxpZ2h0Q2xhc3NOYW1lKGQudCk7XG4gICAgfSkuY2FsbChmb3JtYXRTdWJEb21haW5UZXh0KTtcbiAgfSxcblxuICAvKipcbiAgICogU3ByaW50ZiBsaWtlIGZ1bmN0aW9uLlxuICAgKiBSZXBsYWNlcyBwbGFjZWhvbGRlcnMgezB9IGluIHN0cmluZyB3aXRoIHZhbHVlcyBmcm9tIHByb3ZpZGVkIG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtIHN0cmluZyBmb3JtYXR0ZWQgU3RyaW5nIGNvbnRhaW5pbmcgcGxhY2Vob2xkZXJzLlxuICAgKiBAcGFyYW0gb2JqZWN0IGFyZ3MgT2JqZWN0IHdpdGggcHJvcGVydGllcyB0byByZXBsYWNlIHBsYWNlaG9sZGVycyBpbiBzdHJpbmcuXG4gICAqXG4gICAqIEByZXR1cm4gU3RyaW5nXG4gICAqL1xuICBmb3JtYXRTdHJpbmdXaXRoT2JqZWN0OiBmdW5jdGlvbiAoZm9ybWF0dGVkLCBhcmdzKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZm9yICh2YXIgcHJvcCBpbiBhcmdzKSB7XG4gICAgICBpZiAoYXJncy5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICB2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cCgnXFxcXHsnICsgcHJvcCArICdcXFxcfScsICdnaScpO1xuICAgICAgICBmb3JtYXR0ZWQgPSBmb3JtYXR0ZWQucmVwbGFjZShyZWdleHAsIGFyZ3NbcHJvcF0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmb3JtYXR0ZWQ7XG4gIH0sXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuICAvLyBFVkVOVFMgQ0FMTEJBQ0sgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cblxuICAvKipcbiAgICogSGVscGVyIG1ldGhvZCBmb3IgdHJpZ2dlcmluZyBldmVudCBjYWxsYmFja1xuICAgKlxuICAgKiBAcGFyYW0gIHN0cmluZyAgZXZlbnROYW1lICAgICAgIE5hbWUgb2YgdGhlIGV2ZW50IHRvIHRyaWdnZXJcbiAgICogQHBhcmFtICBhcnJheSAgc3VjY2Vzc0FyZ3MgICAgIExpc3Qgb2YgYXJndW1lbnQgdG8gcGFzcyB0byB0aGUgY2FsbGJhY2tcbiAgICogQHBhcmFtICBib29sZWFuICBza2lwICAgICAgV2hldGhlciB0byBza2lwIHRoZSBldmVudCB0cmlnZ2VyaW5nXG4gICAqIEByZXR1cm4gbWl4ZWQgIFRydWUgd2hlbiB0aGUgdHJpZ2dlcmluZyB3YXMgc2tpcHBlZCwgZmFsc2Ugb24gZXJyb3IsIGVsc2UgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAqL1xuICB0cmlnZ2VyRXZlbnQ6IGZ1bmN0aW9uIChldmVudE5hbWUsIHN1Y2Nlc3NBcmdzLCBza2lwKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMgJiYgc2tpcCB8fCB0aGlzLm9wdGlvbnNbZXZlbnROYW1lXSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnNbZXZlbnROYW1lXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaWYgKHR5cGVvZiBzdWNjZXNzQXJncyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBzdWNjZXNzQXJncyA9IHN1Y2Nlc3NBcmdzKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNbZXZlbnROYW1lXS5hcHBseSh0aGlzLCBzdWNjZXNzQXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCdQcm92aWRlZCBjYWxsYmFjayBmb3IgJyArIGV2ZW50TmFtZSArICcgaXMgbm90IGEgZnVuY3Rpb24uJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBFdmVudCB0cmlnZ2VyZWQgb24gYSBtb3VzZSBjbGljayBvbiBhIHN1YkRvbWFpbiBjZWxsXG4gICAqXG4gICAqIEBwYXJhbSAgRGF0ZSAgICBkICAgIERhdGUgb2YgdGhlIHN1YmRvbWFpbiBibG9ja1xuICAgKiBAcGFyYW0gIGludCAgICBpdGVtTmIgIE51bWJlciBvZiBpdGVtcyBpbiB0aGF0IGRhdGVcbiAgICovXG4gIG9uQ2xpY2s6IGZ1bmN0aW9uIChkLCBpdGVtTmIpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICByZXR1cm4gdGhpcy50cmlnZ2VyRXZlbnQoJ29uQ2xpY2snLCBbZCwgaXRlbU5iXSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEV2ZW50IHRyaWdnZXJlZCBhZnRlciBkcmF3aW5nIHRoZSBjYWxlbmRhciwgYnl0IGJlZm9yZSBmaWxsaW5nIGl0IHdpdGggZGF0YVxuICAgKi9cbiAgYWZ0ZXJMb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgcmV0dXJuIHRoaXMudHJpZ2dlckV2ZW50KCdhZnRlckxvYWQnKTtcbiAgfSxcblxuICAvKipcbiAgICogRXZlbnQgdHJpZ2dlcmVkIGFmdGVyIGNvbXBsZXRpbmcgZHJhd2luZyBhbmQgZmlsbGluZyB0aGUgY2FsZW5kYXJcbiAgICovXG4gIG9uQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgcmVzcG9uc2UgPSB0aGlzLnRyaWdnZXJFdmVudCgnb25Db21wbGV0ZScsIFtdLCB0aGlzLl9jb21wbGV0ZWQpO1xuICAgIHRoaXMuX2NvbXBsZXRlZCA9IHRydWU7XG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBFdmVudCB0cmlnZ2VyZWQgYWZ0ZXIgc2hpZnRpbmcgdGhlIGNhbGVuZGFyIG9uZSBkb21haW4gYmFja1xuICAgKlxuICAgKiBAcGFyYW0gIERhdGUgICAgc3RhcnQgIERvbWFpbiBzdGFydCBkYXRlXG4gICAqIEBwYXJhbSAgRGF0ZSAgICBlbmQgICAgRG9tYWluIGVuZCBkYXRlXG4gICAqL1xuICBhZnRlckxvYWRQcmV2aW91c0RvbWFpbjogZnVuY3Rpb24gKHN0YXJ0KSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHBhcmVudCA9IHRoaXM7XG4gICAgcmV0dXJuIHRoaXMudHJpZ2dlckV2ZW50KCdhZnRlckxvYWRQcmV2aW91c0RvbWFpbicsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzdWJEb21haW4gPSBwYXJlbnQuZ2V0U3ViRG9tYWluKHN0YXJ0KTtcbiAgICAgIHJldHVybiBbc3ViRG9tYWluLnNoaWZ0KCksIHN1YkRvbWFpbi5wb3AoKV07XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEV2ZW50IHRyaWdnZXJlZCBhZnRlciBzaGlmdGluZyB0aGUgY2FsZW5kYXIgb25lIGRvbWFpbiBhYm92ZVxuICAgKlxuICAgKiBAcGFyYW0gIERhdGUgICAgc3RhcnQgIERvbWFpbiBzdGFydCBkYXRlXG4gICAqIEBwYXJhbSAgRGF0ZSAgICBlbmQgICAgRG9tYWluIGVuZCBkYXRlXG4gICAqL1xuICBhZnRlckxvYWROZXh0RG9tYWluOiBmdW5jdGlvbiAoc3RhcnQpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgcGFyZW50ID0gdGhpcztcbiAgICByZXR1cm4gdGhpcy50cmlnZ2VyRXZlbnQoJ2FmdGVyTG9hZE5leHREb21haW4nLCBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc3ViRG9tYWluID0gcGFyZW50LmdldFN1YkRvbWFpbihzdGFydCk7XG4gICAgICByZXR1cm4gW3N1YkRvbWFpbi5zaGlmdCgpLCBzdWJEb21haW4ucG9wKCldO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBFdmVudCB0cmlnZ2VyZWQgYWZ0ZXIgbG9hZGluZyB0aGUgbGVmdG1vc3QgZG9tYWluIGFsbG93ZWQgYnkgbWluRGF0ZVxuICAgKlxuICAgKiBAcGFyYW0gIGJvb2xlYW4gIHJlYWNoZWQgVHJ1ZSBpZiB0aGUgbGVmdG1vc3QgZG9tYWluIHdhcyByZWFjaGVkXG4gICAqL1xuICBvbk1pbkRvbWFpblJlYWNoZWQ6IGZ1bmN0aW9uIChyZWFjaGVkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdGhpcy5fbWluRG9tYWluUmVhY2hlZCA9IHJlYWNoZWQ7XG4gICAgcmV0dXJuIHRoaXMudHJpZ2dlckV2ZW50KCdvbk1pbkRvbWFpblJlYWNoZWQnLCBbcmVhY2hlZF0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBFdmVudCB0cmlnZ2VyZWQgYWZ0ZXIgbG9hZGluZyB0aGUgcmlnaHRtb3N0IGRvbWFpbiBhbGxvd2VkIGJ5IG1heERhdGVcbiAgICpcbiAgICogQHBhcmFtICBib29sZWFuICByZWFjaGVkIFRydWUgaWYgdGhlIHJpZ2h0bW9zdCBkb21haW4gd2FzIHJlYWNoZWRcbiAgICovXG4gIG9uTWF4RG9tYWluUmVhY2hlZDogZnVuY3Rpb24gKHJlYWNoZWQpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB0aGlzLl9tYXhEb21haW5SZWFjaGVkID0gcmVhY2hlZDtcbiAgICByZXR1cm4gdGhpcy50cmlnZ2VyRXZlbnQoJ29uTWF4RG9tYWluUmVhY2hlZCcsIFtyZWFjaGVkXSk7XG4gIH0sXG4gIGNoZWNrSWZNaW5Eb21haW5Jc1JlYWNoZWQ6IGZ1bmN0aW9uIChkYXRlLCB1cHBlckJvdW5kKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHRoaXMubWluRG9tYWluSXNSZWFjaGVkKGRhdGUpKSB7XG4gICAgICB0aGlzLm9uTWluRG9tYWluUmVhY2hlZCh0cnVlKTtcbiAgICB9XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgaWYgKHRoaXMuX21heERvbWFpblJlYWNoZWQgJiYgIXRoaXMubWF4RG9tYWluSXNSZWFjaGVkKHVwcGVyQm91bmQpKSB7XG4gICAgICAgIHRoaXMub25NYXhEb21haW5SZWFjaGVkKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGNoZWNrSWZNYXhEb21haW5Jc1JlYWNoZWQ6IGZ1bmN0aW9uIChkYXRlLCBsb3dlckJvdW5kKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHRoaXMubWF4RG9tYWluSXNSZWFjaGVkKGRhdGUpKSB7XG4gICAgICB0aGlzLm9uTWF4RG9tYWluUmVhY2hlZCh0cnVlKTtcbiAgICB9XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgaWYgKHRoaXMuX21pbkRvbWFpblJlYWNoZWQgJiYgIXRoaXMubWluRG9tYWluSXNSZWFjaGVkKGxvd2VyQm91bmQpKSB7XG4gICAgICAgIHRoaXMub25NaW5Eb21haW5SZWFjaGVkKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFmdGVyVXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgcmV0dXJuIHRoaXMudHJpZ2dlckV2ZW50KCdhZnRlclVwZGF0ZScpO1xuICB9LFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cbiAgLy8gRk9STUFUVEVSICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cbiAgZm9ybWF0TnVtYmVyOiBkMy5mb3JtYXQoJyxnJyksXG4gIGZvcm1hdERhdGU6IGZ1bmN0aW9uIChkLCBmb3JtYXQpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHtcbiAgICAgIGZvcm1hdCA9ICd0aXRsZSc7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBmb3JtYXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBmb3JtYXQoZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBmID0gZDMudGltZS5mb3JtYXQoZm9ybWF0KTtcbiAgICAgIHJldHVybiBmKGQpO1xuICAgIH1cbiAgfSxcbiAgZ2V0U3ViRG9tYWluVGl0bGU6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKGQudiA9PT0gbnVsbCAmJiAhdGhpcy5vcHRpb25zLmNvbnNpZGVyTWlzc2luZ0RhdGFBc1plcm8pIHtcbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdFN0cmluZ1dpdGhPYmplY3QodGhpcy5vcHRpb25zLnN1YkRvbWFpblRpdGxlRm9ybWF0LmVtcHR5LCB7XG4gICAgICAgIGRhdGU6IHRoaXMuZm9ybWF0RGF0ZShuZXcgRGF0ZShkLnQpLCB0aGlzLm9wdGlvbnMuc3ViRG9tYWluRGF0ZUZvcm1hdClcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdmFsdWUgPSBkLnY7IC8vIENvbnNpZGVyIG51bGwgYXMgMFxuXG4gICAgICBpZiAodmFsdWUgPT09IG51bGwgJiYgdGhpcy5vcHRpb25zLmNvbnNpZGVyTWlzc2luZ0RhdGFBc1plcm8pIHtcbiAgICAgICAgdmFsdWUgPSAwO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5mb3JtYXRTdHJpbmdXaXRoT2JqZWN0KHRoaXMub3B0aW9ucy5zdWJEb21haW5UaXRsZUZvcm1hdC5maWxsZWQsIHtcbiAgICAgICAgY291bnQ6IHRoaXMuZm9ybWF0TnVtYmVyKHZhbHVlKSxcbiAgICAgICAgbmFtZTogdGhpcy5vcHRpb25zLml0ZW1OYW1lW3ZhbHVlICE9PSAxID8gMSA6IDBdLFxuICAgICAgICBjb25uZWN0b3I6IHRoaXMuX2RvbWFpblR5cGVbdGhpcy5vcHRpb25zLnN1YkRvbWFpbl0uZm9ybWF0LmNvbm5lY3RvcixcbiAgICAgICAgZGF0ZTogdGhpcy5mb3JtYXREYXRlKG5ldyBEYXRlKGQudCksIHRoaXMub3B0aW9ucy5zdWJEb21haW5EYXRlRm9ybWF0KVxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cbiAgLy8gRE9NQUlOIE5BVklHQVRJT04gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cbiAgLyoqXG4gICAqIFNoaWZ0IHRoZSBjYWxlbmRhciBvbmUgZG9tYWluIGZvcndhcmRcbiAgICpcbiAgICogVGhlIG5ldyBkb21haW4gaXMgbG9hZGVkIG9ubHkgaWYgaXQncyBub3QgYmV5b25kIG1heERhdGVcbiAgICpcbiAgICogQHBhcmFtIGludCBuIE51bWJlciBvZiBkb21haW5zIHRvIGxvYWRcbiAgICogQHJldHVybiBib29sIFRydWUgaWYgdGhlIG5leHQgZG9tYWluIHdhcyBsb2FkZWQsIGVsc2UgZmFsc2VcbiAgICovXG4gIGxvYWROZXh0RG9tYWluOiBmdW5jdGlvbiAobikge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmICh0aGlzLl9tYXhEb21haW5SZWFjaGVkIHx8IG4gPT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgYm91bmQgPSB0aGlzLmxvYWROZXdEb21haW5zKHRoaXMuTkFWSUdBVEVfUklHSFQsIHRoaXMuZ2V0RG9tYWluKHRoaXMuZ2V0TmV4dERvbWFpbigpLCBuKSk7XG4gICAgdGhpcy5hZnRlckxvYWROZXh0RG9tYWluKGJvdW5kLmVuZCk7XG4gICAgdGhpcy5jaGVja0lmTWF4RG9tYWluSXNSZWFjaGVkKHRoaXMuZ2V0TmV4dERvbWFpbigpLmdldFRpbWUoKSwgYm91bmQuc3RhcnQpO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBTaGlmdCB0aGUgY2FsZW5kYXIgb25lIGRvbWFpbiBiYWNrd2FyZFxuICAgKlxuICAgKiBUaGUgcHJldmlvdXMgZG9tYWluIGlzIGxvYWRlZCBvbmx5IGlmIGl0J3Mgbm90IGJleW9uZCB0aGUgbWluRGF0ZVxuICAgKlxuICAgKiBAcGFyYW0gaW50IG4gTnVtYmVyIG9mIGRvbWFpbnMgdG8gbG9hZFxuICAgKiBAcmV0dXJuIGJvb2wgVHJ1ZSBpZiB0aGUgcHJldmlvdXMgZG9tYWluIHdhcyBsb2FkZWQsIGVsc2UgZmFsc2VcbiAgICovXG4gIGxvYWRQcmV2aW91c0RvbWFpbjogZnVuY3Rpb24gKG4pIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAodGhpcy5fbWluRG9tYWluUmVhY2hlZCB8fCBuID09PSAwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGJvdW5kID0gdGhpcy5sb2FkTmV3RG9tYWlucyh0aGlzLk5BVklHQVRFX0xFRlQsIHRoaXMuZ2V0RG9tYWluKHRoaXMuZ2V0RG9tYWluS2V5cygpWzBdLCAtbikucmV2ZXJzZSgpKTtcbiAgICB0aGlzLmFmdGVyTG9hZFByZXZpb3VzRG9tYWluKGJvdW5kLnN0YXJ0KTtcbiAgICB0aGlzLmNoZWNrSWZNaW5Eb21haW5Jc1JlYWNoZWQoYm91bmQuc3RhcnQsIGJvdW5kLmVuZCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG4gIGxvYWROZXdEb21haW5zOiBmdW5jdGlvbiAoZGlyZWN0aW9uLCBuZXdEb21haW5zKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHBhcmVudCA9IHRoaXM7XG4gICAgdmFyIGJhY2t3YXJkID0gZGlyZWN0aW9uID09PSB0aGlzLk5BVklHQVRFX0xFRlQ7XG4gICAgdmFyIGkgPSAtMTtcbiAgICB2YXIgdG90YWwgPSBuZXdEb21haW5zLmxlbmd0aDtcbiAgICB2YXIgZG9tYWlucyA9IHRoaXMuZ2V0RG9tYWluS2V5cygpO1xuXG4gICAgZnVuY3Rpb24gYnVpbGRTdWJEb21haW4oZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdDogcGFyZW50Ll9kb21haW5UeXBlW3BhcmVudC5vcHRpb25zLnN1YkRvbWFpbl0uZXh0cmFjdFVuaXQoZCksXG4gICAgICAgIHY6IG51bGxcbiAgICAgIH07XG4gICAgfSAvLyBSZW1vdmUgb3V0IG9mIGJvdW5kIGRvbWFpbnMgZnJvbSBsaXN0IG9mIG5ldyBkb21haW5zIHRvIHByZXBlbmRcblxuXG4gICAgd2hpbGUgKCsraSA8IHRvdGFsKSB7XG4gICAgICBpZiAoYmFja3dhcmQgJiYgdGhpcy5taW5Eb21haW5Jc1JlYWNoZWQobmV3RG9tYWluc1tpXSkpIHtcbiAgICAgICAgbmV3RG9tYWlucyA9IG5ld0RvbWFpbnMuc2xpY2UoMCwgaSArIDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgaWYgKCFiYWNrd2FyZCAmJiB0aGlzLm1heERvbWFpbklzUmVhY2hlZChuZXdEb21haW5zW2ldKSkge1xuICAgICAgICBuZXdEb21haW5zID0gbmV3RG9tYWlucy5zbGljZSgwLCBpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbmV3RG9tYWlucyA9IG5ld0RvbWFpbnMuc2xpY2UoLXRoaXMub3B0aW9ucy5yYW5nZSk7XG5cbiAgICBmb3IgKGkgPSAwLCB0b3RhbCA9IG5ld0RvbWFpbnMubGVuZ3RoOyBpIDwgdG90YWw7IGkgKz0gMSkge1xuICAgICAgdGhpcy5fZG9tYWlucy5zZXQobmV3RG9tYWluc1tpXS5nZXRUaW1lKCksIHRoaXMuZ2V0U3ViRG9tYWluKG5ld0RvbWFpbnNbaV0pLm1hcChidWlsZFN1YkRvbWFpbikpO1xuXG4gICAgICB0aGlzLl9kb21haW5zLnJlbW92ZShiYWNrd2FyZCA/IGRvbWFpbnMucG9wKCkgOiBkb21haW5zLnNoaWZ0KCkpO1xuICAgIH1cblxuICAgIGRvbWFpbnMgPSB0aGlzLmdldERvbWFpbktleXMoKTtcblxuICAgIGlmIChiYWNrd2FyZCkge1xuICAgICAgbmV3RG9tYWlucyA9IG5ld0RvbWFpbnMucmV2ZXJzZSgpO1xuICAgIH1cblxuICAgIHRoaXMucGFpbnQoZGlyZWN0aW9uKTtcbiAgICB0aGlzLmdldERhdGFzKHRoaXMub3B0aW9ucy5kYXRhLCBuZXdEb21haW5zWzBdLCB0aGlzLmdldFN1YkRvbWFpbihuZXdEb21haW5zW25ld0RvbWFpbnMubGVuZ3RoIC0gMV0pLnBvcCgpLCBmdW5jdGlvbiAoKSB7XG4gICAgICBwYXJlbnQuZmlsbChwYXJlbnQubGFzdEluc2VydGVkU3ZnKTtcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhcnQ6IG5ld0RvbWFpbnNbYmFja3dhcmQgPyAwIDogMV0sXG4gICAgICBlbmQ6IGRvbWFpbnNbZG9tYWlucy5sZW5ndGggLSAxXVxuICAgIH07XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJldHVybiB3aGV0aGVyIGEgZGF0ZSBpcyBpbnNpZGUgdGhlIHNjb3BlIGRldGVybWluZWQgYnkgbWF4RGF0ZVxuICAgKlxuICAgKiBAcGFyYW0gaW50IGRhdGV0aW1lc3RhbXAgVGhlIHRpbWVzdGFtcCBpbiBtcyB0byB0ZXN0XG4gICAqIEByZXR1cm4gYm9vbCBUcnVlIGlmIHRoZSBzcGVjaWZpZWQgZGF0ZSBjb3JyZXNwb25kIHRvIHRoZSBjYWxlbmRhciB1cHBlciBib3VuZFxuICAgKi9cbiAgbWF4RG9tYWluSXNSZWFjaGVkOiBmdW5jdGlvbiAoZGF0ZXRpbWVzdGFtcCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHJldHVybiB0aGlzLm9wdGlvbnMubWF4RGF0ZSAhPT0gbnVsbCAmJiB0aGlzLm9wdGlvbnMubWF4RGF0ZS5nZXRUaW1lKCkgPCBkYXRldGltZXN0YW1wO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZXR1cm4gd2hldGhlciBhIGRhdGUgaXMgaW5zaWRlIHRoZSBzY29wZSBkZXRlcm1pbmVkIGJ5IG1pbkRhdGVcbiAgICpcbiAgICogQHBhcmFtIGludCBkYXRldGltZXN0YW1wIFRoZSB0aW1lc3RhbXAgaW4gbXMgdG8gdGVzdFxuICAgKiBAcmV0dXJuIGJvb2wgVHJ1ZSBpZiB0aGUgc3BlY2lmaWVkIGRhdGUgY29ycmVzcG9uZCB0byB0aGUgY2FsZW5kYXIgbG93ZXIgYm91bmRcbiAgICovXG4gIG1pbkRvbWFpbklzUmVhY2hlZDogZnVuY3Rpb24gKGRhdGV0aW1lc3RhbXApIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLm1pbkRhdGUgIT09IG51bGwgJiYgdGhpcy5vcHRpb25zLm1pbkRhdGUuZ2V0VGltZSgpID49IGRhdGV0aW1lc3RhbXA7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgbGlzdCBvZiB0aGUgY2FsZW5kYXIncyBkb21haW4gdGltZXN0YW1wXG4gICAqXG4gICAqIEByZXR1cm4gQXJyYXkgYSBzb3J0ZWQgYXJyYXkgb2YgdGltZXN0YW1wXG4gICAqL1xuICBnZXREb21haW5LZXlzOiBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgcmV0dXJuIHRoaXMuX2RvbWFpbnMua2V5cygpLm1hcChmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIHBhcnNlSW50KGQsIDEwKTtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICByZXR1cm4gYSAtIGI7XG4gICAgfSk7XG4gIH0sXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuICAvLyBQT1NJVElPTk5JTkcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuICBwb3NpdGlvblN1YkRvbWFpblg6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGluZGV4ID0gdGhpcy5fZG9tYWluVHlwZVt0aGlzLm9wdGlvbnMuc3ViRG9tYWluXS5wb3NpdGlvbi54KG5ldyBEYXRlKGQpKTtcblxuICAgIHJldHVybiBpbmRleCAqIHRoaXMub3B0aW9ucy5jZWxsU2l6ZSArIGluZGV4ICogdGhpcy5vcHRpb25zLmNlbGxQYWRkaW5nO1xuICB9LFxuICBwb3NpdGlvblN1YkRvbWFpblk6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGluZGV4ID0gdGhpcy5fZG9tYWluVHlwZVt0aGlzLm9wdGlvbnMuc3ViRG9tYWluXS5wb3NpdGlvbi55KG5ldyBEYXRlKGQpKTtcblxuICAgIHJldHVybiBpbmRleCAqIHRoaXMub3B0aW9ucy5jZWxsU2l6ZSArIGluZGV4ICogdGhpcy5vcHRpb25zLmNlbGxQYWRkaW5nO1xuICB9LFxuICBnZXRTdWJEb21haW5Db2x1bW5OdW1iZXI6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5yb3dMaW1pdCA+IDApIHtcbiAgICAgIHZhciBpID0gdGhpcy5fZG9tYWluVHlwZVt0aGlzLm9wdGlvbnMuc3ViRG9tYWluXS5tYXhJdGVtTnVtYmVyO1xuXG4gICAgICBpZiAodHlwZW9mIGkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgaSA9IGkoZCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBNYXRoLmNlaWwoaSAvIHRoaXMub3B0aW9ucy5yb3dMaW1pdCk7XG4gICAgfVxuXG4gICAgdmFyIGogPSB0aGlzLl9kb21haW5UeXBlW3RoaXMub3B0aW9ucy5zdWJEb21haW5dLmRlZmF1bHRDb2x1bW5OdW1iZXI7XG5cbiAgICBpZiAodHlwZW9mIGogPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGogPSBqKGQpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLm9wdGlvbnMuY29sTGltaXQgfHwgajtcbiAgfSxcbiAgZ2V0U3ViRG9tYWluUm93TnVtYmVyOiBmdW5jdGlvbiAoZCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuY29sTGltaXQgPiAwKSB7XG4gICAgICB2YXIgaSA9IHRoaXMuX2RvbWFpblR5cGVbdGhpcy5vcHRpb25zLnN1YkRvbWFpbl0ubWF4SXRlbU51bWJlcjtcblxuICAgICAgaWYgKHR5cGVvZiBpID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGkgPSBpKGQpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTWF0aC5jZWlsKGkgLyB0aGlzLm9wdGlvbnMuY29sTGltaXQpO1xuICAgIH1cblxuICAgIHZhciBqID0gdGhpcy5fZG9tYWluVHlwZVt0aGlzLm9wdGlvbnMuc3ViRG9tYWluXS5kZWZhdWx0Um93TnVtYmVyO1xuXG4gICAgaWYgKHR5cGVvZiBqID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBqID0gaihkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLnJvd0xpbWl0IHx8IGo7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJldHVybiBhIGNsYXNzbmFtZSBpZiB0aGUgc3BlY2lmaWVkIGRhdGUgc2hvdWxkIGJlIGhpZ2hsaWdodGVkXG4gICAqXG4gICAqIEBwYXJhbSAgdGltZXN0YW1wIGRhdGUgRGF0ZSBvZiB0aGUgY3VycmVudCBzdWJEb21haW5cbiAgICogQHJldHVybiBTdHJpbmcgdGhlIGhpZ2hsaWdodCBjbGFzc1xuICAgKi9cbiAgZ2V0SGlnaGxpZ2h0Q2xhc3NOYW1lOiBmdW5jdGlvbiAoZCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGQgPSBuZXcgRGF0ZShkKTtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuaGlnaGxpZ2h0Lmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5vcHRpb25zLmhpZ2hsaWdodCkge1xuICAgICAgICBpZiAodGhpcy5kYXRlSXNFcXVhbCh0aGlzLm9wdGlvbnMuaGlnaGxpZ2h0W2ldLCBkKSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmlzTm93KHRoaXMub3B0aW9ucy5oaWdobGlnaHRbaV0pID8gJyBoaWdobGlnaHQtbm93JyA6ICcgaGlnaGxpZ2h0JztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAnJztcbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJuIHdoZXRoZXIgdGhlIHNwZWNpZmllZCBkYXRlIGlzIG5vdyxcbiAgICogYWNjb3JkaW5nIHRvIHRoZSB0eXBlIG9mIHN1YmRvbWFpblxuICAgKlxuICAgKiBAcGFyYW0gIERhdGUgZCBUaGUgZGF0ZSB0byBjb21wYXJlXG4gICAqIEByZXR1cm4gYm9vbCBUcnVlIGlmIHRoZSBkYXRlIGNvcnJlc3BvbmQgdG8gYSBzdWJkb21haW4gY2VsbFxuICAgKi9cbiAgaXNOb3c6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgcmV0dXJuIHRoaXMuZGF0ZUlzRXF1YWwoZCwgbmV3IERhdGUoKSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJldHVybiB3aGV0aGVyIDIgZGF0ZXMgYXJlIGVxdWFsc1xuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHN1YmRvbWFpbi1hd2FyZSxcbiAgICogYW5kIGRhdGVzIGNvbXBhcmlzb24gYXJlIGRlcGVuZGVudCBvZiB0aGUgc3ViZG9tYWluXG4gICAqXG4gICAqIEBwYXJhbSAgRGF0ZSBkYXRlQSBGaXJzdCBkYXRlIHRvIGNvbXBhcmVcbiAgICogQHBhcmFtICBEYXRlIGRhdGVCIFNlY29uIGRhdGUgdG8gY29tcGFyZVxuICAgKiBAcmV0dXJuIGJvb2wgdHJ1ZSBpZiB0aGUgMiBkYXRlcyBhcmUgZXF1YWxzXG4gICAqL1xuXG4gIC8qIGpzaGludCBtYXhjb21wbGV4aXR5OiBmYWxzZSAqL1xuICBkYXRlSXNFcXVhbDogZnVuY3Rpb24gKGRhdGVBLCBkYXRlQikge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmICghKGRhdGVBIGluc3RhbmNlb2YgRGF0ZSkpIHtcbiAgICAgIGRhdGVBID0gbmV3IERhdGUoZGF0ZUEpO1xuICAgIH1cblxuICAgIGlmICghKGRhdGVCIGluc3RhbmNlb2YgRGF0ZSkpIHtcbiAgICAgIGRhdGVCID0gbmV3IERhdGUoZGF0ZUIpO1xuICAgIH1cblxuICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLnN1YkRvbWFpbikge1xuICAgICAgY2FzZSAneF9taW4nOlxuICAgICAgY2FzZSAnbWluJzpcbiAgICAgICAgcmV0dXJuIGRhdGVBLmdldEZ1bGxZZWFyKCkgPT09IGRhdGVCLmdldEZ1bGxZZWFyKCkgJiYgZGF0ZUEuZ2V0TW9udGgoKSA9PT0gZGF0ZUIuZ2V0TW9udGgoKSAmJiBkYXRlQS5nZXREYXRlKCkgPT09IGRhdGVCLmdldERhdGUoKSAmJiBkYXRlQS5nZXRIb3VycygpID09PSBkYXRlQi5nZXRIb3VycygpICYmIGRhdGVBLmdldE1pbnV0ZXMoKSA9PT0gZGF0ZUIuZ2V0TWludXRlcygpO1xuXG4gICAgICBjYXNlICd4X2hvdXInOlxuICAgICAgY2FzZSAnaG91cic6XG4gICAgICAgIHJldHVybiBkYXRlQS5nZXRGdWxsWWVhcigpID09PSBkYXRlQi5nZXRGdWxsWWVhcigpICYmIGRhdGVBLmdldE1vbnRoKCkgPT09IGRhdGVCLmdldE1vbnRoKCkgJiYgZGF0ZUEuZ2V0RGF0ZSgpID09PSBkYXRlQi5nZXREYXRlKCkgJiYgZGF0ZUEuZ2V0SG91cnMoKSA9PT0gZGF0ZUIuZ2V0SG91cnMoKTtcblxuICAgICAgY2FzZSAneF9kYXknOlxuICAgICAgY2FzZSAnZGF5JzpcbiAgICAgICAgcmV0dXJuIGRhdGVBLmdldEZ1bGxZZWFyKCkgPT09IGRhdGVCLmdldEZ1bGxZZWFyKCkgJiYgZGF0ZUEuZ2V0TW9udGgoKSA9PT0gZGF0ZUIuZ2V0TW9udGgoKSAmJiBkYXRlQS5nZXREYXRlKCkgPT09IGRhdGVCLmdldERhdGUoKTtcblxuICAgICAgY2FzZSAneF93ZWVrJzpcbiAgICAgIGNhc2UgJ3dlZWsnOlxuICAgICAgICByZXR1cm4gZGF0ZUEuZ2V0RnVsbFllYXIoKSA9PT0gZGF0ZUIuZ2V0RnVsbFllYXIoKSAmJiB0aGlzLmdldFdlZWtOdW1iZXIoZGF0ZUEpID09PSB0aGlzLmdldFdlZWtOdW1iZXIoZGF0ZUIpO1xuXG4gICAgICBjYXNlICd4X21vbnRoJzpcbiAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgcmV0dXJuIGRhdGVBLmdldEZ1bGxZZWFyKCkgPT09IGRhdGVCLmdldEZ1bGxZZWFyKCkgJiYgZGF0ZUEuZ2V0TW9udGgoKSA9PT0gZGF0ZUIuZ2V0TW9udGgoKTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJucyB3ZXRoZXIgb3Igbm90IGRhdGVBIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byBkYXRlQi4gVGhpcyBmdW5jdGlvbiBpcyBzdWJkb21haW4gYXdhcmUuXG4gICAqIFBlcmZvcm1zIGF1dG9tYXRpYyBjb252ZXJzaW9uIG9mIHZhbHVlcy5cbiAgICogQHBhcmFtIGRhdGVBIG1heSBiZSBhIG51bWJlciBvciBhIERhdGVcbiAgICogQHBhcmFtIGRhdGVCIG1heSBiZSBhIG51bWJlciBvciBhIERhdGVcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBkYXRlSXNMZXNzVGhhbjogZnVuY3Rpb24gKGRhdGVBLCBkYXRlQikge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmICghKGRhdGVBIGluc3RhbmNlb2YgRGF0ZSkpIHtcbiAgICAgIGRhdGVBID0gbmV3IERhdGUoZGF0ZUEpO1xuICAgIH1cblxuICAgIGlmICghKGRhdGVCIGluc3RhbmNlb2YgRGF0ZSkpIHtcbiAgICAgIGRhdGVCID0gbmV3IERhdGUoZGF0ZUIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZWRNaWxsaXMoZGF0ZSwgc3ViZG9tYWluKSB7XG4gICAgICBzd2l0Y2ggKHN1YmRvbWFpbikge1xuICAgICAgICBjYXNlICd4X21pbic6XG4gICAgICAgIGNhc2UgJ21pbic6XG4gICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpLCBkYXRlLmdldERhdGUoKSwgZGF0ZS5nZXRIb3VycygpLCBkYXRlLmdldE1pbnV0ZXMoKSkuZ2V0VGltZSgpO1xuXG4gICAgICAgIGNhc2UgJ3hfaG91cic6XG4gICAgICAgIGNhc2UgJ2hvdXInOlxuICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSwgZGF0ZS5nZXREYXRlKCksIGRhdGUuZ2V0SG91cnMoKSkuZ2V0VGltZSgpO1xuXG4gICAgICAgIGNhc2UgJ3hfZGF5JzpcbiAgICAgICAgY2FzZSAnZGF5JzpcbiAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCBkYXRlLmdldE1vbnRoKCksIGRhdGUuZ2V0RGF0ZSgpKS5nZXRUaW1lKCk7XG5cbiAgICAgICAgY2FzZSAneF93ZWVrJzpcbiAgICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgIGNhc2UgJ3hfbW9udGgnOlxuICAgICAgICBjYXNlICdtb250aCc6XG4gICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpKS5nZXRUaW1lKCk7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXR1cm4gZGF0ZS5nZXRUaW1lKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vcm1hbGl6ZWRNaWxsaXMoZGF0ZUEsIHRoaXMub3B0aW9ucy5zdWJEb21haW4pIDwgbm9ybWFsaXplZE1pbGxpcyhkYXRlQiwgdGhpcy5vcHRpb25zLnN1YkRvbWFpbik7XG4gIH0sXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuICAvLyBEQVRFIENPTVBVVEFUSU9OICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgZGF5IG9mIHRoZSB5ZWFyIGZvciB0aGUgZGF0ZVxuICAgKiBAcGFyYW0gIERhdGVcbiAgICogQHJldHVybiAgaW50IERheSBvZiB0aGUgeWVhciBbMSwzNjZdXG4gICAqL1xuICBnZXREYXlPZlllYXI6IGQzLnRpbWUuZm9ybWF0KCclaicpLFxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIHdlZWsgbnVtYmVyIG9mIHRoZSB5ZWFyXG4gICAqIE1vbmRheSBhcyB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrXG4gICAqIEByZXR1cm4gaW50ICBXZWVrIG51bWJlciBbMC01M11cbiAgICovXG4gIGdldFdlZWtOdW1iZXI6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGYgPSB0aGlzLm9wdGlvbnMud2Vla1N0YXJ0T25Nb25kYXkgPT09IHRydWUgPyBkMy50aW1lLmZvcm1hdCgnJVcnKSA6IGQzLnRpbWUuZm9ybWF0KCclVScpO1xuICAgIHJldHVybiBmKGQpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIHdlZWsgbnVtYmVyLCByZWxhdGl2ZSB0byBpdHMgbW9udGhcbiAgICpcbiAgICogQHBhcmFtICBpbnR8RGF0ZSBkIERhdGUgb3IgdGltZXN0YW1wIGluIG1pbGxpc2Vjb25kc1xuICAgKiBAcmV0dXJuIGludCBXZWVrIG51bWJlciwgcmVsYXRpdmUgdG8gdGhlIG1vbnRoIFswLTVdXG4gICAqL1xuICBnZXRNb250aFdlZWtOdW1iZXI6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHR5cGVvZiBkID09PSAnbnVtYmVyJykge1xuICAgICAgZCA9IG5ldyBEYXRlKGQpO1xuICAgIH1cblxuICAgIHZhciBtb250aEZpcnN0V2Vla051bWJlciA9IHRoaXMuZ2V0V2Vla051bWJlcihuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSkpO1xuICAgIHJldHVybiB0aGlzLmdldFdlZWtOdW1iZXIoZCkgLSBtb250aEZpcnN0V2Vla051bWJlciAtIDE7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIHdlZWtzIGluIHRoZSBkYXRlcycgeWVhclxuICAgKlxuICAgKiBAcGFyYW0gIGludHxEYXRlIGQgRGF0ZSBvciB0aW1lc3RhbXAgaW4gbWlsbGlzZWNvbmRzXG4gICAqIEByZXR1cm4gaW50IE51bWJlciBvZiB3ZWVrcyBpbiB0aGUgZGF0ZSdzIHllYXJcbiAgICovXG4gIGdldFdlZWtOdW1iZXJJblllYXI6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHR5cGVvZiBkID09PSAnbnVtYmVyJykge1xuICAgICAgZCA9IG5ldyBEYXRlKGQpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBudW1iZXIgb2YgZGF5cyBpbiB0aGUgZGF0ZSdzIG1vbnRoXG4gICAqXG4gICAqIEBwYXJhbSAgaW50fERhdGUgZCBEYXRlIG9yIHRpbWVzdGFtcCBpbiBtaWxsaXNlY29uZHNcbiAgICogQHJldHVybiBpbnQgTnVtYmVyIG9mIGRheXMgaW4gdGhlIGRhdGUncyBtb250aFxuICAgKi9cbiAgZ2V0RGF5Q291bnRJbk1vbnRoOiBmdW5jdGlvbiAoZCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHJldHVybiB0aGlzLmdldEVuZE9mTW9udGgoZCkuZ2V0RGF0ZSgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIG51bWJlciBvZiBkYXlzIGluIHRoZSBkYXRlJ3MgeWVhclxuICAgKlxuICAgKiBAcGFyYW0gIGludHxEYXRlIGQgRGF0ZSBvciB0aW1lc3RhbXAgaW4gbWlsbGlzZWNvbmRzXG4gICAqIEByZXR1cm4gaW50IE51bWJlciBvZiBkYXlzIGluIHRoZSBkYXRlJ3MgeWVhclxuICAgKi9cbiAgZ2V0RGF5Q291bnRJblllYXI6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHR5cGVvZiBkID09PSAnbnVtYmVyJykge1xuICAgICAgZCA9IG5ldyBEYXRlKGQpO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIDEsIDI5KS5nZXRNb250aCgpID09PSAxID8gMzY2IDogMzY1O1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHdlZWtkYXkgZnJvbSBhIGRhdGVcbiAgICpcbiAgICogUmV0dXJuIHRoZSB3ZWVrIGRheSBudW1iZXIgKDAtNikgb2YgYSBkYXRlLFxuICAgKiBkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgd2VlayBzdGFydCBvbiBtb25kYXkgb3Igc3VuZGF5XG4gICAqXG4gICAqIEBwYXJhbSAgRGF0ZSBkXG4gICAqIEByZXR1cm4gaW50IFRoZSB3ZWVrIGRheSBudW1iZXIgKDAtNilcbiAgICovXG4gIGdldFdlZWtEYXk6IGZ1bmN0aW9uIChkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHRoaXMub3B0aW9ucy53ZWVrU3RhcnRPbk1vbmRheSA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybiBkLmdldERheSgpO1xuICAgIH1cblxuICAgIHJldHVybiBkLmdldERheSgpID09PSAwID8gNiA6IGQuZ2V0RGF5KCkgLSAxO1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGxhc3QgZGF5IG9mIHRoZSBtb250aFxuICAgKiBAcGFyYW0gIERhdGV8aW50ICBkICBEYXRlIG9yIHRpbWVzdGFtcCBpbiBtaWxsaXNlY29uZHNcbiAgICogQHJldHVybiBEYXRlICAgICAgTGFzdCBkYXkgb2YgdGhlIG1vbnRoXG4gICAqL1xuICBnZXRFbmRPZk1vbnRoOiBmdW5jdGlvbiAoZCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmICh0eXBlb2YgZCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGQgPSBuZXcgRGF0ZShkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IERhdGUoZC5nZXRGdWxsWWVhcigpLCBkLmdldE1vbnRoKCkgKyAxLCAwKTtcbiAgfSxcblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtICBEYXRlIGRhdGVcbiAgICogQHBhcmFtICBpbnQgY291bnRcbiAgICogQHBhcmFtICBzdHJpbmcgc3RlcFxuICAgKiBAcmV0dXJuIERhdGVcbiAgICovXG4gIGp1bXBEYXRlOiBmdW5jdGlvbiAoZGF0ZSwgY291bnQsIHN0ZXApIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgZCA9IG5ldyBEYXRlKGRhdGUpO1xuXG4gICAgc3dpdGNoIChzdGVwKSB7XG4gICAgICBjYXNlICdob3VyJzpcbiAgICAgICAgZC5zZXRIb3VycyhkLmdldEhvdXJzKCkgKyBjb3VudCk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdkYXknOlxuICAgICAgICBkLnNldEhvdXJzKGQuZ2V0SG91cnMoKSArIGNvdW50ICogMjQpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgIGQuc2V0SG91cnMoZC5nZXRIb3VycygpICsgY291bnQgKiAyNCAqIDcpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnbW9udGgnOlxuICAgICAgICBkLnNldE1vbnRoKGQuZ2V0TW9udGgoKSArIGNvdW50KTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ3llYXInOlxuICAgICAgICBkLnNldEZ1bGxZZWFyKGQuZ2V0RnVsbFllYXIoKSArIGNvdW50KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IERhdGUoZCk7XG4gIH0sXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuICAvLyBET01BSU4gQ09NUFVUQVRJT04gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cbiAgLyoqXG4gICAqIFJldHVybiBhbGwgdGhlIG1pbnV0ZXMgYmV0d2VlbiAyIGRhdGVzXG4gICAqXG4gICAqIEBwYXJhbSAgRGF0ZSAgZCAgZGF0ZSAgQSBkYXRlXG4gICAqIEBwYXJhbSAgaW50fGRhdGUgIHJhbmdlICBOdW1iZXIgb2YgbWludXRlcyBpbiB0aGUgcmFuZ2UsIG9yIGEgc3RvcCBkYXRlXG4gICAqIEByZXR1cm4gYXJyYXkgIEFuIGFycmF5IG9mIG1pbnV0ZXNcbiAgICovXG4gIGdldE1pbnV0ZURvbWFpbjogZnVuY3Rpb24gKGQsIHJhbmdlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHN0YXJ0ID0gbmV3IERhdGUoZC5nZXRGdWxsWWVhcigpLCBkLmdldE1vbnRoKCksIGQuZ2V0RGF0ZSgpLCBkLmdldEhvdXJzKCkpO1xuICAgIHZhciBzdG9wID0gbnVsbDtcblxuICAgIGlmIChyYW5nZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgIHN0b3AgPSBuZXcgRGF0ZShyYW5nZS5nZXRGdWxsWWVhcigpLCByYW5nZS5nZXRNb250aCgpLCByYW5nZS5nZXREYXRlKCksIHJhbmdlLmdldEhvdXJzKCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdG9wID0gbmV3IERhdGUoK3N0YXJ0ICsgcmFuZ2UgKiAxMDAwICogNjApO1xuICAgIH1cblxuICAgIHJldHVybiBkMy50aW1lLm1pbnV0ZXMoTWF0aC5taW4oc3RhcnQsIHN0b3ApLCBNYXRoLm1heChzdGFydCwgc3RvcCkpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZXR1cm4gYWxsIHRoZSBob3VycyBiZXR3ZWVuIDIgZGF0ZXNcbiAgICpcbiAgICogQHBhcmFtICBEYXRlICBkICBBIGRhdGVcbiAgICogQHBhcmFtICBpbnR8ZGF0ZSAgcmFuZ2UgIE51bWJlciBvZiBob3VycyBpbiB0aGUgcmFuZ2UsIG9yIGEgc3RvcCBkYXRlXG4gICAqIEByZXR1cm4gYXJyYXkgIEFuIGFycmF5IG9mIGhvdXJzXG4gICAqL1xuICBnZXRIb3VyRG9tYWluOiBmdW5jdGlvbiAoZCwgcmFuZ2UpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgc3RhcnQgPSBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSwgZC5nZXREYXRlKCksIGQuZ2V0SG91cnMoKSk7XG4gICAgdmFyIHN0b3AgPSBudWxsO1xuXG4gICAgaWYgKHJhbmdlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgc3RvcCA9IG5ldyBEYXRlKHJhbmdlLmdldEZ1bGxZZWFyKCksIHJhbmdlLmdldE1vbnRoKCksIHJhbmdlLmdldERhdGUoKSwgcmFuZ2UuZ2V0SG91cnMoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0b3AgPSBuZXcgRGF0ZShzdGFydCk7XG4gICAgICBzdG9wLnNldEhvdXJzKHN0b3AuZ2V0SG91cnMoKSArIHJhbmdlKTtcbiAgICB9XG5cbiAgICB2YXIgZG9tYWlucyA9IGQzLnRpbWUuaG91cnMoTWF0aC5taW4oc3RhcnQsIHN0b3ApLCBNYXRoLm1heChzdGFydCwgc3RvcCkpOyAvLyBQYXNzaW5nIGZyb20gRFNUIHRvIHN0YW5kYXJkIHRpbWVcbiAgICAvLyBJZiB0aGVyZSBhcmUgMjUgaG91cnMsIGxldCdzIGNvbXByZXNzIHRoZSBkdXBsaWNhdGUgaG91cnNcblxuICAgIHZhciBpID0gMDtcbiAgICB2YXIgdG90YWwgPSBkb21haW5zLmxlbmd0aDtcblxuICAgIGZvciAoaSA9IDA7IGkgPCB0b3RhbDsgaSArPSAxKSB7XG4gICAgICBpZiAoaSA+IDAgJiYgZG9tYWluc1tpXS5nZXRIb3VycygpID09PSBkb21haW5zW2kgLSAxXS5nZXRIb3VycygpKSB7XG4gICAgICAgIHRoaXMuRFNURG9tYWluLnB1c2goZG9tYWluc1tpXS5nZXRUaW1lKCkpO1xuICAgICAgICBkb21haW5zLnNwbGljZShpLCAxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSAvLyBkMy50aW1lLmhvdXJzIGlzIHJldHVybmluZyBtb3JlIGhvdXJzIHRoYW4gbmVlZGVkIHdoZW4gY2hhbmdpbmdcbiAgICAvLyBmcm9tIERTVCB0byBzdGFuZGFyZCB0aW1lLCBiZWNhdXNlIHRoZXJlIGlzIHJlYWxseSAyIGhvdXJzIGJldHdlZW5cbiAgICAvLyAxYW0gYW5kIDJhbSFcblxuXG4gICAgaWYgKHR5cGVvZiByYW5nZSA9PT0gJ251bWJlcicgJiYgZG9tYWlucy5sZW5ndGggPiBNYXRoLmFicyhyYW5nZSkpIHtcbiAgICAgIGRvbWFpbnMuc3BsaWNlKGRvbWFpbnMubGVuZ3RoIC0gMSwgMSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRvbWFpbnM7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJldHVybiBhbGwgdGhlIGRheXMgYmV0d2VlbiAyIGRhdGVzXG4gICAqXG4gICAqIEBwYXJhbSAgRGF0ZSAgICBkICAgIEEgZGF0ZVxuICAgKiBAcGFyYW0gIGludHxkYXRlICByYW5nZSAgTnVtYmVyIG9mIGRheXMgaW4gdGhlIHJhbmdlLCBvciBhIHN0b3AgZGF0ZVxuICAgKiBAcmV0dXJuIGFycmF5ICBBbiBhcnJheSBvZiB3ZWVrc1xuICAgKi9cbiAgZ2V0RGF5RG9tYWluOiBmdW5jdGlvbiAoZCwgcmFuZ2UpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgc3RhcnQgPSBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSwgZC5nZXREYXRlKCkpO1xuICAgIHZhciBzdG9wID0gbnVsbDtcblxuICAgIGlmIChyYW5nZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgIHN0b3AgPSBuZXcgRGF0ZShyYW5nZS5nZXRGdWxsWWVhcigpLCByYW5nZS5nZXRNb250aCgpLCByYW5nZS5nZXREYXRlKCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdG9wID0gbmV3IERhdGUoc3RhcnQpO1xuICAgICAgc3RvcCA9IG5ldyBEYXRlKHN0b3Auc2V0RGF0ZShzdG9wLmdldERhdGUoKSArIHBhcnNlSW50KHJhbmdlLCAxMCkpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZDMudGltZS5kYXlzKE1hdGgubWluKHN0YXJ0LCBzdG9wKSwgTWF0aC5tYXgoc3RhcnQsIHN0b3ApKTtcbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJuIGFsbCB0aGUgd2Vla3MgYmV0d2VlbiAyIGRhdGVzXG4gICAqXG4gICAqIEBwYXJhbSAgRGF0ZSAgZCAgQSBkYXRlXG4gICAqIEBwYXJhbSAgaW50fGRhdGUgIHJhbmdlICBOdW1iZXIgb2YgbWludXRlcyBpbiB0aGUgcmFuZ2UsIG9yIGEgc3RvcCBkYXRlXG4gICAqIEByZXR1cm4gYXJyYXkgIEFuIGFycmF5IG9mIHdlZWtzXG4gICAqL1xuICBnZXRXZWVrRG9tYWluOiBmdW5jdGlvbiAoZCwgcmFuZ2UpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgd2Vla1N0YXJ0O1xuXG4gICAgaWYgKHRoaXMub3B0aW9ucy53ZWVrU3RhcnRPbk1vbmRheSA9PT0gZmFsc2UpIHtcbiAgICAgIHdlZWtTdGFydCA9IG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpLCBkLmdldERhdGUoKSAtIGQuZ2V0RGF5KCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZC5nZXREYXkoKSA9PT0gMSkge1xuICAgICAgICB3ZWVrU3RhcnQgPSBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSwgZC5nZXREYXRlKCkpO1xuICAgICAgfSBlbHNlIGlmIChkLmdldERheSgpID09PSAwKSB7XG4gICAgICAgIHdlZWtTdGFydCA9IG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpLCBkLmdldERhdGUoKSk7XG4gICAgICAgIHdlZWtTdGFydC5zZXREYXRlKHdlZWtTdGFydC5nZXREYXRlKCkgLSA2KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHdlZWtTdGFydCA9IG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpLCBkLmdldERhdGUoKSAtIGQuZ2V0RGF5KCkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZW5kRGF0ZSA9IG5ldyBEYXRlKHdlZWtTdGFydCk7XG4gICAgdmFyIHN0b3AgPSByYW5nZTtcblxuICAgIGlmICh0eXBlb2YgcmFuZ2UgIT09ICdvYmplY3QnKSB7XG4gICAgICBzdG9wID0gbmV3IERhdGUoZW5kRGF0ZS5zZXREYXRlKGVuZERhdGUuZ2V0RGF0ZSgpICsgcmFuZ2UgKiA3KSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy53ZWVrU3RhcnRPbk1vbmRheSA9PT0gdHJ1ZSA/IGQzLnRpbWUubW9uZGF5cyhNYXRoLm1pbih3ZWVrU3RhcnQsIHN0b3ApLCBNYXRoLm1heCh3ZWVrU3RhcnQsIHN0b3ApKSA6IGQzLnRpbWUuc3VuZGF5cyhNYXRoLm1pbih3ZWVrU3RhcnQsIHN0b3ApLCBNYXRoLm1heCh3ZWVrU3RhcnQsIHN0b3ApKTtcbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJuIGFsbCB0aGUgbW9udGhzIGJldHdlZW4gMiBkYXRlc1xuICAgKlxuICAgKiBAcGFyYW0gIERhdGUgICAgZCAgICBBIGRhdGVcbiAgICogQHBhcmFtICBpbnR8ZGF0ZSAgcmFuZ2UgIE51bWJlciBvZiBtb250aHMgaW4gdGhlIHJhbmdlLCBvciBhIHN0b3AgZGF0ZVxuICAgKiBAcmV0dXJuIGFycmF5ICBBbiBhcnJheSBvZiBtb250aHNcbiAgICovXG4gIGdldE1vbnRoRG9tYWluOiBmdW5jdGlvbiAoZCwgcmFuZ2UpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgc3RhcnQgPSBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSk7XG4gICAgdmFyIHN0b3AgPSBudWxsO1xuXG4gICAgaWYgKHJhbmdlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgc3RvcCA9IG5ldyBEYXRlKHJhbmdlLmdldEZ1bGxZZWFyKCksIHJhbmdlLmdldE1vbnRoKCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdG9wID0gbmV3IERhdGUoc3RhcnQpO1xuICAgICAgc3RvcCA9IHN0b3Auc2V0TW9udGgoc3RvcC5nZXRNb250aCgpICsgcmFuZ2UpO1xuICAgIH1cblxuICAgIHJldHVybiBkMy50aW1lLm1vbnRocyhNYXRoLm1pbihzdGFydCwgc3RvcCksIE1hdGgubWF4KHN0YXJ0LCBzdG9wKSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJldHVybiBhbGwgdGhlIHllYXJzIGJldHdlZW4gMiBkYXRlc1xuICAgKlxuICAgKiBAcGFyYW0gIERhdGUgIGQgIGRhdGUgIEEgZGF0ZVxuICAgKiBAcGFyYW0gIGludHxkYXRlICByYW5nZSAgTnVtYmVyIG9mIG1pbnV0ZXMgaW4gdGhlIHJhbmdlLCBvciBhIHN0b3AgZGF0ZVxuICAgKiBAcmV0dXJuIGFycmF5ICBBbiBhcnJheSBvZiBob3Vyc1xuICAgKi9cbiAgZ2V0WWVhckRvbWFpbjogZnVuY3Rpb24gKGQsIHJhbmdlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHN0YXJ0ID0gbmV3IERhdGUoZC5nZXRGdWxsWWVhcigpLCAwKTtcbiAgICB2YXIgc3RvcCA9IG51bGw7XG5cbiAgICBpZiAocmFuZ2UgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICBzdG9wID0gbmV3IERhdGUocmFuZ2UuZ2V0RnVsbFllYXIoKSwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0b3AgPSBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCkgKyByYW5nZSwgMCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGQzLnRpbWUueWVhcnMoTWF0aC5taW4oc3RhcnQsIHN0b3ApLCBNYXRoLm1heChzdGFydCwgc3RvcCkpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgYW4gYXJyYXkgb2YgZG9tYWluIHN0YXJ0IGRhdGVzXG4gICAqXG4gICAqIEBwYXJhbSAgaW50fERhdGUgZGF0ZSBBIHJhbmRvbSBkYXRlIGluY2x1ZGVkIGluIHRoZSB3YW50ZWQgZG9tYWluXG4gICAqIEBwYXJhbSAgaW50fERhdGUgcmFuZ2UgTnVtYmVyIG9mIGRhdGVzIHRvIGdldCwgb3IgYSBzdG9wIGRhdGVcbiAgICogQHJldHVybiBBcnJheSBvZiBkYXRlc1xuICAgKi9cbiAgZ2V0RG9tYWluOiBmdW5jdGlvbiAoZGF0ZSwgcmFuZ2UpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAodHlwZW9mIGRhdGUgPT09ICdudW1iZXInKSB7XG4gICAgICBkYXRlID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgfVxuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG4gICAgICByYW5nZSA9IHRoaXMub3B0aW9ucy5yYW5nZTtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKHRoaXMub3B0aW9ucy5kb21haW4pIHtcbiAgICAgIGNhc2UgJ2hvdXInOlxuICAgICAgICB2YXIgZG9tYWlucyA9IHRoaXMuZ2V0SG91ckRvbWFpbihkYXRlLCByYW5nZSk7IC8vIENhc2Ugd2hlcmUgYW4gaG91ciBpcyBtaXNzaW5nLCB3aGVuIHBhc3NpbmcgZnJvbSBzdGFuZGFyZCB0aW1lIHRvIERTVFxuICAgICAgICAvLyBNaXNzaW5nIGhvdXIgaXMgcGVyZmVjdGx5IGFjY2VwdGFibCBpbiBzdWJEb21haW4sIGJ1dCBub3QgaW4gZG9tYWluc1xuXG4gICAgICAgIGlmICh0eXBlb2YgcmFuZ2UgPT09ICdudW1iZXInICYmIGRvbWFpbnMubGVuZ3RoIDwgcmFuZ2UpIHtcbiAgICAgICAgICBpZiAocmFuZ2UgPiAwKSB7XG4gICAgICAgICAgICBkb21haW5zLnB1c2godGhpcy5nZXRIb3VyRG9tYWluKGRvbWFpbnNbZG9tYWlucy5sZW5ndGggLSAxXSwgMilbMV0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkb21haW5zLnNoaWZ0KHRoaXMuZ2V0SG91ckRvbWFpbihkb21haW5zWzBdLCAtMilbMF0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkb21haW5zO1xuXG4gICAgICBjYXNlICdkYXknOlxuICAgICAgICByZXR1cm4gdGhpcy5nZXREYXlEb21haW4oZGF0ZSwgcmFuZ2UpO1xuXG4gICAgICBjYXNlICd3ZWVrJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0V2Vla0RvbWFpbihkYXRlLCByYW5nZSk7XG5cbiAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TW9udGhEb21haW4oZGF0ZSwgcmFuZ2UpO1xuXG4gICAgICBjYXNlICd5ZWFyJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0WWVhckRvbWFpbihkYXRlLCByYW5nZSk7XG4gICAgfVxuICB9LFxuXG4gIC8qIGpzaGludCBtYXhjb21wbGV4aXR5OiBmYWxzZSAqL1xuICBnZXRTdWJEb21haW46IGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHR5cGVvZiBkYXRlID09PSAnbnVtYmVyJykge1xuICAgICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgIH1cblxuICAgIHZhciBwYXJlbnQgPSB0aGlzO1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gaW50XG4gICAgICovXG5cbiAgICB2YXIgY29tcHV0ZURheVN1YkRvbWFpblNpemUgPSBmdW5jdGlvbiAoZGF0ZSwgZG9tYWluKSB7XG4gICAgICBzd2l0Y2ggKGRvbWFpbikge1xuICAgICAgICBjYXNlICd5ZWFyJzpcbiAgICAgICAgICByZXR1cm4gcGFyZW50LmdldERheUNvdW50SW5ZZWFyKGRhdGUpO1xuXG4gICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICByZXR1cm4gcGFyZW50LmdldERheUNvdW50SW5Nb250aChkYXRlKTtcblxuICAgICAgICBjYXNlICd3ZWVrJzpcbiAgICAgICAgICByZXR1cm4gNztcbiAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gaW50XG4gICAgICovXG5cblxuICAgIHZhciBjb21wdXRlTWluU3ViRG9tYWluU2l6ZSA9IGZ1bmN0aW9uIChkYXRlLCBkb21haW4pIHtcbiAgICAgIHN3aXRjaCAoZG9tYWluKSB7XG4gICAgICAgIGNhc2UgJ2hvdXInOlxuICAgICAgICAgIHJldHVybiA2MDtcblxuICAgICAgICBjYXNlICdkYXknOlxuICAgICAgICAgIHJldHVybiA2MCAqIDI0O1xuXG4gICAgICAgIGNhc2UgJ3dlZWsnOlxuICAgICAgICAgIHJldHVybiA2MCAqIDI0ICogNztcbiAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gaW50XG4gICAgICovXG5cblxuICAgIHZhciBjb21wdXRlSG91clN1YkRvbWFpblNpemUgPSBmdW5jdGlvbiAoZGF0ZSwgZG9tYWluKSB7XG4gICAgICBzd2l0Y2ggKGRvbWFpbikge1xuICAgICAgICBjYXNlICdkYXknOlxuICAgICAgICAgIHJldHVybiAyNDtcblxuICAgICAgICBjYXNlICd3ZWVrJzpcbiAgICAgICAgICByZXR1cm4gMTY4O1xuXG4gICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICByZXR1cm4gcGFyZW50LmdldERheUNvdW50SW5Nb250aChkYXRlKSAqIDI0O1xuICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiBpbnRcbiAgICAgKi9cblxuXG4gICAgdmFyIGNvbXB1dGVXZWVrU3ViRG9tYWluU2l6ZSA9IGZ1bmN0aW9uIChkYXRlLCBkb21haW4pIHtcbiAgICAgIGlmIChkb21haW4gPT09ICdtb250aCcpIHtcbiAgICAgICAgdmFyIGVuZE9mTW9udGggPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSArIDEsIDApO1xuICAgICAgICB2YXIgZW5kV2Vla05iID0gcGFyZW50LmdldFdlZWtOdW1iZXIoZW5kT2ZNb250aCk7XG4gICAgICAgIHZhciBzdGFydFdlZWtOYiA9IHBhcmVudC5nZXRXZWVrTnVtYmVyKG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpKSk7XG5cbiAgICAgICAgaWYgKHN0YXJ0V2Vla05iID4gZW5kV2Vla05iKSB7XG4gICAgICAgICAgc3RhcnRXZWVrTmIgPSAwO1xuICAgICAgICAgIGVuZFdlZWtOYiArPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGVuZFdlZWtOYiAtIHN0YXJ0V2Vla05iICsgMTtcbiAgICAgIH0gZWxzZSBpZiAoZG9tYWluID09PSAneWVhcicpIHtcbiAgICAgICAgcmV0dXJuIHBhcmVudC5nZXRXZWVrTnVtYmVyKG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgMTEsIDMxKSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLnN1YkRvbWFpbikge1xuICAgICAgY2FzZSAneF9taW4nOlxuICAgICAgY2FzZSAnbWluJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWludXRlRG9tYWluKGRhdGUsIGNvbXB1dGVNaW5TdWJEb21haW5TaXplKGRhdGUsIHRoaXMub3B0aW9ucy5kb21haW4pKTtcblxuICAgICAgY2FzZSAneF9ob3VyJzpcbiAgICAgIGNhc2UgJ2hvdXInOlxuICAgICAgICByZXR1cm4gdGhpcy5nZXRIb3VyRG9tYWluKGRhdGUsIGNvbXB1dGVIb3VyU3ViRG9tYWluU2l6ZShkYXRlLCB0aGlzLm9wdGlvbnMuZG9tYWluKSk7XG5cbiAgICAgIGNhc2UgJ3hfZGF5JzpcbiAgICAgIGNhc2UgJ2RheSc6XG4gICAgICAgIHJldHVybiB0aGlzLmdldERheURvbWFpbihkYXRlLCBjb21wdXRlRGF5U3ViRG9tYWluU2l6ZShkYXRlLCB0aGlzLm9wdGlvbnMuZG9tYWluKSk7XG5cbiAgICAgIGNhc2UgJ3hfd2Vlayc6XG4gICAgICBjYXNlICd3ZWVrJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0V2Vla0RvbWFpbihkYXRlLCBjb21wdXRlV2Vla1N1YkRvbWFpblNpemUoZGF0ZSwgdGhpcy5vcHRpb25zLmRvbWFpbikpO1xuXG4gICAgICBjYXNlICd4X21vbnRoJzpcbiAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TW9udGhEb21haW4oZGF0ZSwgMTIpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogR2V0IHRoZSBuLXRoIG5leHQgZG9tYWluIGFmdGVyIHRoZSBjYWxlbmRhciBuZXdlc3QgKHJpZ2h0bW9zdCkgZG9tYWluXG4gICAqIEBwYXJhbSAgaW50IG5cbiAgICogQHJldHVybiBEYXRlIFRoZSBzdGFydCBkYXRlIG9mIHRoZSB3YW50ZWQgZG9tYWluXG4gICAqL1xuICBnZXROZXh0RG9tYWluOiBmdW5jdGlvbiAobikge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBuID0gMTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5nZXREb21haW4odGhpcy5qdW1wRGF0ZSh0aGlzLmdldERvbWFpbktleXMoKS5wb3AoKSwgbiwgdGhpcy5vcHRpb25zLmRvbWFpbiksIDEpWzBdO1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIG4tdGggZG9tYWluIGJlZm9yZSB0aGUgY2FsZW5kYXIgb2xkZXN0IChsZWZ0bW9zdCkgZG9tYWluXG4gICAqIEBwYXJhbSAgaW50IG5cbiAgICogQHJldHVybiBEYXRlIFRoZSBzdGFydCBkYXRlIG9mIHRoZSB3YW50ZWQgZG9tYWluXG4gICAqL1xuICBnZXRQcmV2aW91c0RvbWFpbjogZnVuY3Rpb24gKG4pIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgbiA9IDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZ2V0RG9tYWluKHRoaXMuanVtcERhdGUodGhpcy5nZXREb21haW5LZXlzKCkuc2hpZnQoKSwgLW4sIHRoaXMub3B0aW9ucy5kb21haW4pLCAxKVswXTtcbiAgfSxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG4gIC8vIERBVEFTICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuXG4gIC8qKlxuICAgKiBGZXRjaCBhbmQgaW50ZXJwcmV0IGRhdGEgZnJvbSB0aGUgZGF0YXNvdXJjZVxuICAgKlxuICAgKiBAcGFyYW0gc3RyaW5nfG9iamVjdCBzb3VyY2VcbiAgICogQHBhcmFtIERhdGUgc3RhcnREYXRlXG4gICAqIEBwYXJhbSBEYXRlIGVuZERhdGVcbiAgICogQHBhcmFtIGZ1bmN0aW9uIGNhbGxiYWNrXG4gICAqIEBwYXJhbSBmdW5jdGlvbnxib29sZWFuIGFmdGVyTG9hZCBmdW5jdGlvbiB1c2VkIHRvIGNvbnZlcnQgdGhlIGRhdGEgaW50byBhIGpzb24gb2JqZWN0LiBVc2UgdHJ1ZSB0byB1c2UgdGhlIGFmdGVyTG9hZCBjYWxsYmFja1xuICAgKiBAcGFyYW0gdXBkYXRlTW9kZVxuICAgKlxuICAgKiBAcmV0dXJuIG1peGVkXG4gICAqIC0gVHJ1ZSBpZiB0aGVyZSBhcmUgbm8gZGF0YSB0byBsb2FkXG4gICAqIC0gRmFsc2UgaWYgZGF0YSBhcmUgbG9hZGVkIGFzeW5jaHJvbm91c2x5XG4gICAqL1xuICBnZXREYXRhczogZnVuY3Rpb24gKHNvdXJjZSwgc3RhcnREYXRlLCBlbmREYXRlLCBjYWxsYmFjaywgYWZ0ZXJMb2FkLCB1cGRhdGVNb2RlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCA1KSB7XG4gICAgICBhZnRlckxvYWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgNikge1xuICAgICAgdXBkYXRlTW9kZSA9IHRoaXMuQVBQRU5EX09OX1VQREFURTtcbiAgICB9XG5cbiAgICB2YXIgX2NhbGxiYWNrID0gZnVuY3Rpb24gKGVycm9yLCBkYXRhKSB7XG4gICAgICBpZiAoYWZ0ZXJMb2FkICE9PSBmYWxzZSkge1xuICAgICAgICBpZiAodHlwZW9mIGFmdGVyTG9hZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGRhdGEgPSBhZnRlckxvYWQoZGF0YSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNlbGYub3B0aW9ucy5hZnRlckxvYWREYXRhID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgZGF0YSA9IHNlbGYub3B0aW9ucy5hZnRlckxvYWREYXRhKGRhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm92aWRlZCBjYWxsYmFjayBmb3IgYWZ0ZXJMb2FkRGF0YSBpcyBub3QgYSBmdW5jdGlvbi4nKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChzZWxmLm9wdGlvbnMuZGF0YVR5cGUgPT09ICdjc3YnIHx8IHNlbGYub3B0aW9ucy5kYXRhVHlwZSA9PT0gJ3RzdicpIHtcbiAgICAgICAgZGF0YSA9IHRoaXMuaW50ZXJwcmV0Q1NWKGRhdGEpO1xuICAgICAgfVxuXG4gICAgICBzZWxmLnBhcnNlRGF0YXMoZGF0YSwgdXBkYXRlTW9kZSwgc3RhcnREYXRlLCBlbmREYXRlKTtcblxuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBzd2l0Y2ggKHR5cGVvZiBzb3VyY2UpIHtcbiAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgIGlmIChzb3VyY2UgPT09ICcnKSB7XG4gICAgICAgICAgX2NhbGxiYWNrKG51bGwsIHt9KTtcblxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciB1cmwgPSB0aGlzLnBhcnNlVVJJKHNvdXJjZSwgc3RhcnREYXRlLCBlbmREYXRlKTtcbiAgICAgICAgICB2YXIgcmVxdWVzdFR5cGUgPSAnR0VUJztcblxuICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMuZGF0YVBvc3RQYXlsb2FkICE9PSBudWxsKSB7XG4gICAgICAgICAgICByZXF1ZXN0VHlwZSA9ICdQT1NUJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgcGF5bG9hZCA9IG51bGw7XG5cbiAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmRhdGFQb3N0UGF5bG9hZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcGF5bG9hZCA9IHRoaXMucGFyc2VVUkkoc2VsZi5vcHRpb25zLmRhdGFQb3N0UGF5bG9hZCwgc3RhcnREYXRlLCBlbmREYXRlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgeGhyID0gbnVsbDtcblxuICAgICAgICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLmRhdGFUeXBlKSB7XG4gICAgICAgICAgICBjYXNlICdqc29uJzpcbiAgICAgICAgICAgICAgeGhyID0gZDMuanNvbih1cmwpO1xuICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnY3N2JzpcbiAgICAgICAgICAgICAgeGhyID0gZDMuY3N2KHVybCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICd0c3YnOlxuICAgICAgICAgICAgICB4aHIgPSBkMy50c3YodXJsKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3R4dCc6XG4gICAgICAgICAgICAgIHhociA9IGQzLnRleHQodXJsLCAndGV4dC9wbGFpbicpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9IC8vIGpzaGludCBtYXhkZXB0aDo1XG5cblxuICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMuZGF0YVJlcXVlc3RIZWFkZXJzICE9PSBudWxsKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBoZWFkZXIgaW4gc2VsZi5vcHRpb25zLmRhdGFSZXF1ZXN0SGVhZGVycykge1xuICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmRhdGFSZXF1ZXN0SGVhZGVycy5oYXNPd25Qcm9wZXJ0eShoZWFkZXIpKSB7XG4gICAgICAgICAgICAgICAgeGhyLmhlYWRlcihoZWFkZXIsIHNlbGYub3B0aW9ucy5kYXRhUmVxdWVzdEhlYWRlcnNbaGVhZGVyXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB4aHIuc2VuZChyZXF1ZXN0VHlwZSwgcGF5bG9hZCwgX2NhbGxiYWNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgaWYgKHNvdXJjZSA9PT0gT2JqZWN0KHNvdXJjZSkpIHtcbiAgICAgICAgICBfY2FsbGJhY2sobnVsbCwgc291cmNlKTtcblxuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAvKiBmYWxscyB0aHJvdWdoICovXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIF9jYWxsYmFjayhudWxsLCB7fSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBQb3B1bGF0ZSB0aGUgY2FsZW5kYXIgaW50ZXJuYWwgZGF0YVxuICAgKlxuICAgKiBAcGFyYW0gb2JqZWN0IGRhdGFcbiAgICogQHBhcmFtIGNvbnN0YW50IHVwZGF0ZU1vZGVcbiAgICogQHBhcmFtIERhdGUgc3RhcnREYXRlXG4gICAqIEBwYXJhbSBEYXRlIGVuZERhdGVcbiAgICpcbiAgICogQHJldHVybiB2b2lkXG4gICAqL1xuICBwYXJzZURhdGFzOiBmdW5jdGlvbiAoZGF0YSwgdXBkYXRlTW9kZSwgc3RhcnREYXRlLCBlbmREYXRlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKHVwZGF0ZU1vZGUgPT09IHRoaXMuUkVTRVRfQUxMX09OX1VQREFURSkge1xuICAgICAgdGhpcy5fZG9tYWlucy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4LCBhcnJheSkge1xuICAgICAgICAgIGFycmF5W2luZGV4XS52ID0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB2YXIgdGVtcCA9IHt9O1xuXG4gICAgdmFyIGV4dHJhY3RUaW1lID0gZnVuY3Rpb24gKGQpIHtcbiAgICAgIHJldHVybiBkLnQ7XG4gICAgfTtcbiAgICAvKmpzaGludCBmb3JpbjpmYWxzZSAqL1xuXG5cbiAgICBmb3IgKHZhciBkIGluIGRhdGEpIHtcbiAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZCAqIDEwMDApO1xuICAgICAgdmFyIGRvbWFpblVuaXQgPSB0aGlzLmdldERvbWFpbihkYXRlKVswXS5nZXRUaW1lKCk7IC8vIFRoZSBjdXJyZW50IGRhdGEgYmVsb25ncyB0byBhIGRvbWFpbiB0aGF0IHdhcyBjb21wcmVzc2VkXG4gICAgICAvLyBDb21wcmVzcyB0aGUgZGF0YSBmb3IgdGhlIHR3byBkdXBsaWNhdGUgaG91cnMgaW50byB0aGUgc2FtZSBob3VyXG5cbiAgICAgIGlmICh0aGlzLkRTVERvbWFpbi5pbmRleE9mKGRvbWFpblVuaXQpID49IDApIHtcbiAgICAgICAgLy8gUmUtYXNzaWduIGFsbCBkYXRhIHRvIHRoZSBmaXJzdCBvciB0aGUgc2Vjb25kIGR1cGxpY2F0ZSBob3Vyc1xuICAgICAgICAvLyBkZXBlbmRpbmcgb24gd2hpY2ggaXMgdmlzaWJsZVxuICAgICAgICBpZiAodGhpcy5fZG9tYWlucy5oYXMoZG9tYWluVW5pdCAtIDM2MDAgKiAxMDAwKSkge1xuICAgICAgICAgIGRvbWFpblVuaXQgLT0gMzYwMCAqIDEwMDA7XG4gICAgICAgIH1cbiAgICAgIH0gLy8gU2tpcCBpZiBkYXRhIGlzIG5vdCByZWxldmFudCB0byBjdXJyZW50IGRvbWFpblxuXG5cbiAgICAgIGlmIChpc05hTihkKSB8fCAhZGF0YS5oYXNPd25Qcm9wZXJ0eShkKSB8fCAhdGhpcy5fZG9tYWlucy5oYXMoZG9tYWluVW5pdCkgfHwgIShkb21haW5Vbml0ID49ICtzdGFydERhdGUgJiYgZG9tYWluVW5pdCA8ICtlbmREYXRlKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIHN1YkRvbWFpbnNEYXRhID0gdGhpcy5fZG9tYWlucy5nZXQoZG9tYWluVW5pdCk7XG5cbiAgICAgIGlmICghdGVtcC5oYXNPd25Qcm9wZXJ0eShkb21haW5Vbml0KSkge1xuICAgICAgICB0ZW1wW2RvbWFpblVuaXRdID0gc3ViRG9tYWluc0RhdGEubWFwKGV4dHJhY3RUaW1lKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGluZGV4ID0gdGVtcFtkb21haW5Vbml0XS5pbmRleE9mKHRoaXMuX2RvbWFpblR5cGVbdGhpcy5vcHRpb25zLnN1YkRvbWFpbl0uZXh0cmFjdFVuaXQoZGF0ZSkpO1xuXG4gICAgICBpZiAodXBkYXRlTW9kZSA9PT0gdGhpcy5SRVNFVF9TSU5HTEVfT05fVVBEQVRFKSB7XG4gICAgICAgIHN1YkRvbWFpbnNEYXRhW2luZGV4XS52ID0gZGF0YVtkXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghaXNOYU4oc3ViRG9tYWluc0RhdGFbaW5kZXhdLnYpKSB7XG4gICAgICAgICAgc3ViRG9tYWluc0RhdGFbaW5kZXhdLnYgKz0gZGF0YVtkXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdWJEb21haW5zRGF0YVtpbmRleF0udiA9IGRhdGFbZF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIHBhcnNlVVJJOiBmdW5jdGlvbiAoc3RyLCBzdGFydERhdGUsIGVuZERhdGUpIHtcbiAgICAndXNlIHN0cmljdCc7IC8vIFVzZSBhIHRpbWVzdGFtcCBpbiBzZWNvbmRzXG5cbiAgICBzdHIgPSBzdHIucmVwbGFjZSgvXFx7XFx7dDpzdGFydFxcfVxcfS9nLCBzdGFydERhdGUuZ2V0VGltZSgpIC8gMTAwMCk7XG4gICAgc3RyID0gc3RyLnJlcGxhY2UoL1xce1xce3Q6ZW5kXFx9XFx9L2csIGVuZERhdGUuZ2V0VGltZSgpIC8gMTAwMCk7IC8vIFVzZSBhIHN0cmluZyBkYXRlLCBmb2xsb3dpbmcgdGhlIElTTy04NjAxXG5cbiAgICBzdHIgPSBzdHIucmVwbGFjZSgvXFx7XFx7ZDpzdGFydFxcfVxcfS9nLCBzdGFydERhdGUudG9JU09TdHJpbmcoKSk7XG4gICAgc3RyID0gc3RyLnJlcGxhY2UoL1xce1xce2Q6ZW5kXFx9XFx9L2csIGVuZERhdGUudG9JU09TdHJpbmcoKSk7XG4gICAgcmV0dXJuIHN0cjtcbiAgfSxcbiAgaW50ZXJwcmV0Q1NWOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBkID0ge307XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkYXRhWzBdKTtcbiAgICB2YXIgaSwgdG90YWw7XG5cbiAgICBmb3IgKGkgPSAwLCB0b3RhbCA9IGRhdGEubGVuZ3RoOyBpIDwgdG90YWw7IGkgKz0gMSkge1xuICAgICAgZFtkYXRhW2ldW2tleXNbMF1dXSA9ICtkYXRhW2ldW2tleXNbMV1dO1xuICAgIH1cblxuICAgIHJldHVybiBkO1xuICB9LFxuXG4gIC8qKlxuICAgKiBIYW5kbGUgdGhlIGNhbGVuZGFyIGxheW91dCBhbmQgZGltZW5zaW9uXG4gICAqXG4gICAqIEV4cGFuZCBhbmQgc2hyaW5rIHRoZSBjb250YWluZXIgZGVwZW5kaW5nIG9uIGl0cyBjaGlsZHJlbiBkaW1lbnNpb25cbiAgICogQWxzbyByZWFycmFuZ2UgdGhlIGNoaWxkcmVuIHBvc2l0aW9uIGRlcGVuZGluZyBvbiB0aGVpciBkaW1lbnNpb24sXG4gICAqIGFuZCB0aGUgbGVnZW5kIHBvc2l0aW9uXG4gICAqXG4gICAqIEByZXR1cm4gdm9pZFxuICAgKi9cbiAgcmVzaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHBhcmVudCA9IHRoaXM7XG4gICAgdmFyIG9wdGlvbnMgPSBwYXJlbnQub3B0aW9ucztcbiAgICB2YXIgbGVnZW5kV2lkdGggPSBvcHRpb25zLmRpc3BsYXlMZWdlbmQgPyBwYXJlbnQuTGVnZW5kLmdldERpbSgnd2lkdGgnKSArIG9wdGlvbnMubGVnZW5kTWFyZ2luWzFdICsgb3B0aW9ucy5sZWdlbmRNYXJnaW5bM10gOiAwO1xuICAgIHZhciBsZWdlbmRIZWlnaHQgPSBvcHRpb25zLmRpc3BsYXlMZWdlbmQgPyBwYXJlbnQuTGVnZW5kLmdldERpbSgnaGVpZ2h0JykgKyBvcHRpb25zLmxlZ2VuZE1hcmdpblswXSArIG9wdGlvbnMubGVnZW5kTWFyZ2luWzJdIDogMDtcbiAgICB2YXIgZ3JhcGhXaWR0aCA9IHBhcmVudC5ncmFwaERpbS53aWR0aCAtIG9wdGlvbnMuZG9tYWluR3V0dGVyIC0gb3B0aW9ucy5jZWxsUGFkZGluZztcbiAgICB2YXIgZ3JhcGhIZWlnaHQgPSBwYXJlbnQuZ3JhcGhEaW0uaGVpZ2h0IC0gb3B0aW9ucy5kb21haW5HdXR0ZXIgLSBvcHRpb25zLmNlbGxQYWRkaW5nO1xuICAgIHRoaXMucm9vdC50cmFuc2l0aW9uKCkuZHVyYXRpb24ob3B0aW9ucy5hbmltYXRpb25EdXJhdGlvbikuYXR0cignd2lkdGgnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAob3B0aW9ucy5sZWdlbmRWZXJ0aWNhbFBvc2l0aW9uID09PSAnbWlkZGxlJyB8fCBvcHRpb25zLmxlZ2VuZFZlcnRpY2FsUG9zaXRpb24gPT09ICdjZW50ZXInKSB7XG4gICAgICAgIHJldHVybiBncmFwaFdpZHRoICsgbGVnZW5kV2lkdGg7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBNYXRoLm1heChncmFwaFdpZHRoLCBsZWdlbmRXaWR0aCk7XG4gICAgfSkuYXR0cignaGVpZ2h0JywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKG9wdGlvbnMubGVnZW5kVmVydGljYWxQb3NpdGlvbiA9PT0gJ21pZGRsZScgfHwgb3B0aW9ucy5sZWdlbmRWZXJ0aWNhbFBvc2l0aW9uID09PSAnY2VudGVyJykge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgoZ3JhcGhIZWlnaHQsIGxlZ2VuZEhlaWdodCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBncmFwaEhlaWdodCArIGxlZ2VuZEhlaWdodDtcbiAgICB9KTtcbiAgICB0aGlzLnJvb3Quc2VsZWN0KCcuZ3JhcGgnKS50cmFuc2l0aW9uKCkuZHVyYXRpb24ob3B0aW9ucy5hbmltYXRpb25EdXJhdGlvbikuYXR0cigneScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChvcHRpb25zLmxlZ2VuZFZlcnRpY2FsUG9zaXRpb24gPT09ICd0b3AnKSB7XG4gICAgICAgIHJldHVybiBsZWdlbmRIZWlnaHQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAwO1xuICAgIH0pLmF0dHIoJ3gnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoKG9wdGlvbnMubGVnZW5kVmVydGljYWxQb3NpdGlvbiA9PT0gJ21pZGRsZScgfHwgb3B0aW9ucy5sZWdlbmRWZXJ0aWNhbFBvc2l0aW9uID09PSAnY2VudGVyJykgJiYgb3B0aW9ucy5sZWdlbmRIb3Jpem9udGFsUG9zaXRpb24gPT09ICdsZWZ0Jykge1xuICAgICAgICByZXR1cm4gbGVnZW5kV2lkdGg7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAwO1xuICAgIH0pO1xuICB9LFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly9cbiAgLy8gUFVCTElDIEFQSSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG5cbiAgLyoqXG4gICAqIFNoaWZ0IHRoZSBjYWxlbmRhciBmb3J3YXJkXG4gICAqL1xuICBuZXh0OiBmdW5jdGlvbiAobikge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBuID0gMTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5sb2FkTmV4dERvbWFpbihuKTtcbiAgfSxcblxuICAvKipcbiAgICogU2hpZnQgdGhlIGNhbGVuZGFyIGJhY2t3YXJkXG4gICAqL1xuICBwcmV2aW91czogZnVuY3Rpb24gKG4pIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgbiA9IDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubG9hZFByZXZpb3VzRG9tYWluKG4pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBKdW1wIGRpcmVjdGx5IHRvIGEgc3BlY2lmaWMgZGF0ZVxuICAgKlxuICAgKiBKdW1wVG8gd2lsbCBzY3JvbGwgdGhlIGNhbGVuZGFyIHVudGlsIHRoZSB3YW50ZWQgZG9tYWluIHdpdGggdGhlIHNwZWNpZmllZFxuICAgKiBkYXRlIGlzIHZpc2libGUuIFVubGVzcyB5b3Ugc2V0IHJlc2V0IHRvIHRydWUsIHRoZSB3YW50ZWQgZG9tYWluXG4gICAqIHdpbGwgbm90IG5lY2Vzc2FyaWx5IGJlIHRoZSBmaXJzdCAobGVmdG1vc3QpIGRvbWFpbiBvZiB0aGUgY2FsZW5kYXIuXG4gICAqXG4gICAqIEBwYXJhbSBEYXRlIGRhdGUgSnVtcCB0byB0aGUgZG9tYWluIGNvbnRhaW5pbmcgdGhhdCBkYXRlXG4gICAqIEBwYXJhbSBib29sIHJlc2V0IFdoZXRoZXIgdGhlIHdhbnRlZCBkb21haW4gc2hvdWxkIGJlIHRoZSBmaXJzdCBkb21haW4gb2YgdGhlIGNhbGVuZGFyXG4gICAqIEBwYXJhbSBib29sIFRydWUgb2YgdGhlIGNhbGVuZGFyIHdhcyBzY3JvbGxlZFxuICAgKi9cbiAganVtcFRvOiBmdW5jdGlvbiAoZGF0ZSwgcmVzZXQpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHtcbiAgICAgIHJlc2V0ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGRvbWFpbnMgPSB0aGlzLmdldERvbWFpbktleXMoKTtcbiAgICB2YXIgZmlyc3REb21haW4gPSBkb21haW5zWzBdO1xuICAgIHZhciBsYXN0RG9tYWluID0gZG9tYWluc1tkb21haW5zLmxlbmd0aCAtIDFdO1xuXG4gICAgaWYgKGRhdGUgPCBmaXJzdERvbWFpbikge1xuICAgICAgcmV0dXJuIHRoaXMubG9hZFByZXZpb3VzRG9tYWluKHRoaXMuZ2V0RG9tYWluKGZpcnN0RG9tYWluLCBkYXRlKS5sZW5ndGgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZE5leHREb21haW4odGhpcy5nZXREb21haW4oZmlyc3REb21haW4sIGRhdGUpLmxlbmd0aCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChkYXRlID4gbGFzdERvbWFpbikge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2FkTmV4dERvbWFpbih0aGlzLmdldERvbWFpbihsYXN0RG9tYWluLCBkYXRlKS5sZW5ndGgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICAvKipcbiAgICogTmF2aWdhdGUgYmFjayB0byB0aGUgc3RhcnQgZGF0ZVxuICAgKlxuICAgKiBAc2luY2UgIDMuMy44XG4gICAqIEByZXR1cm4gdm9pZFxuICAgKi9cbiAgcmV3aW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdGhpcy5qdW1wVG8odGhpcy5vcHRpb25zLnN0YXJ0LCB0cnVlKTtcbiAgfSxcblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBjYWxlbmRhciB3aXRoIG5ldyBkYXRhXG4gICAqXG4gICAqIEBwYXJhbSAgb2JqZWN0fHN0cmluZyAgICBkYXRhU291cmNlICAgIFRoZSBjYWxlbmRhcidzIGRhdGFzb3VyY2UsIHNhbWUgdHlwZSBhcyB0aGlzLm9wdGlvbnMuZGF0YVxuICAgKiBAcGFyYW0gIGJvb2xlYW58ZnVuY3Rpb24gICAgYWZ0ZXJMb2FkICAgIFdoZXRoZXIgdG8gZXhlY3V0ZSBhZnRlckxvYWQoKSBvbiB0aGUgZGF0YS4gUGFzcyBkaXJlY3RseSBhIGZ1bmN0aW9uXG4gICAqIGlmIHlvdSBkb24ndCB3YW50IHRvIHVzZSB0aGUgYWZ0ZXJMb2FkKCkgY2FsbGJhY2tcbiAgICovXG4gIHVwZGF0ZTogZnVuY3Rpb24gKGRhdGFTb3VyY2UsIGFmdGVyTG9hZCwgdXBkYXRlTW9kZSkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBkYXRhU291cmNlID0gdGhpcy5vcHRpb25zLmRhdGE7XG4gICAgfVxuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG4gICAgICBhZnRlckxvYWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMykge1xuICAgICAgdXBkYXRlTW9kZSA9IHRoaXMuUkVTRVRfQUxMX09OX1VQREFURTtcbiAgICB9XG5cbiAgICB2YXIgZG9tYWlucyA9IHRoaXMuZ2V0RG9tYWluS2V5cygpO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLmdldERhdGFzKGRhdGFTb3VyY2UsIG5ldyBEYXRlKGRvbWFpbnNbMF0pLCB0aGlzLmdldFN1YkRvbWFpbihkb21haW5zW2RvbWFpbnMubGVuZ3RoIC0gMV0pLnBvcCgpLCBmdW5jdGlvbiAoKSB7XG4gICAgICBzZWxmLmZpbGwoKTtcbiAgICAgIHNlbGYuYWZ0ZXJVcGRhdGUoKTtcbiAgICB9LCBhZnRlckxvYWQsIHVwZGF0ZU1vZGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIGxlZ2VuZFxuICAgKlxuICAgKiBAcGFyYW0gYXJyYXkgbGVnZW5kIGFuIGFycmF5IG9mIGludGVnZXIsIHJlcHJlc2VudGluZyB0aGUgZGlmZmVyZW50IHRocmVzaG9sZCB2YWx1ZVxuICAgKiBAcGFyYW0gYXJyYXkgY29sb3JSYW5nZSBhbiBhcnJheSBvZiAyIGhleCBjb2xvcnMsIGZvciB0aGUgbWluaW11bSBhbmQgbWF4aW11bSBjb2xvcnNcbiAgICovXG4gIHNldExlZ2VuZDogZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBvbGRMZWdlbmQgPSB0aGlzLm9wdGlvbnMubGVnZW5kLnNsaWNlKDApO1xuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMSAmJiBBcnJheS5pc0FycmF5KGFyZ3VtZW50c1swXSkpIHtcbiAgICAgIHRoaXMub3B0aW9ucy5sZWdlbmQgPSBhcmd1bWVudHNbMF07XG4gICAgfVxuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzFdKSAmJiBhcmd1bWVudHNbMV0ubGVuZ3RoID49IDIpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmxlZ2VuZENvbG9ycyA9IFthcmd1bWVudHNbMV1bMF0sIGFyZ3VtZW50c1sxXVsxXV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9wdGlvbnMubGVnZW5kQ29sb3JzID0gYXJndW1lbnRzWzFdO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMCAmJiAhYXJyYXlFcXVhbHMob2xkTGVnZW5kLCB0aGlzLm9wdGlvbnMubGVnZW5kKSB8fCBhcmd1bWVudHMubGVuZ3RoID49IDIpIHtcbiAgICAgIHRoaXMuTGVnZW5kLmJ1aWxkQ29sb3JzKCk7XG4gICAgICB0aGlzLmZpbGwoKTtcbiAgICB9XG5cbiAgICB0aGlzLkxlZ2VuZC5yZWRyYXcodGhpcy5ncmFwaERpbS53aWR0aCAtIHRoaXMub3B0aW9ucy5kb21haW5HdXR0ZXIgLSB0aGlzLm9wdGlvbnMuY2VsbFBhZGRpbmcpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIGxlZ2VuZFxuICAgKlxuICAgKiBAcmV0dXJuIGJvb2wgRmFsc2UgaWYgdGhlcmUgaXMgbm8gbGVnZW5kIHRvIHJlbW92ZVxuICAgKi9cbiAgcmVtb3ZlTGVnZW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuZGlzcGxheUxlZ2VuZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRoaXMub3B0aW9ucy5kaXNwbGF5TGVnZW5kID0gZmFsc2U7XG4gICAgdGhpcy5MZWdlbmQucmVtb3ZlKCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERpc3BsYXkgdGhlIGxlZ2VuZFxuICAgKlxuICAgKiBAcmV0dXJuIGJvb2wgRmFsc2UgaWYgdGhlIGxlZ2VuZCB3YXMgYWxyZWFkeSBkaXNwbGF5ZWRcbiAgICovXG4gIHNob3dMZWdlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLmRpc3BsYXlMZWdlbmQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLm9wdGlvbnMuZGlzcGxheUxlZ2VuZCA9IHRydWU7XG4gICAgdGhpcy5MZWdlbmQucmVkcmF3KHRoaXMuZ3JhcGhEaW0ud2lkdGggLSB0aGlzLm9wdGlvbnMuZG9tYWluR3V0dGVyIC0gdGhpcy5vcHRpb25zLmNlbGxQYWRkaW5nKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcblxuICAvKipcbiAgICogSGlnaGxpZ2h0IGRhdGVzXG4gICAqXG4gICAqIEFkZCBhIGhpZ2hsaWdodCBjbGFzcyB0byBhIHNldCBvZiBkYXRlc1xuICAgKlxuICAgKiBAc2luY2UgIDMuMy41XG4gICAqIEBwYXJhbSAgYXJyYXkgQXJyYXkgb2YgZGF0ZXMgdG8gaGlnaGxpZ2h0XG4gICAqIEByZXR1cm4gYm9vbCBUcnVlIGlmIGRhdGVzIHdlcmUgaGlnaGxpZ2h0ZWRcbiAgICovXG4gIGhpZ2hsaWdodDogZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAoKHRoaXMub3B0aW9ucy5oaWdobGlnaHQgPSB0aGlzLmV4cGFuZERhdGVTZXR0aW5nKGFyZ3MpKS5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmZpbGwoKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICAvKipcbiAgICogRGVzdHJveSB0aGUgY2FsZW5kYXJcbiAgICpcbiAgICogVXNhZ2U6IGNhbCA9IGNhbC5kZXN0cm95KCk7XG4gICAqXG4gICAqIEBzaW5jZSAgMy4zLjZcbiAgICogQHBhcmFtIGZ1bmN0aW9uIEEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gdHJpZ2dlciBhZnRlciBkZXN0cm95aW5nIHRoZSBjYWxlbmRhclxuICAgKiBAcmV0dXJuIG51bGxcbiAgICovXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHRoaXMucm9vdC50cmFuc2l0aW9uKCkuZHVyYXRpb24odGhpcy5vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uKS5hdHRyKCd3aWR0aCcsIDApLmF0dHIoJ2hlaWdodCcsIDApLnJlbW92ZSgpLmVhY2goJ2VuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBjb25zb2xlLmxvZygnUHJvdmlkZWQgY2FsbGJhY2sgZm9yIGRlc3Ryb3koKSBpcyBub3QgYSBmdW5jdGlvbi4nKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSxcbiAgZ2V0U1ZHOiBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHN0eWxlcyA9IHtcbiAgICAgICcuY2FsLWhlYXRtYXAtY29udGFpbmVyJzoge30sXG4gICAgICAnLmdyYXBoJzoge30sXG4gICAgICAnLmdyYXBoLXJlY3QnOiB7fSxcbiAgICAgICdyZWN0LmhpZ2hsaWdodCc6IHt9LFxuICAgICAgJ3JlY3Qubm93Jzoge30sXG4gICAgICAncmVjdC5oaWdobGlnaHQtbm93Jzoge30sXG4gICAgICAndGV4dC5oaWdobGlnaHQnOiB7fSxcbiAgICAgICd0ZXh0Lm5vdyc6IHt9LFxuICAgICAgJ3RleHQuaGlnaGxpZ2h0LW5vdyc6IHt9LFxuICAgICAgJy5kb21haW4tYmFja2dyb3VuZCc6IHt9LFxuICAgICAgJy5ncmFwaC1sYWJlbCc6IHt9LFxuICAgICAgJy5zdWJkb21haW4tdGV4dCc6IHt9LFxuICAgICAgJy5xMCc6IHt9LFxuICAgICAgJy5xaSc6IHt9XG4gICAgfTtcblxuICAgIGZvciAodmFyIGogPSAxLCB0b3RhbCA9IHRoaXMub3B0aW9ucy5sZWdlbmQubGVuZ3RoICsgMTsgaiA8PSB0b3RhbDsgaiArPSAxKSB7XG4gICAgICBzdHlsZXNbJy5xJyArIGpdID0ge307XG4gICAgfVxuXG4gICAgdmFyIHJvb3QgPSB0aGlzLnJvb3Q7XG4gICAgdmFyIHdoaXRlbGlzdFN0eWxlcyA9IFsvLyBTVkcgc3BlY2lmaWMgcHJvcGVydGllc1xuICAgICdzdHJva2UnLCAnc3Ryb2tlLXdpZHRoJywgJ3N0cm9rZS1vcGFjaXR5JywgJ3N0cm9rZS1kYXNoYXJyYXknLCAnc3Ryb2tlLWRhc2hvZmZzZXQnLCAnc3Ryb2tlLWxpbmVjYXAnLCAnc3Ryb2tlLW1pdGVybGltaXQnLCAnZmlsbCcsICdmaWxsLW9wYWNpdHknLCAnZmlsbC1ydWxlJywgJ21hcmtlcicsICdtYXJrZXItc3RhcnQnLCAnbWFya2VyLW1pZCcsICdtYXJrZXItZW5kJywgJ2FsaWduZW1lbnQtYmFzZWxpbmUnLCAnYmFzZWxpbmUtc2hpZnQnLCAnZG9taW5hbnQtYmFzZWxpbmUnLCAnZ2x5cGgtb3JpZW50YXRpb24taG9yaXpvbnRhbCcsICdnbHlwaC1vcmllbnRhdGlvbi12ZXJ0aWNhbCcsICdrZXJuaW5nJywgJ3RleHQtYW5jaG9yJywgJ3NoYXBlLXJlbmRlcmluZycsIC8vIFRleHQgU3BlY2lmaWMgcHJvcGVydGllc1xuICAgICd0ZXh0LXRyYW5zZm9ybScsICdmb250LWZhbWlseScsICdmb250JywgJ2ZvbnQtc2l6ZScsICdmb250LXdlaWdodCddO1xuXG4gICAgdmFyIGZpbHRlclN0eWxlcyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGUsIHByb3BlcnR5LCB2YWx1ZSkge1xuICAgICAgaWYgKHdoaXRlbGlzdFN0eWxlcy5pbmRleE9mKHByb3BlcnR5KSAhPT0gLTEpIHtcbiAgICAgICAgc3R5bGVzW2F0dHJpYnV0ZV1bcHJvcGVydHldID0gdmFsdWU7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHZhciBnZXRFbGVtZW50ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHJldHVybiByb290LnNlbGVjdChlKVswXVswXTtcbiAgICB9O1xuICAgIC8qIGpzaGludCBmb3JpbjpmYWxzZSAqL1xuXG5cbiAgICBmb3IgKHZhciBlbGVtZW50IGluIHN0eWxlcykge1xuICAgICAgaWYgKCFzdHlsZXMuaGFzT3duUHJvcGVydHkoZWxlbWVudCkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBkb20gPSBnZXRFbGVtZW50KGVsZW1lbnQpO1xuXG4gICAgICBpZiAoZG9tID09PSBudWxsKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfSAvLyBUaGUgRE9NIExldmVsIDIgQ1NTIHdheVxuXG4gICAgICAvKiBqc2hpbnQgbWF4ZGVwdGg6IGZhbHNlICovXG5cblxuICAgICAgaWYgKCdnZXRDb21wdXRlZFN0eWxlJyBpbiB3aW5kb3cpIHtcbiAgICAgICAgdmFyIGNzID0gZ2V0Q29tcHV0ZWRTdHlsZShkb20sIG51bGwpO1xuXG4gICAgICAgIGlmIChjcy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBmaWx0ZXJTdHlsZXMoZWxlbWVudCwgY3MuaXRlbShpKSwgY3MuZ2V0UHJvcGVydHlWYWx1ZShjcy5pdGVtKGkpKSk7XG4gICAgICAgICAgfSAvLyBPcGVyYSB3b3JrYXJvdW5kLiBPcGVyYSBkb2VzblwidCBzdXBwb3J0IGBpdGVtYC9gbGVuZ3RoYFxuICAgICAgICAgIC8vIG9uIENTU1N0eWxlRGVjbGFyYXRpb24uXG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKHZhciBrIGluIGNzKSB7XG4gICAgICAgICAgICBpZiAoY3MuaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgICAgICAgICAgZmlsdGVyU3R5bGVzKGVsZW1lbnQsIGssIGNzW2tdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gLy8gVGhlIElFIHdheVxuXG4gICAgICB9IGVsc2UgaWYgKCdjdXJyZW50U3R5bGUnIGluIGRvbSkge1xuICAgICAgICB2YXIgY3NzID0gZG9tLmN1cnJlbnRTdHlsZTtcblxuICAgICAgICBmb3IgKHZhciBwIGluIGNzcykge1xuICAgICAgICAgIGZpbHRlclN0eWxlcyhlbGVtZW50LCBwLCBjc3NbcF0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHN0cmluZyA9ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiAnICsgJ3htbG5zOnhsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiPjxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj48IVtDREFUQVsgJztcblxuICAgIGZvciAodmFyIHN0eWxlIGluIHN0eWxlcykge1xuICAgICAgc3RyaW5nICs9IHN0eWxlICsgJyB7XFxuJztcblxuICAgICAgZm9yICh2YXIgbCBpbiBzdHlsZXNbc3R5bGVdKSB7XG4gICAgICAgIHN0cmluZyArPSAnXFx0JyArIGwgKyAnOicgKyBzdHlsZXNbc3R5bGVdW2xdICsgJztcXG4nO1xuICAgICAgfVxuXG4gICAgICBzdHJpbmcgKz0gJ31cXG4nO1xuICAgIH1cblxuICAgIHN0cmluZyArPSAnXV0+PC9zdHlsZT4nO1xuICAgIHN0cmluZyArPSBuZXcgWE1MU2VyaWFsaXplcigpLnNlcmlhbGl6ZVRvU3RyaW5nKHRoaXMucm9vdFswXVswXSk7XG4gICAgc3RyaW5nICs9ICc8L3N2Zz4nO1xuICAgIHJldHVybiBzdHJpbmc7XG4gIH1cbn07IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuLy8gRE9NQUlOIFBPU0lUSU9OIENPTVBVVEFUSU9OICAgICAgICAgICAgICAgICAgICAgICAgLy9cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuXG4vKipcbiAqIENvbXB1dGUgdGhlIHBvc2l0aW9uIG9mIGEgZG9tYWluLCByZWxhdGl2ZSB0byB0aGUgY2FsZW5kYXJcbiAqL1xuXG52YXIgRG9tYWluUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB0aGlzLnBvc2l0aW9ucyA9IGQzLm1hcCgpO1xufTtcblxuRG9tYWluUG9zaXRpb24ucHJvdG90eXBlLmdldFBvc2l0aW9uID0gZnVuY3Rpb24gKGQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHJldHVybiB0aGlzLnBvc2l0aW9ucy5nZXQoZCk7XG59O1xuXG5Eb21haW5Qb3NpdGlvbi5wcm90b3R5cGUuZ2V0UG9zaXRpb25Gcm9tSW5kZXggPSBmdW5jdGlvbiAoaSkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIGRvbWFpbnMgPSB0aGlzLmdldEtleXMoKTtcbiAgcmV0dXJuIHRoaXMucG9zaXRpb25zLmdldChkb21haW5zW2ldKTtcbn07XG5cbkRvbWFpblBvc2l0aW9uLnByb3RvdHlwZS5nZXRMYXN0ID0gZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIGRvbWFpbnMgPSB0aGlzLmdldEtleXMoKTtcbiAgcmV0dXJuIHRoaXMucG9zaXRpb25zLmdldChkb21haW5zW2RvbWFpbnMubGVuZ3RoIC0gMV0pO1xufTtcblxuRG9tYWluUG9zaXRpb24ucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKGQsIGRpbSkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdGhpcy5wb3NpdGlvbnMuc2V0KGQsIGRpbSk7XG59O1xuXG5Eb21haW5Qb3NpdGlvbi5wcm90b3R5cGUuc2hpZnRSaWdodEJ5ID0gZnVuY3Rpb24gKGV4aXRpbmdEb21haW5EaW0pIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHRoaXMucG9zaXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICB0aGlzLnNldChrZXksIHZhbHVlIC0gZXhpdGluZ0RvbWFpbkRpbSk7XG4gIH0pO1xuICB2YXIgZG9tYWlucyA9IHRoaXMuZ2V0S2V5cygpO1xuICB0aGlzLnBvc2l0aW9ucy5yZW1vdmUoZG9tYWluc1swXSk7XG59O1xuXG5Eb21haW5Qb3NpdGlvbi5wcm90b3R5cGUuc2hpZnRMZWZ0QnkgPSBmdW5jdGlvbiAoZW50ZXJpbmdEb21haW5EaW0pIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHRoaXMucG9zaXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICB0aGlzLnNldChrZXksIHZhbHVlICsgZW50ZXJpbmdEb21haW5EaW0pO1xuICB9KTtcbiAgdmFyIGRvbWFpbnMgPSB0aGlzLmdldEtleXMoKTtcbiAgdGhpcy5wb3NpdGlvbnMucmVtb3ZlKGRvbWFpbnNbZG9tYWlucy5sZW5ndGggLSAxXSk7XG59O1xuXG5Eb21haW5Qb3NpdGlvbi5wcm90b3R5cGUuZ2V0S2V5cyA9IGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHJldHVybiB0aGlzLnBvc2l0aW9ucy5rZXlzKCkuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBwYXJzZUludChhLCAxMCkgLSBwYXJzZUludChiLCAxMCk7XG4gIH0pO1xufTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vXG4vLyBMRUdFTkQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vL1xuXG5cbnZhciBMZWdlbmQgPSBmdW5jdGlvbiAoY2FsZW5kYXIpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHRoaXMuY2FsZW5kYXIgPSBjYWxlbmRhcjtcbiAgdGhpcy5jb21wdXRlRGltKCk7XG5cbiAgaWYgKGNhbGVuZGFyLm9wdGlvbnMubGVnZW5kQ29sb3JzICE9PSBudWxsKSB7XG4gICAgdGhpcy5idWlsZENvbG9ycygpO1xuICB9XG59O1xuXG5MZWdlbmQucHJvdG90eXBlLmNvbXB1dGVEaW0gPSBmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgb3B0aW9ucyA9IHRoaXMuY2FsZW5kYXIub3B0aW9uczsgLy8gU2hvcnRlciBhY2Nlc3NvciBmb3IgdmFyaWFibGUgbmFtZSBtYW5nbGluZyB3aGVuIG1pbmlmeWluZ1xuXG4gIHRoaXMuZGltID0ge1xuICAgIHdpZHRoOiBvcHRpb25zLmxlZ2VuZENlbGxTaXplICogKG9wdGlvbnMubGVnZW5kLmxlbmd0aCArIDEpICsgb3B0aW9ucy5sZWdlbmRDZWxsUGFkZGluZyAqIG9wdGlvbnMubGVnZW5kLmxlbmd0aCxcbiAgICBoZWlnaHQ6IG9wdGlvbnMubGVnZW5kQ2VsbFNpemVcbiAgfTtcbn07XG5cbkxlZ2VuZC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdGhpcy5jYWxlbmRhci5yb290LnNlbGVjdCgnLmdyYXBoLWxlZ2VuZCcpLnJlbW92ZSgpO1xuICB0aGlzLmNhbGVuZGFyLnJlc2l6ZSgpO1xufTtcblxuTGVnZW5kLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbiAod2lkdGgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGlmICghdGhpcy5jYWxlbmRhci5vcHRpb25zLmRpc3BsYXlMZWdlbmQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB2YXIgcGFyZW50ID0gdGhpcztcbiAgdmFyIGNhbGVuZGFyID0gdGhpcy5jYWxlbmRhcjtcbiAgdmFyIGxlZ2VuZCA9IGNhbGVuZGFyLnJvb3Q7XG4gIHZhciBsZWdlbmRJdGVtO1xuICB2YXIgb3B0aW9ucyA9IGNhbGVuZGFyLm9wdGlvbnM7IC8vIFNob3J0ZXIgYWNjZXNzb3IgZm9yIHZhcmlhYmxlIG5hbWUgbWFuZ2xpbmcgd2hlbiBtaW5pZnlpbmdcblxuICB0aGlzLmNvbXB1dGVEaW0oKTtcblxuICB2YXIgX2xlZ2VuZCA9IG9wdGlvbnMubGVnZW5kLnNsaWNlKDApO1xuXG4gIF9sZWdlbmQucHVzaChfbGVnZW5kW19sZWdlbmQubGVuZ3RoIC0gMV0gKyAxKTtcblxuICB2YXIgbGVnZW5kRWxlbWVudCA9IGNhbGVuZGFyLnJvb3Quc2VsZWN0KCcuZ3JhcGgtbGVnZW5kJyk7XG5cbiAgaWYgKGxlZ2VuZEVsZW1lbnRbMF1bMF0gIT09IG51bGwpIHtcbiAgICBsZWdlbmQgPSBsZWdlbmRFbGVtZW50O1xuICAgIGxlZ2VuZEl0ZW0gPSBsZWdlbmQuc2VsZWN0KCdnJykuc2VsZWN0QWxsKCdyZWN0JykuZGF0YShfbGVnZW5kKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBDcmVhdGluZyB0aGUgbmV3IGxlZ2VuZCBET00gaWYgaXQgZG9lc24ndCBhbHJlYWR5IGV4aXN0XG4gICAgbGVnZW5kID0gb3B0aW9ucy5sZWdlbmRWZXJ0aWNhbFBvc2l0aW9uID09PSAndG9wJyA/IGxlZ2VuZC5pbnNlcnQoJ3N2ZycsICcuZ3JhcGgnKSA6IGxlZ2VuZC5hcHBlbmQoJ3N2ZycpO1xuICAgIGxlZ2VuZC5hdHRyKCd4JywgZ2V0TGVnZW5kWFBvc2l0aW9uKCkpLmF0dHIoJ3knLCBnZXRMZWdlbmRZUG9zaXRpb24oKSk7XG4gICAgbGVnZW5kSXRlbSA9IGxlZ2VuZC5hdHRyKCdjbGFzcycsICdncmFwaC1sZWdlbmQnKS5hdHRyKCdoZWlnaHQnLCBwYXJlbnQuZ2V0RGltKCdoZWlnaHQnKSkuYXR0cignd2lkdGgnLCBwYXJlbnQuZ2V0RGltKCd3aWR0aCcpKS5hcHBlbmQoJ2cnKS5zZWxlY3RBbGwoKS5kYXRhKF9sZWdlbmQpO1xuICB9XG5cbiAgbGVnZW5kSXRlbS5lbnRlcigpLmFwcGVuZCgncmVjdCcpLmNhbGwobGVnZW5kQ2VsbExheW91dCkuYXR0cignY2xhc3MnLCBmdW5jdGlvbiAoZCkge1xuICAgIHJldHVybiBjYWxlbmRhci5MZWdlbmQuZ2V0Q2xhc3MoZCwgY2FsZW5kYXIubGVnZW5kU2NhbGUgPT09IG51bGwpO1xuICB9KS5hdHRyKCdmaWxsLW9wYWNpdHknLCAwKS5jYWxsKGZ1bmN0aW9uIChzZWxlY3Rpb24pIHtcbiAgICBpZiAoY2FsZW5kYXIubGVnZW5kU2NhbGUgIT09IG51bGwgJiYgb3B0aW9ucy5sZWdlbmRDb2xvcnMgIT09IG51bGwgJiYgb3B0aW9ucy5sZWdlbmRDb2xvcnMuaGFzT3duUHJvcGVydHkoJ2Jhc2UnKSkge1xuICAgICAgc2VsZWN0aW9uLmF0dHIoJ2ZpbGwnLCBvcHRpb25zLmxlZ2VuZENvbG9ycy5iYXNlKTtcbiAgICB9XG4gIH0pLmFwcGVuZCgndGl0bGUnKTtcbiAgbGVnZW5kSXRlbS5leGl0KCkudHJhbnNpdGlvbigpLmR1cmF0aW9uKG9wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb24pLmF0dHIoJ2ZpbGwtb3BhY2l0eScsIDApLnJlbW92ZSgpO1xuICBsZWdlbmRJdGVtLnRyYW5zaXRpb24oKS5kZWxheShmdW5jdGlvbiAoZCwgaSkge1xuICAgIHJldHVybiBvcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uICogaSAvIDEwO1xuICB9KS5jYWxsKGxlZ2VuZENlbGxMYXlvdXQpLmF0dHIoJ2ZpbGwtb3BhY2l0eScsIDEpLmNhbGwoZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmF0dHIoJ2ZpbGwnLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgaWYgKGNhbGVuZGFyLmxlZ2VuZFNjYWxlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cblxuICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGNhbGVuZGFyLmxlZ2VuZFNjYWxlKGQgLSAxKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNhbGVuZGFyLmxlZ2VuZFNjYWxlKG9wdGlvbnMubGVnZW5kW2kgLSAxXSk7XG4gICAgfSk7XG4gICAgZWxlbWVudC5hdHRyKCdjbGFzcycsIGZ1bmN0aW9uIChkKSB7XG4gICAgICByZXR1cm4gY2FsZW5kYXIuTGVnZW5kLmdldENsYXNzKGQsIGNhbGVuZGFyLmxlZ2VuZFNjYWxlID09PSBudWxsKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gbGVnZW5kQ2VsbExheW91dChzZWxlY3Rpb24pIHtcbiAgICBzZWxlY3Rpb24uYXR0cignd2lkdGgnLCBvcHRpb25zLmxlZ2VuZENlbGxTaXplKS5hdHRyKCdoZWlnaHQnLCBvcHRpb25zLmxlZ2VuZENlbGxTaXplKS5hdHRyKCdyeCcsIG9wdGlvbnMubGVnZW5kQ2VsbFJhZGl1cykuYXR0cigncnknLCBvcHRpb25zLmxlZ2VuZENlbGxSYWRpdXMpLmF0dHIoJ3gnLCBmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgcmV0dXJuIGkgKiAob3B0aW9ucy5sZWdlbmRDZWxsU2l6ZSArIG9wdGlvbnMubGVnZW5kQ2VsbFBhZGRpbmcpO1xuICAgIH0pO1xuICB9XG5cbiAgbGVnZW5kSXRlbS5zZWxlY3QoJ3RpdGxlJykudGV4dChmdW5jdGlvbiAoZCwgaSkge1xuICAgIGlmIChpID09PSAwKSB7XG4gICAgICByZXR1cm4gY2FsZW5kYXIuZm9ybWF0U3RyaW5nV2l0aE9iamVjdChvcHRpb25zLmxlZ2VuZFRpdGxlRm9ybWF0Lmxvd2VyLCB7XG4gICAgICAgIG1pbjogb3B0aW9ucy5sZWdlbmRbaV0sXG4gICAgICAgIG5hbWU6IG9wdGlvbnMuaXRlbU5hbWVbMV1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoaSA9PT0gX2xlZ2VuZC5sZW5ndGggLSAxKSB7XG4gICAgICByZXR1cm4gY2FsZW5kYXIuZm9ybWF0U3RyaW5nV2l0aE9iamVjdChvcHRpb25zLmxlZ2VuZFRpdGxlRm9ybWF0LnVwcGVyLCB7XG4gICAgICAgIG1heDogb3B0aW9ucy5sZWdlbmRbaSAtIDFdLFxuICAgICAgICBuYW1lOiBvcHRpb25zLml0ZW1OYW1lWzFdXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGNhbGVuZGFyLmZvcm1hdFN0cmluZ1dpdGhPYmplY3Qob3B0aW9ucy5sZWdlbmRUaXRsZUZvcm1hdC5pbm5lciwge1xuICAgICAgICBkb3duOiBvcHRpb25zLmxlZ2VuZFtpIC0gMV0sXG4gICAgICAgIHVwOiBvcHRpb25zLmxlZ2VuZFtpXSxcbiAgICAgICAgbmFtZTogb3B0aW9ucy5pdGVtTmFtZVsxXVxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbiAgbGVnZW5kSXRlbS5vbignbW91c2VvdmVyJywgZnVuY3Rpb24gKGQpIHtcbiAgICBjYWxlbmRhci5sZWdlbmRUaXAuc2hvdyhkLCB0aGlzKTtcbiAgfSkub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKCkge1xuICAgIGNhbGVuZGFyLmxlZ2VuZFRpcC5oaWRlKCk7XG4gIH0pO1xuICBsZWdlbmQudHJhbnNpdGlvbigpLmR1cmF0aW9uKG9wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb24pLmF0dHIoJ3gnLCBnZXRMZWdlbmRYUG9zaXRpb24oKSkuYXR0cigneScsIGdldExlZ2VuZFlQb3NpdGlvbigpKS5hdHRyKCd3aWR0aCcsIHBhcmVudC5nZXREaW0oJ3dpZHRoJykpLmF0dHIoJ2hlaWdodCcsIHBhcmVudC5nZXREaW0oJ2hlaWdodCcpKTtcbiAgbGVnZW5kLnNlbGVjdCgnZycpLnRyYW5zaXRpb24oKS5kdXJhdGlvbihvcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uKS5hdHRyKCd0cmFuc2Zvcm0nLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKG9wdGlvbnMubGVnZW5kT3JpZW50YXRpb24gPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgIHJldHVybiAncm90YXRlKDkwICcgKyBvcHRpb25zLmxlZ2VuZENlbGxTaXplIC8gMiArICcgJyArIG9wdGlvbnMubGVnZW5kQ2VsbFNpemUgLyAyICsgJyknO1xuICAgIH1cblxuICAgIHJldHVybiAnJztcbiAgfSk7XG5cbiAgZnVuY3Rpb24gZ2V0TGVnZW5kWFBvc2l0aW9uKCkge1xuICAgIHN3aXRjaCAob3B0aW9ucy5sZWdlbmRIb3Jpem9udGFsUG9zaXRpb24pIHtcbiAgICAgIGNhc2UgJ3JpZ2h0JzpcbiAgICAgICAgaWYgKG9wdGlvbnMubGVnZW5kVmVydGljYWxQb3NpdGlvbiA9PT0gJ2NlbnRlcicgfHwgb3B0aW9ucy5sZWdlbmRWZXJ0aWNhbFBvc2l0aW9uID09PSAnbWlkZGxlJykge1xuICAgICAgICAgIHJldHVybiB3aWR0aCArIG9wdGlvbnMubGVnZW5kTWFyZ2luWzNdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHdpZHRoIC0gcGFyZW50LmdldERpbSgnd2lkdGgnKSAtIG9wdGlvbnMubGVnZW5kTWFyZ2luWzFdO1xuXG4gICAgICBjYXNlICdtaWRkbGUnOlxuICAgICAgY2FzZSAnY2VudGVyJzpcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQod2lkdGggLyAyIC0gcGFyZW50LmdldERpbSgnd2lkdGgnKSAvIDIpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gb3B0aW9ucy5sZWdlbmRNYXJnaW5bM107XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0TGVnZW5kWVBvc2l0aW9uKCkge1xuICAgIGlmIChvcHRpb25zLmxlZ2VuZFZlcnRpY2FsUG9zaXRpb24gPT09ICdib3R0b20nKSB7XG4gICAgICByZXR1cm4gY2FsZW5kYXIuZ3JhcGhEaW0uaGVpZ2h0ICsgb3B0aW9ucy5sZWdlbmRNYXJnaW5bMF0gLSBvcHRpb25zLmRvbWFpbkd1dHRlciAtIG9wdGlvbnMuY2VsbFBhZGRpbmc7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9wdGlvbnMubGVnZW5kTWFyZ2luWzBdO1xuICB9XG5cbiAgY2FsZW5kYXIucmVzaXplKCk7XG59O1xuLyoqXG4gKiBSZXR1cm4gdGhlIGRpbWVuc2lvbiBvZiB0aGUgbGVnZW5kXG4gKlxuICogVGFrZXMgaW50byBhY2NvdW50IHJvdGF0aW9uXG4gKlxuICogQHBhcmFtICBzdHJpbmcgYXhpcyBXaWR0aCBvciBoZWlnaHRcbiAqIEByZXR1cm4gaW50IGhlaWdodCBvciB3aWR0aCBpbiBwaXhlbHNcbiAqL1xuXG5cbkxlZ2VuZC5wcm90b3R5cGUuZ2V0RGltID0gZnVuY3Rpb24gKGF4aXMpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBpc0hvcml6b250YWwgPSB0aGlzLmNhbGVuZGFyLm9wdGlvbnMubGVnZW5kT3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJztcblxuICBzd2l0Y2ggKGF4aXMpIHtcbiAgICBjYXNlICd3aWR0aCc6XG4gICAgICByZXR1cm4gdGhpcy5kaW1baXNIb3Jpem9udGFsID8gJ3dpZHRoJyA6ICdoZWlnaHQnXTtcblxuICAgIGNhc2UgJ2hlaWdodCc6XG4gICAgICByZXR1cm4gdGhpcy5kaW1baXNIb3Jpem9udGFsID8gJ2hlaWdodCcgOiAnd2lkdGgnXTtcbiAgfVxufTtcblxuTGVnZW5kLnByb3RvdHlwZS5idWlsZENvbG9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBvcHRpb25zID0gdGhpcy5jYWxlbmRhci5vcHRpb25zOyAvLyBTaG9ydGVyIGFjY2Vzc29yIGZvciB2YXJpYWJsZSBuYW1lIG1hbmdsaW5nIHdoZW4gbWluaWZ5aW5nXG5cbiAgaWYgKG9wdGlvbnMubGVnZW5kQ29sb3JzID09PSBudWxsKSB7XG4gICAgdGhpcy5jYWxlbmRhci5sZWdlbmRTY2FsZSA9IG51bGw7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdmFyIF9jb2xvclJhbmdlID0gW107XG5cbiAgaWYgKEFycmF5LmlzQXJyYXkob3B0aW9ucy5sZWdlbmRDb2xvcnMpKSB7XG4gICAgX2NvbG9yUmFuZ2UgPSBvcHRpb25zLmxlZ2VuZENvbG9ycztcbiAgfSBlbHNlIGlmIChvcHRpb25zLmxlZ2VuZENvbG9ycy5oYXNPd25Qcm9wZXJ0eSgnbWluJykgJiYgb3B0aW9ucy5sZWdlbmRDb2xvcnMuaGFzT3duUHJvcGVydHkoJ21heCcpKSB7XG4gICAgX2NvbG9yUmFuZ2UgPSBbb3B0aW9ucy5sZWdlbmRDb2xvcnMubWluLCBvcHRpb25zLmxlZ2VuZENvbG9ycy5tYXhdO1xuICB9IGVsc2Uge1xuICAgIG9wdGlvbnMubGVnZW5kQ29sb3JzID0gbnVsbDtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB2YXIgX2xlZ2VuZCA9IG9wdGlvbnMubGVnZW5kLnNsaWNlKDApO1xuXG4gIGlmIChfbGVnZW5kWzBdID4gMCkge1xuICAgIF9sZWdlbmQudW5zaGlmdCgwKTtcbiAgfSBlbHNlIGlmIChfbGVnZW5kWzBdIDw9IDApIHtcbiAgICAvLyBMZXQncyBndWVzcyB0aGUgbGVmdG1vc3QgdmFsdWUsIGl0IHdlIGhhdmUgdG8gYWRkIG9uZVxuICAgIF9sZWdlbmQudW5zaGlmdChfbGVnZW5kWzBdIC0gKF9sZWdlbmRbX2xlZ2VuZC5sZW5ndGggLSAxXSAtIF9sZWdlbmRbMF0pIC8gX2xlZ2VuZC5sZW5ndGgpO1xuICB9XG5cbiAgdmFyIGNvbG9yU2NhbGU7XG5cbiAgaWYgKG9wdGlvbnMubGVnZW5kQ29sb3JzLmhhc093blByb3BlcnR5KCdjb2xvclNjYWxlJykpIHtcbiAgICBjb2xvclNjYWxlID0gb3B0aW9ucy5sZWdlbmRDb2xvcnMuY29sb3JTY2FsZTtcbiAgfSBlbHNlIHtcbiAgICBjb2xvclNjYWxlID0gZDMuc2NhbGUubGluZWFyKCkucmFuZ2UoX2NvbG9yUmFuZ2UpLmludGVycG9sYXRlKGQzLmludGVycG9sYXRlSGNsKS5kb21haW4oW2QzLm1pbihfbGVnZW5kKSwgZDMubWF4KF9sZWdlbmQpXSk7XG4gIH1cblxuICB2YXIgbGVnZW5kQ29sb3JzID0gX2xlZ2VuZC5tYXAoZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gY29sb3JTY2FsZShlbGVtZW50KTtcbiAgfSk7XG5cbiAgdGhpcy5jYWxlbmRhci5sZWdlbmRTY2FsZSA9IGQzLnNjYWxlLnRocmVzaG9sZCgpLmRvbWFpbihvcHRpb25zLmxlZ2VuZCkucmFuZ2UobGVnZW5kQ29sb3JzKTtcbiAgcmV0dXJuIHRydWU7XG59O1xuLyoqXG4gKiBSZXR1cm4gdGhlIGNsYXNzbmFtZSBvbiB0aGUgbGVnZW5kIGZvciB0aGUgc3BlY2lmaWVkIHZhbHVlXG4gKlxuICogQHBhcmFtIGludGVnZXIgbiBWYWx1ZSBhc3NvY2lhdGVkIHRvIGEgZGF0ZVxuICogQHBhcmFtIGJvb2wgd2l0aENzc0NsYXNzIFdoZXRoZXIgdG8gZGlzcGxheSB0aGUgY3NzIGNsYXNzIHVzZWQgdG8gc3R5bGUgdGhlIGNlbGwuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgRGlzYWJsaW5nIHdpbGwgYWxsb3cgc3R5bGluZyBkaXJlY3RseSB2aWEgaHRtbCBmaWxsIGF0dHJpYnV0ZVxuICpcbiAqIEByZXR1cm4gc3RyaW5nIENsYXNzbmFtZSBhY2NvcmRpbmcgdG8gdGhlIGxlZ2VuZFxuICovXG5cblxuTGVnZW5kLnByb3RvdHlwZS5nZXRDbGFzcyA9IGZ1bmN0aW9uIChuLCB3aXRoQ3NzQ2xhc3MpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGlmIChuID09PSBudWxsIHx8IGlzTmFOKG4pKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgdmFyIGluZGV4ID0gW3RoaXMuY2FsZW5kYXIub3B0aW9ucy5sZWdlbmQubGVuZ3RoICsgMV07XG5cbiAgZm9yICh2YXIgaSA9IDAsIHRvdGFsID0gdGhpcy5jYWxlbmRhci5vcHRpb25zLmxlZ2VuZC5sZW5ndGggLSAxOyBpIDw9IHRvdGFsOyBpICs9IDEpIHtcbiAgICBpZiAodGhpcy5jYWxlbmRhci5vcHRpb25zLmxlZ2VuZFswXSA+IDAgJiYgbiA8IDApIHtcbiAgICAgIGluZGV4ID0gWycxJywgJ2knXTtcbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGlmIChuIDw9IHRoaXMuY2FsZW5kYXIub3B0aW9ucy5sZWdlbmRbaV0pIHtcbiAgICAgIGluZGV4ID0gW2kgKyAxXTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGlmIChuID09PSAwKSB7XG4gICAgaW5kZXgucHVzaCgwKTtcbiAgfVxuXG4gIGluZGV4LnVuc2hpZnQoJycpO1xuICByZXR1cm4gKGluZGV4LmpvaW4oJyByJykgKyAod2l0aENzc0NsYXNzID8gaW5kZXguam9pbignIHEnKSA6ICcnKSkudHJpbSgpO1xufTtcbi8qKlxuICogI3NvdXJjZSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zODMyNDUvODA1NjQ5XG4gKi9cblxuXG5mdW5jdGlvbiBtZXJnZVJlY3Vyc2l2ZShvYmoxLCBvYmoyKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgLypqc2hpbnQgZm9yaW46ZmFsc2UgKi9cblxuICBmb3IgKHZhciBwIGluIG9iajIpIHtcbiAgICB0cnkge1xuICAgICAgLy8gUHJvcGVydHkgaW4gZGVzdGluYXRpb24gb2JqZWN0IHNldDsgdXBkYXRlIGl0cyB2YWx1ZS5cbiAgICAgIGlmIChvYmoyW3BdLmNvbnN0cnVjdG9yID09PSBPYmplY3QpIHtcbiAgICAgICAgb2JqMVtwXSA9IG1lcmdlUmVjdXJzaXZlKG9iajFbcF0sIG9iajJbcF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2JqMVtwXSA9IG9iajJbcF07XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gUHJvcGVydHkgaW4gZGVzdGluYXRpb24gb2JqZWN0IG5vdCBzZXQ7IGNyZWF0ZSBpdCBhbmQgc2V0IGl0cyB2YWx1ZS5cbiAgICAgIG9iajFbcF0gPSBvYmoyW3BdO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmoxO1xufVxuLyoqXG4gKiBDaGVjayBpZiAyIGFycmF5cyBhcmUgZXF1YWxzXG4gKlxuICogQGxpbmsgaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTQ4NTM5NzQvODA1NjQ5XG4gKiBAcGFyYW0gIGFycmF5IGFycmF5IHRoZSBhcnJheSB0byBjb21wYXJlIHRvXG4gKiBAcmV0dXJuIGJvb2wgdHJ1ZSBvZiB0aGUgMiBhcnJheXMgYXJlIGVxdWFsc1xuICovXG5cblxuZnVuY3Rpb24gYXJyYXlFcXVhbHMoYXJyYXlBLCBhcnJheUIpIHtcbiAgJ3VzZSBzdHJpY3QnOyAvLyBpZiB0aGUgb3RoZXIgYXJyYXkgaXMgYSBmYWxzeSB2YWx1ZSwgcmV0dXJuXG5cbiAgaWYgKCFhcnJheUIgfHwgIWFycmF5QSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSAvLyBjb21wYXJlIGxlbmd0aHMgLSBjYW4gc2F2ZSBhIGxvdCBvZiB0aW1lXG5cblxuICBpZiAoYXJyYXlBLmxlbmd0aCAhPT0gYXJyYXlCLmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXlBLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBuZXN0ZWQgYXJyYXlzXG4gICAgaWYgKGFycmF5QVtpXSBpbnN0YW5jZW9mIEFycmF5ICYmIGFycmF5QltpXSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAvLyByZWN1cnNlIGludG8gdGhlIG5lc3RlZCBhcnJheXNcbiAgICAgIGlmICghYXJyYXlFcXVhbHMoYXJyYXlBW2ldLCBhcnJheUJbaV0pKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGFycmF5QVtpXSAhPT0gYXJyYXlCW2ldKSB7XG4gICAgICAvLyBXYXJuaW5nIC0gdHdvIGRpZmZlcmVudCBvYmplY3QgaW5zdGFuY2VzIHdpbGwgbmV2ZXIgYmUgZXF1YWw6IHt4OjIwfSAhPSB7eDoyMH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FsSGVhdE1hcDsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.js\n");

/***/ }),

/***/ "./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css":
/*!*************************************************************************************!*\
  !*** ./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css ***!
  \*************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var content = __webpack_require__(/*! !../../../../css-loader??ref--7-1!./d3tip.css */ \"./node_modules/css-loader/index.js?!./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css\");\n\nif (typeof content === 'string') {\n  content = [[module.i, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = __webpack_require__(/*! ../../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js */ \"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9kM3RpcC5jc3MuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9kM3RpcC5jc3M/YTI2YyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uLy4uLy4uL2Nzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tNy0xIS4vZDN0aXAuY3NzXCIpO1xuXG5pZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbn1cblxudmFyIG9wdGlvbnMgPSB7fVxuXG5vcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xub3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcblxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vLi4vLi4vLi4vc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIikoY29udGVudCwgb3B0aW9ucyk7XG5cbmlmIChjb250ZW50LmxvY2Fscykge1xuICBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css\n");

/***/ }),

/***/ "./node_modules/@superset-ui/legacy-plugin-chart-calendar/node_modules/d3-array/src/extent.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@superset-ui/legacy-plugin-chart-calendar/node_modules/d3-array/src/extent.js ***!
  \****************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = (function(values, valueof) {\n  let min;\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  }\n  return [min, max];\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvbm9kZV9tb2R1bGVzL2QzLWFycmF5L3NyYy9leHRlbnQuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvbm9kZV9tb2R1bGVzL2QzLWFycmF5L3NyYy9leHRlbnQuanM/OTgyYSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZXMsIHZhbHVlb2YpIHtcbiAgbGV0IG1pbjtcbiAgbGV0IG1heDtcbiAgaWYgKHZhbHVlb2YgPT09IHVuZGVmaW5lZCkge1xuICAgIGZvciAoY29uc3QgdmFsdWUgb2YgdmFsdWVzKSB7XG4gICAgICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICBpZiAobWluID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpZiAodmFsdWUgPj0gdmFsdWUpIG1pbiA9IG1heCA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChtaW4gPiB2YWx1ZSkgbWluID0gdmFsdWU7XG4gICAgICAgICAgaWYgKG1heCA8IHZhbHVlKSBtYXggPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsZXQgaW5kZXggPSAtMTtcbiAgICBmb3IgKGxldCB2YWx1ZSBvZiB2YWx1ZXMpIHtcbiAgICAgIGlmICgodmFsdWUgPSB2YWx1ZW9mKHZhbHVlLCArK2luZGV4LCB2YWx1ZXMpKSAhPSBudWxsKSB7XG4gICAgICAgIGlmIChtaW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGlmICh2YWx1ZSA+PSB2YWx1ZSkgbWluID0gbWF4ID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKG1pbiA+IHZhbHVlKSBtaW4gPSB2YWx1ZTtcbiAgICAgICAgICBpZiAobWF4IDwgdmFsdWUpIG1heCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBbbWluLCBtYXhdO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@superset-ui/legacy-plugin-chart-calendar/node_modules/d3-array/src/extent.js\n");

/***/ }),

/***/ "./node_modules/@superset-ui/legacy-plugin-chart-calendar/node_modules/d3-array/src/range.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@superset-ui/legacy-plugin-chart-calendar/node_modules/d3-array/src/range.js ***!
  \***************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = (function(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvbm9kZV9tb2R1bGVzL2QzLWFycmF5L3NyYy9yYW5nZS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9Ac3VwZXJzZXQtdWkvbGVnYWN5LXBsdWdpbi1jaGFydC1jYWxlbmRhci9ub2RlX21vZHVsZXMvZDMtYXJyYXkvc3JjL3JhbmdlLmpzPzBiYWIiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oc3RhcnQsIHN0b3AsIHN0ZXApIHtcbiAgc3RhcnQgPSArc3RhcnQsIHN0b3AgPSArc3RvcCwgc3RlcCA9IChuID0gYXJndW1lbnRzLmxlbmd0aCkgPCAyID8gKHN0b3AgPSBzdGFydCwgc3RhcnQgPSAwLCAxKSA6IG4gPCAzID8gMSA6ICtzdGVwO1xuXG4gIHZhciBpID0gLTEsXG4gICAgICBuID0gTWF0aC5tYXgoMCwgTWF0aC5jZWlsKChzdG9wIC0gc3RhcnQpIC8gc3RlcCkpIHwgMCxcbiAgICAgIHJhbmdlID0gbmV3IEFycmF5KG4pO1xuXG4gIHdoaWxlICgrK2kgPCBuKSB7XG4gICAgcmFuZ2VbaV0gPSBzdGFydCArIGkgKiBzdGVwO1xuICB9XG5cbiAgcmV0dXJuIHJhbmdlO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@superset-ui/legacy-plugin-chart-calendar/node_modules/d3-array/src/range.js\n");

/***/ }),

/***/ "./node_modules/css-loader/index.js?!./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/css-loader??ref--7-1!./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css ***!
  \*******************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("exports = module.exports = __webpack_require__(/*! ../../../../css-loader/lib/css-base.js */ \"./node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.i, \"/* [LICENSE TBD] */\\n/* Cal-HeatMap CSS */\\n\\n.cal-heatmap-container {\\n  display: block;\\n}\\n\\n.cal-heatmap-container .graph-label {\\n  fill: #999;\\n  font-size: 10px;\\n}\\n\\n.cal-heatmap-container .graph,\\n.cal-heatmap-container .graph-legend rect {\\n  shape-rendering: crispedges;\\n}\\n\\n.cal-heatmap-container .graph-rect {\\n  fill: #ededed;\\n}\\n\\n.cal-heatmap-container .graph-subdomain-group rect:hover {\\n  stroke: #000;\\n  stroke-width: 1px;\\n}\\n\\n.cal-heatmap-container .subdomain-text {\\n  font-size: 8px;\\n  fill: #999;\\n  pointer-events: none;\\n}\\n\\n.cal-heatmap-container .hover_cursor:hover {\\n  cursor: pointer;\\n}\\n\\n.cal-heatmap-container .qi {\\n  background-color: #999;\\n  fill: #999;\\n}\\n\\n/*\\nRemove comment to apply this style to date with value equal to 0\\n.q0\\n{\\n  background-color: #fff;\\n  fill: #fff;\\n  stroke: #ededed\\n}\\n*/\\n\\n.cal-heatmap-container .q1 {\\n  background-color: #dae289;\\n  fill: #dae289;\\n}\\n\\n.cal-heatmap-container .q2 {\\n  background-color: #cedb9c;\\n  fill: #9cc069;\\n}\\n\\n.cal-heatmap-container .q3 {\\n  background-color: #b5cf6b;\\n  fill: #669d45;\\n}\\n\\n.cal-heatmap-container .q4 {\\n  background-color: #637939;\\n  fill: #637939;\\n}\\n\\n.cal-heatmap-container .q5 {\\n  background-color: #3b6427;\\n  fill: #3b6427;\\n}\\n\\n.cal-heatmap-container rect.highlight {\\n  stroke: #444;\\n  stroke-width: 1;\\n}\\n\\n.cal-heatmap-container text.highlight {\\n  fill: #444;\\n}\\n\\n.cal-heatmap-container rect.highlight-now {\\n  stroke: red;\\n}\\n\\n.cal-heatmap-container text.highlight-now {\\n  fill: red;\\n  font-weight: 800;\\n}\\n\\n.cal-heatmap-container .domain-background {\\n  fill: none;\\n  shape-rendering: crispedges;\\n}\\n\\n.ch-tooltip {\\n  padding: 10px;\\n  background: #222;\\n  color: #bbb;\\n  font-size: 12px;\\n  line-height: 1.4;\\n  width: 140px;\\n  position: absolute;\\n  z-index: 99999;\\n  text-align: center;\\n  border-radius: 2px;\\n  box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.2);\\n  display: none;\\n  box-sizing: border-box;\\n}\\n\\n.ch-tooltip::after {\\n  position: absolute;\\n  width: 0;\\n  height: 0;\\n  border-color: transparent;\\n  border-style: solid;\\n  content: '';\\n  padding: 0;\\n  display: block;\\n  bottom: -6px;\\n  left: 50%;\\n  margin-left: -6px;\\n  border-width: 6px 6px 0;\\n  border-top-color: #222;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"/app/superset-frontend/node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css\"],\"names\":[],\"mappings\":\"AAAA,mBAAmB;AACnB,qBAAqB;;AAErB;EACE,eAAe;CAChB;;AAED;EACE,WAAW;EACX,gBAAgB;CACjB;;AAED;;EAEE,4BAA4B;CAC7B;;AAED;EACE,cAAc;CACf;;AAED;EACE,aAAa;EACb,kBAAkB;CACnB;;AAED;EACE,eAAe;EACf,WAAW;EACX,qBAAqB;CACtB;;AAED;EACE,gBAAgB;CACjB;;AAED;EACE,uBAAuB;EACvB,WAAW;CACZ;;AAED;;;;;;;;EAQE;;AAEF;EACE,0BAA0B;EAC1B,cAAc;CACf;;AAED;EACE,0BAA0B;EAC1B,cAAc;CACf;;AAED;EACE,0BAA0B;EAC1B,cAAc;CACf;;AAED;EACE,0BAA0B;EAC1B,cAAc;CACf;;AAED;EACE,0BAA0B;EAC1B,cAAc;CACf;;AAED;EACE,aAAa;EACb,gBAAgB;CACjB;;AAED;EACE,WAAW;CACZ;;AAED;EACE,YAAY;CACb;;AAED;EACE,UAAU;EACV,iBAAiB;CAClB;;AAED;EACE,WAAW;EACX,4BAA4B;CAC7B;;AAED;EACE,cAAc;EACd,iBAAiB;EACjB,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,aAAa;EACb,mBAAmB;EACnB,eAAe;EACf,mBAAmB;EACnB,mBAAmB;EACnB,2CAA2C;EAC3C,cAAc;EACd,uBAAuB;CACxB;;AAED;EACE,mBAAmB;EACnB,SAAS;EACT,UAAU;EACV,0BAA0B;EAC1B,oBAAoB;EACpB,YAAY;EACZ,WAAW;EACX,eAAe;EACf,aAAa;EACb,UAAU;EACV,kBAAkB;EAClB,wBAAwB;EACxB,uBAAuB;CACxB\",\"file\":\"cal-heatmap.css\",\"sourcesContent\":[\"/* [LICENSE TBD] */\\n/* Cal-HeatMap CSS */\\n\\n.cal-heatmap-container {\\n  display: block;\\n}\\n\\n.cal-heatmap-container .graph-label {\\n  fill: #999;\\n  font-size: 10px;\\n}\\n\\n.cal-heatmap-container .graph,\\n.cal-heatmap-container .graph-legend rect {\\n  shape-rendering: crispedges;\\n}\\n\\n.cal-heatmap-container .graph-rect {\\n  fill: #ededed;\\n}\\n\\n.cal-heatmap-container .graph-subdomain-group rect:hover {\\n  stroke: #000;\\n  stroke-width: 1px;\\n}\\n\\n.cal-heatmap-container .subdomain-text {\\n  font-size: 8px;\\n  fill: #999;\\n  pointer-events: none;\\n}\\n\\n.cal-heatmap-container .hover_cursor:hover {\\n  cursor: pointer;\\n}\\n\\n.cal-heatmap-container .qi {\\n  background-color: #999;\\n  fill: #999;\\n}\\n\\n/*\\nRemove comment to apply this style to date with value equal to 0\\n.q0\\n{\\n  background-color: #fff;\\n  fill: #fff;\\n  stroke: #ededed\\n}\\n*/\\n\\n.cal-heatmap-container .q1 {\\n  background-color: #dae289;\\n  fill: #dae289;\\n}\\n\\n.cal-heatmap-container .q2 {\\n  background-color: #cedb9c;\\n  fill: #9cc069;\\n}\\n\\n.cal-heatmap-container .q3 {\\n  background-color: #b5cf6b;\\n  fill: #669d45;\\n}\\n\\n.cal-heatmap-container .q4 {\\n  background-color: #637939;\\n  fill: #637939;\\n}\\n\\n.cal-heatmap-container .q5 {\\n  background-color: #3b6427;\\n  fill: #3b6427;\\n}\\n\\n.cal-heatmap-container rect.highlight {\\n  stroke: #444;\\n  stroke-width: 1;\\n}\\n\\n.cal-heatmap-container text.highlight {\\n  fill: #444;\\n}\\n\\n.cal-heatmap-container rect.highlight-now {\\n  stroke: red;\\n}\\n\\n.cal-heatmap-container text.highlight-now {\\n  fill: red;\\n  font-weight: 800;\\n}\\n\\n.cal-heatmap-container .domain-background {\\n  fill: none;\\n  shape-rendering: crispedges;\\n}\\n\\n.ch-tooltip {\\n  padding: 10px;\\n  background: #222;\\n  color: #bbb;\\n  font-size: 12px;\\n  line-height: 1.4;\\n  width: 140px;\\n  position: absolute;\\n  z-index: 99999;\\n  text-align: center;\\n  border-radius: 2px;\\n  box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.2);\\n  display: none;\\n  box-sizing: border-box;\\n}\\n\\n.ch-tooltip::after {\\n  position: absolute;\\n  width: 0;\\n  height: 0;\\n  border-color: transparent;\\n  border-style: solid;\\n  content: '';\\n  padding: 0;\\n  display: block;\\n  bottom: -6px;\\n  left: 50%;\\n  margin-left: -6px;\\n  border-width: 6px 6px 0;\\n  border-top-color: #222;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz8hLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9jYWwtaGVhdG1hcC5jc3MuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9jYWwtaGVhdG1hcC5jc3M/MjFkNCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikodHJ1ZSk7XG4vLyBpbXBvcnRzXG5cblxuLy8gbW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIvKiBbTElDRU5TRSBUQkRdICovXFxuLyogQ2FsLUhlYXRNYXAgQ1NTICovXFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciB7XFxuICBkaXNwbGF5OiBibG9jaztcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAuZ3JhcGgtbGFiZWwge1xcbiAgZmlsbDogIzk5OTtcXG4gIGZvbnQtc2l6ZTogMTBweDtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAuZ3JhcGgsXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAuZ3JhcGgtbGVnZW5kIHJlY3Qge1xcbiAgc2hhcGUtcmVuZGVyaW5nOiBjcmlzcGVkZ2VzO1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5ncmFwaC1yZWN0IHtcXG4gIGZpbGw6ICNlZGVkZWQ7XFxufVxcblxcbi5jYWwtaGVhdG1hcC1jb250YWluZXIgLmdyYXBoLXN1YmRvbWFpbi1ncm91cCByZWN0OmhvdmVyIHtcXG4gIHN0cm9rZTogIzAwMDtcXG4gIHN0cm9rZS13aWR0aDogMXB4O1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5zdWJkb21haW4tdGV4dCB7XFxuICBmb250LXNpemU6IDhweDtcXG4gIGZpbGw6ICM5OTk7XFxuICBwb2ludGVyLWV2ZW50czogbm9uZTtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAuaG92ZXJfY3Vyc29yOmhvdmVyIHtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAucWkge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogIzk5OTtcXG4gIGZpbGw6ICM5OTk7XFxufVxcblxcbi8qXFxuUmVtb3ZlIGNvbW1lbnQgdG8gYXBwbHkgdGhpcyBzdHlsZSB0byBkYXRlIHdpdGggdmFsdWUgZXF1YWwgdG8gMFxcbi5xMFxcbntcXG4gIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XFxuICBmaWxsOiAjZmZmO1xcbiAgc3Ryb2tlOiAjZWRlZGVkXFxufVxcbiovXFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAucTEge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI2RhZTI4OTtcXG4gIGZpbGw6ICNkYWUyODk7XFxufVxcblxcbi5jYWwtaGVhdG1hcC1jb250YWluZXIgLnEyIHtcXG4gIGJhY2tncm91bmQtY29sb3I6ICNjZWRiOWM7XFxuICBmaWxsOiAjOWNjMDY5O1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5xMyB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjYjVjZjZiO1xcbiAgZmlsbDogIzY2OWQ0NTtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAucTQge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogIzYzNzkzOTtcXG4gIGZpbGw6ICM2Mzc5Mzk7XFxufVxcblxcbi5jYWwtaGVhdG1hcC1jb250YWluZXIgLnE1IHtcXG4gIGJhY2tncm91bmQtY29sb3I6ICMzYjY0Mjc7XFxuICBmaWxsOiAjM2I2NDI3O1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIHJlY3QuaGlnaGxpZ2h0IHtcXG4gIHN0cm9rZTogIzQ0NDtcXG4gIHN0cm9rZS13aWR0aDogMTtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciB0ZXh0LmhpZ2hsaWdodCB7XFxuICBmaWxsOiAjNDQ0O1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIHJlY3QuaGlnaGxpZ2h0LW5vdyB7XFxuICBzdHJva2U6IHJlZDtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciB0ZXh0LmhpZ2hsaWdodC1ub3cge1xcbiAgZmlsbDogcmVkO1xcbiAgZm9udC13ZWlnaHQ6IDgwMDtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAuZG9tYWluLWJhY2tncm91bmQge1xcbiAgZmlsbDogbm9uZTtcXG4gIHNoYXBlLXJlbmRlcmluZzogY3Jpc3BlZGdlcztcXG59XFxuXFxuLmNoLXRvb2x0aXAge1xcbiAgcGFkZGluZzogMTBweDtcXG4gIGJhY2tncm91bmQ6ICMyMjI7XFxuICBjb2xvcjogI2JiYjtcXG4gIGZvbnQtc2l6ZTogMTJweDtcXG4gIGxpbmUtaGVpZ2h0OiAxLjQ7XFxuICB3aWR0aDogMTQwcHg7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB6LWluZGV4OiA5OTk5OTtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG4gIGJvcmRlci1yYWRpdXM6IDJweDtcXG4gIGJveC1zaGFkb3c6IDJweCAycHggMnB4IHJnYmEoMCwgMCwgMCwgMC4yKTtcXG4gIGRpc3BsYXk6IG5vbmU7XFxuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbn1cXG5cXG4uY2gtdG9vbHRpcDo6YWZ0ZXIge1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgd2lkdGg6IDA7XFxuICBoZWlnaHQ6IDA7XFxuICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50O1xcbiAgYm9yZGVyLXN0eWxlOiBzb2xpZDtcXG4gIGNvbnRlbnQ6ICcnO1xcbiAgcGFkZGluZzogMDtcXG4gIGRpc3BsYXk6IGJsb2NrO1xcbiAgYm90dG9tOiAtNnB4O1xcbiAgbGVmdDogNTAlO1xcbiAgbWFyZ2luLWxlZnQ6IC02cHg7XFxuICBib3JkZXItd2lkdGg6IDZweCA2cHggMDtcXG4gIGJvcmRlci10b3AtY29sb3I6ICMyMjI7XFxufVxcblwiLCBcIlwiLCB7XCJ2ZXJzaW9uXCI6MyxcInNvdXJjZXNcIjpbXCIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL25vZGVfbW9kdWxlcy9Ac3VwZXJzZXQtdWkvbGVnYWN5LXBsdWdpbi1jaGFydC1jYWxlbmRhci9lc20vdmVuZG9yL2NhbC1oZWF0bWFwLmNzc1wiXSxcIm5hbWVzXCI6W10sXCJtYXBwaW5nc1wiOlwiQUFBQSxtQkFBbUI7QUFDbkIscUJBQXFCOztBQUVyQjtFQUNFLGVBQWU7Q0FDaEI7O0FBRUQ7RUFDRSxXQUFXO0VBQ1gsZ0JBQWdCO0NBQ2pCOztBQUVEOztFQUVFLDRCQUE0QjtDQUM3Qjs7QUFFRDtFQUNFLGNBQWM7Q0FDZjs7QUFFRDtFQUNFLGFBQWE7RUFDYixrQkFBa0I7Q0FDbkI7O0FBRUQ7RUFDRSxlQUFlO0VBQ2YsV0FBVztFQUNYLHFCQUFxQjtDQUN0Qjs7QUFFRDtFQUNFLGdCQUFnQjtDQUNqQjs7QUFFRDtFQUNFLHVCQUF1QjtFQUN2QixXQUFXO0NBQ1o7O0FBRUQ7Ozs7Ozs7O0VBUUU7O0FBRUY7RUFDRSwwQkFBMEI7RUFDMUIsY0FBYztDQUNmOztBQUVEO0VBQ0UsMEJBQTBCO0VBQzFCLGNBQWM7Q0FDZjs7QUFFRDtFQUNFLDBCQUEwQjtFQUMxQixjQUFjO0NBQ2Y7O0FBRUQ7RUFDRSwwQkFBMEI7RUFDMUIsY0FBYztDQUNmOztBQUVEO0VBQ0UsMEJBQTBCO0VBQzFCLGNBQWM7Q0FDZjs7QUFFRDtFQUNFLGFBQWE7RUFDYixnQkFBZ0I7Q0FDakI7O0FBRUQ7RUFDRSxXQUFXO0NBQ1o7O0FBRUQ7RUFDRSxZQUFZO0NBQ2I7O0FBRUQ7RUFDRSxVQUFVO0VBQ1YsaUJBQWlCO0NBQ2xCOztBQUVEO0VBQ0UsV0FBVztFQUNYLDRCQUE0QjtDQUM3Qjs7QUFFRDtFQUNFLGNBQWM7RUFDZCxpQkFBaUI7RUFDakIsWUFBWTtFQUNaLGdCQUFnQjtFQUNoQixpQkFBaUI7RUFDakIsYUFBYTtFQUNiLG1CQUFtQjtFQUNuQixlQUFlO0VBQ2YsbUJBQW1CO0VBQ25CLG1CQUFtQjtFQUNuQiwyQ0FBMkM7RUFDM0MsY0FBYztFQUNkLHVCQUF1QjtDQUN4Qjs7QUFFRDtFQUNFLG1CQUFtQjtFQUNuQixTQUFTO0VBQ1QsVUFBVTtFQUNWLDBCQUEwQjtFQUMxQixvQkFBb0I7RUFDcEIsWUFBWTtFQUNaLFdBQVc7RUFDWCxlQUFlO0VBQ2YsYUFBYTtFQUNiLFVBQVU7RUFDVixrQkFBa0I7RUFDbEIsd0JBQXdCO0VBQ3hCLHVCQUF1QjtDQUN4QlwiLFwiZmlsZVwiOlwiY2FsLWhlYXRtYXAuY3NzXCIsXCJzb3VyY2VzQ29udGVudFwiOltcIi8qIFtMSUNFTlNFIFRCRF0gKi9cXG4vKiBDYWwtSGVhdE1hcCBDU1MgKi9cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIHtcXG4gIGRpc3BsYXk6IGJsb2NrO1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5ncmFwaC1sYWJlbCB7XFxuICBmaWxsOiAjOTk5O1xcbiAgZm9udC1zaXplOiAxMHB4O1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5ncmFwaCxcXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5ncmFwaC1sZWdlbmQgcmVjdCB7XFxuICBzaGFwZS1yZW5kZXJpbmc6IGNyaXNwZWRnZXM7XFxufVxcblxcbi5jYWwtaGVhdG1hcC1jb250YWluZXIgLmdyYXBoLXJlY3Qge1xcbiAgZmlsbDogI2VkZWRlZDtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAuZ3JhcGgtc3ViZG9tYWluLWdyb3VwIHJlY3Q6aG92ZXIge1xcbiAgc3Ryb2tlOiAjMDAwO1xcbiAgc3Ryb2tlLXdpZHRoOiAxcHg7XFxufVxcblxcbi5jYWwtaGVhdG1hcC1jb250YWluZXIgLnN1YmRvbWFpbi10ZXh0IHtcXG4gIGZvbnQtc2l6ZTogOHB4O1xcbiAgZmlsbDogIzk5OTtcXG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5ob3Zlcl9jdXJzb3I6aG92ZXIge1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5xaSB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjOTk5O1xcbiAgZmlsbDogIzk5OTtcXG59XFxuXFxuLypcXG5SZW1vdmUgY29tbWVudCB0byBhcHBseSB0aGlzIHN0eWxlIHRvIGRhdGUgd2l0aCB2YWx1ZSBlcXVhbCB0byAwXFxuLnEwXFxue1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcXG4gIGZpbGw6ICNmZmY7XFxuICBzdHJva2U6ICNlZGVkZWRcXG59XFxuKi9cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5xMSB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGFlMjg5O1xcbiAgZmlsbDogI2RhZTI4OTtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAucTIge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI2NlZGI5YztcXG4gIGZpbGw6ICM5Y2MwNjk7XFxufVxcblxcbi5jYWwtaGVhdG1hcC1jb250YWluZXIgLnEzIHtcXG4gIGJhY2tncm91bmQtY29sb3I6ICNiNWNmNmI7XFxuICBmaWxsOiAjNjY5ZDQ1O1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5xNCB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNjM3OTM5O1xcbiAgZmlsbDogIzYzNzkzOTtcXG59XFxuXFxuLmNhbC1oZWF0bWFwLWNvbnRhaW5lciAucTUge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogIzNiNjQyNztcXG4gIGZpbGw6ICMzYjY0Mjc7XFxufVxcblxcbi5jYWwtaGVhdG1hcC1jb250YWluZXIgcmVjdC5oaWdobGlnaHQge1xcbiAgc3Ryb2tlOiAjNDQ0O1xcbiAgc3Ryb2tlLXdpZHRoOiAxO1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIHRleHQuaGlnaGxpZ2h0IHtcXG4gIGZpbGw6ICM0NDQ7XFxufVxcblxcbi5jYWwtaGVhdG1hcC1jb250YWluZXIgcmVjdC5oaWdobGlnaHQtbm93IHtcXG4gIHN0cm9rZTogcmVkO1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIHRleHQuaGlnaGxpZ2h0LW5vdyB7XFxuICBmaWxsOiByZWQ7XFxuICBmb250LXdlaWdodDogODAwO1xcbn1cXG5cXG4uY2FsLWhlYXRtYXAtY29udGFpbmVyIC5kb21haW4tYmFja2dyb3VuZCB7XFxuICBmaWxsOiBub25lO1xcbiAgc2hhcGUtcmVuZGVyaW5nOiBjcmlzcGVkZ2VzO1xcbn1cXG5cXG4uY2gtdG9vbHRpcCB7XFxuICBwYWRkaW5nOiAxMHB4O1xcbiAgYmFja2dyb3VuZDogIzIyMjtcXG4gIGNvbG9yOiAjYmJiO1xcbiAgZm9udC1zaXplOiAxMnB4O1xcbiAgbGluZS1oZWlnaHQ6IDEuNDtcXG4gIHdpZHRoOiAxNDBweDtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHotaW5kZXg6IDk5OTk5O1xcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgYm9yZGVyLXJhZGl1czogMnB4O1xcbiAgYm94LXNoYWRvdzogMnB4IDJweCAycHggcmdiYSgwLCAwLCAwLCAwLjIpO1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxufVxcblxcbi5jaC10b29sdGlwOjphZnRlciB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB3aWR0aDogMDtcXG4gIGhlaWdodDogMDtcXG4gIGJvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQ7XFxuICBib3JkZXItc3R5bGU6IHNvbGlkO1xcbiAgY29udGVudDogJyc7XFxuICBwYWRkaW5nOiAwO1xcbiAgZGlzcGxheTogYmxvY2s7XFxuICBib3R0b206IC02cHg7XFxuICBsZWZ0OiA1MCU7XFxuICBtYXJnaW4tbGVmdDogLTZweDtcXG4gIGJvcmRlci13aWR0aDogNnB4IDZweCAwO1xcbiAgYm9yZGVyLXRvcC1jb2xvcjogIzIyMjtcXG59XFxuXCJdLFwic291cmNlUm9vdFwiOlwiXCJ9XSk7XG5cbi8vIGV4cG9ydHNcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/css-loader/index.js?!./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/cal-heatmap.css\n");

/***/ }),

/***/ "./node_modules/css-loader/index.js?!./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/css-loader??ref--7-1!./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css ***!
  \*************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("exports = module.exports = __webpack_require__(/*! ../../../../css-loader/lib/css-base.js */ \"./node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.i, \"/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n/* from d3-tip */\\n.d3-tip {\\n  line-height: 1;\\n  padding: 12px;\\n  background: rgba(0, 0, 0, 0.8);\\n  color: #fff;\\n  border-radius: 2px;\\n  pointer-events: none;\\n  z-index: 1000;\\n}\\n\\n/* Creates a small triangle extender for the tooltip */\\n.d3-tip:after {\\n  box-sizing: border-box;\\n  display: inline;\\n  font-size: 10px;\\n  width: 100%;\\n  line-height: 1;\\n  color: rgba(0, 0, 0, 0.8);\\n  position: absolute;\\n  pointer-events: none;\\n}\\n\\n/* Northward tooltips */\\n.d3-tip.n:after {\\n  content: '\\\\25BC';\\n  margin: -1px 0 0 0;\\n  top: 100%;\\n  left: 0;\\n  text-align: center;\\n}\\n\\n/* Eastward tooltips */\\n.d3-tip.e:after {\\n  content: '\\\\25C0';\\n  margin: -4px 0 0 0;\\n  top: 50%;\\n  left: -8px;\\n}\\n\\n/* Southward tooltips */\\n.d3-tip.s:after {\\n  content: '\\\\25B2';\\n  margin: 0 0 1px 0;\\n  top: -8px;\\n  left: 0;\\n  text-align: center;\\n}\\n\\n/* Westward tooltips */\\n.d3-tip.w:after {\\n  content: '\\\\25B6';\\n  margin: -4px 0 0 -1px;\\n  top: 50%;\\n  left: 100%;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"/app/superset-frontend/node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css\"],\"names\":[],\"mappings\":\"AAAA;;;;;;;;;;;;;;;;;GAiBG;AACH,iBAAiB;AACjB;EACE,eAAe;EACf,cAAc;EACd,+BAA+B;EAC/B,YAAY;EACZ,mBAAmB;EACnB,qBAAqB;EACrB,cAAc;CACf;;AAED,uDAAuD;AACvD;EACE,uBAAuB;EACvB,gBAAgB;EAChB,gBAAgB;EAChB,YAAY;EACZ,eAAe;EACf,0BAA0B;EAC1B,mBAAmB;EACnB,qBAAqB;CACtB;;AAED,wBAAwB;AACxB;EACE,iBAAiB;EACjB,mBAAmB;EACnB,UAAU;EACV,QAAQ;EACR,mBAAmB;CACpB;;AAED,uBAAuB;AACvB;EACE,iBAAiB;EACjB,mBAAmB;EACnB,SAAS;EACT,WAAW;CACZ;;AAED,wBAAwB;AACxB;EACE,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,QAAQ;EACR,mBAAmB;CACpB;;AAED,uBAAuB;AACvB;EACE,iBAAiB;EACjB,sBAAsB;EACtB,SAAS;EACT,WAAW;CACZ\",\"file\":\"d3tip.css\",\"sourcesContent\":[\"/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n/* from d3-tip */\\n.d3-tip {\\n  line-height: 1;\\n  padding: 12px;\\n  background: rgba(0, 0, 0, 0.8);\\n  color: #fff;\\n  border-radius: 2px;\\n  pointer-events: none;\\n  z-index: 1000;\\n}\\n\\n/* Creates a small triangle extender for the tooltip */\\n.d3-tip:after {\\n  box-sizing: border-box;\\n  display: inline;\\n  font-size: 10px;\\n  width: 100%;\\n  line-height: 1;\\n  color: rgba(0, 0, 0, 0.8);\\n  position: absolute;\\n  pointer-events: none;\\n}\\n\\n/* Northward tooltips */\\n.d3-tip.n:after {\\n  content: '\\\\25BC';\\n  margin: -1px 0 0 0;\\n  top: 100%;\\n  left: 0;\\n  text-align: center;\\n}\\n\\n/* Eastward tooltips */\\n.d3-tip.e:after {\\n  content: '\\\\25C0';\\n  margin: -4px 0 0 0;\\n  top: 50%;\\n  left: -8px;\\n}\\n\\n/* Southward tooltips */\\n.d3-tip.s:after {\\n  content: '\\\\25B2';\\n  margin: 0 0 1px 0;\\n  top: -8px;\\n  left: 0;\\n  text-align: center;\\n}\\n\\n/* Westward tooltips */\\n.d3-tip.w:after {\\n  content: '\\\\25B6';\\n  margin: -4px 0 0 -1px;\\n  top: 50%;\\n  left: 100%;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz8hLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9kM3RpcC5jc3MuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHN1cGVyc2V0LXVpL2xlZ2FjeS1wbHVnaW4tY2hhcnQtY2FsZW5kYXIvZXNtL3ZlbmRvci9kM3RpcC5jc3M/OGM1ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikodHJ1ZSk7XG4vLyBpbXBvcnRzXG5cblxuLy8gbW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIvKipcXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXFxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXFxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXFxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxcbiAqIFxcXCJMaWNlbnNlXFxcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XFxuICpcXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxcbiAqXFxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXFxuICogXFxcIkFTIElTXFxcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXFxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXFxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxcbiAqL1xcbi8qIGZyb20gZDMtdGlwICovXFxuLmQzLXRpcCB7XFxuICBsaW5lLWhlaWdodDogMTtcXG4gIHBhZGRpbmc6IDEycHg7XFxuICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCk7XFxuICBjb2xvcjogI2ZmZjtcXG4gIGJvcmRlci1yYWRpdXM6IDJweDtcXG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xcbiAgei1pbmRleDogMTAwMDtcXG59XFxuXFxuLyogQ3JlYXRlcyBhIHNtYWxsIHRyaWFuZ2xlIGV4dGVuZGVyIGZvciB0aGUgdG9vbHRpcCAqL1xcbi5kMy10aXA6YWZ0ZXIge1xcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gIGRpc3BsYXk6IGlubGluZTtcXG4gIGZvbnQtc2l6ZTogMTBweDtcXG4gIHdpZHRoOiAxMDAlO1xcbiAgbGluZS1oZWlnaHQ6IDE7XFxuICBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjgpO1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XFxufVxcblxcbi8qIE5vcnRod2FyZCB0b29sdGlwcyAqL1xcbi5kMy10aXAubjphZnRlciB7XFxuICBjb250ZW50OiAnXFxcXDI1QkMnO1xcbiAgbWFyZ2luOiAtMXB4IDAgMCAwO1xcbiAgdG9wOiAxMDAlO1xcbiAgbGVmdDogMDtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG59XFxuXFxuLyogRWFzdHdhcmQgdG9vbHRpcHMgKi9cXG4uZDMtdGlwLmU6YWZ0ZXIge1xcbiAgY29udGVudDogJ1xcXFwyNUMwJztcXG4gIG1hcmdpbjogLTRweCAwIDAgMDtcXG4gIHRvcDogNTAlO1xcbiAgbGVmdDogLThweDtcXG59XFxuXFxuLyogU291dGh3YXJkIHRvb2x0aXBzICovXFxuLmQzLXRpcC5zOmFmdGVyIHtcXG4gIGNvbnRlbnQ6ICdcXFxcMjVCMic7XFxuICBtYXJnaW46IDAgMCAxcHggMDtcXG4gIHRvcDogLThweDtcXG4gIGxlZnQ6IDA7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxufVxcblxcbi8qIFdlc3R3YXJkIHRvb2x0aXBzICovXFxuLmQzLXRpcC53OmFmdGVyIHtcXG4gIGNvbnRlbnQ6ICdcXFxcMjVCNic7XFxuICBtYXJnaW46IC00cHggMCAwIC0xcHg7XFxuICB0b3A6IDUwJTtcXG4gIGxlZnQ6IDEwMCU7XFxufVxcblwiLCBcIlwiLCB7XCJ2ZXJzaW9uXCI6MyxcInNvdXJjZXNcIjpbXCIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL25vZGVfbW9kdWxlcy9Ac3VwZXJzZXQtdWkvbGVnYWN5LXBsdWdpbi1jaGFydC1jYWxlbmRhci9lc20vdmVuZG9yL2QzdGlwLmNzc1wiXSxcIm5hbWVzXCI6W10sXCJtYXBwaW5nc1wiOlwiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FpQkc7QUFDSCxpQkFBaUI7QUFDakI7RUFDRSxlQUFlO0VBQ2YsY0FBYztFQUNkLCtCQUErQjtFQUMvQixZQUFZO0VBQ1osbUJBQW1CO0VBQ25CLHFCQUFxQjtFQUNyQixjQUFjO0NBQ2Y7O0FBRUQsdURBQXVEO0FBQ3ZEO0VBQ0UsdUJBQXVCO0VBQ3ZCLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsWUFBWTtFQUNaLGVBQWU7RUFDZiwwQkFBMEI7RUFDMUIsbUJBQW1CO0VBQ25CLHFCQUFxQjtDQUN0Qjs7QUFFRCx3QkFBd0I7QUFDeEI7RUFDRSxpQkFBaUI7RUFDakIsbUJBQW1CO0VBQ25CLFVBQVU7RUFDVixRQUFRO0VBQ1IsbUJBQW1CO0NBQ3BCOztBQUVELHVCQUF1QjtBQUN2QjtFQUNFLGlCQUFpQjtFQUNqQixtQkFBbUI7RUFDbkIsU0FBUztFQUNULFdBQVc7Q0FDWjs7QUFFRCx3QkFBd0I7QUFDeEI7RUFDRSxpQkFBaUI7RUFDakIsa0JBQWtCO0VBQ2xCLFVBQVU7RUFDVixRQUFRO0VBQ1IsbUJBQW1CO0NBQ3BCOztBQUVELHVCQUF1QjtBQUN2QjtFQUNFLGlCQUFpQjtFQUNqQixzQkFBc0I7RUFDdEIsU0FBUztFQUNULFdBQVc7Q0FDWlwiLFwiZmlsZVwiOlwiZDN0aXAuY3NzXCIsXCJzb3VyY2VzQ29udGVudFwiOltcIi8qKlxcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxcbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXFxuICogXFxcIkxpY2Vuc2VcXFwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcXG4gKlxcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXFxuICpcXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cXG4gKiBcXFwiQVMgSVNcXFwiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXFxuICogdW5kZXIgdGhlIExpY2Vuc2UuXFxuICovXFxuLyogZnJvbSBkMy10aXAgKi9cXG4uZDMtdGlwIHtcXG4gIGxpbmUtaGVpZ2h0OiAxO1xcbiAgcGFkZGluZzogMTJweDtcXG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTtcXG4gIGNvbG9yOiAjZmZmO1xcbiAgYm9yZGVyLXJhZGl1czogMnB4O1xcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XFxuICB6LWluZGV4OiAxMDAwO1xcbn1cXG5cXG4vKiBDcmVhdGVzIGEgc21hbGwgdHJpYW5nbGUgZXh0ZW5kZXIgZm9yIHRoZSB0b29sdGlwICovXFxuLmQzLXRpcDphZnRlciB7XFxuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgZGlzcGxheTogaW5saW5lO1xcbiAgZm9udC1zaXplOiAxMHB4O1xcbiAgd2lkdGg6IDEwMCU7XFxuICBsaW5lLWhlaWdodDogMTtcXG4gIGNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuOCk7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICBwb2ludGVyLWV2ZW50czogbm9uZTtcXG59XFxuXFxuLyogTm9ydGh3YXJkIHRvb2x0aXBzICovXFxuLmQzLXRpcC5uOmFmdGVyIHtcXG4gIGNvbnRlbnQ6ICdcXFxcMjVCQyc7XFxuICBtYXJnaW46IC0xcHggMCAwIDA7XFxuICB0b3A6IDEwMCU7XFxuICBsZWZ0OiAwO1xcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xcbn1cXG5cXG4vKiBFYXN0d2FyZCB0b29sdGlwcyAqL1xcbi5kMy10aXAuZTphZnRlciB7XFxuICBjb250ZW50OiAnXFxcXDI1QzAnO1xcbiAgbWFyZ2luOiAtNHB4IDAgMCAwO1xcbiAgdG9wOiA1MCU7XFxuICBsZWZ0OiAtOHB4O1xcbn1cXG5cXG4vKiBTb3V0aHdhcmQgdG9vbHRpcHMgKi9cXG4uZDMtdGlwLnM6YWZ0ZXIge1xcbiAgY29udGVudDogJ1xcXFwyNUIyJztcXG4gIG1hcmdpbjogMCAwIDFweCAwO1xcbiAgdG9wOiAtOHB4O1xcbiAgbGVmdDogMDtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG59XFxuXFxuLyogV2VzdHdhcmQgdG9vbHRpcHMgKi9cXG4uZDMtdGlwLnc6YWZ0ZXIge1xcbiAgY29udGVudDogJ1xcXFwyNUI2JztcXG4gIG1hcmdpbjogLTRweCAwIDAgLTFweDtcXG4gIHRvcDogNTAlO1xcbiAgbGVmdDogMTAwJTtcXG59XFxuXCJdLFwic291cmNlUm9vdFwiOlwiXCJ9XSk7XG5cbi8vIGV4cG9ydHNcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/css-loader/index.js?!./node_modules/@superset-ui/legacy-plugin-chart-calendar/esm/vendor/d3tip.css\n");

/***/ })

}]);